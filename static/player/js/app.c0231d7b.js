(function(){var t={193:function(t){"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABIpJREFUeJztm9uLVVUcxz8n7WINRXmt04iDlhdUlECLoumheuvyaJR2wxD/gERJUBQFwQfJCxlkpBE9SVhiRWM9ZEH0VPYUOI6OM+WYUJpzUceH3z6cvX9n7bPP3nuttbd4PrDh/M6sy3f99tm/tfZav4E2bdrcylQK6HMq8DAwBZgUfDcMXADOAH8XoMkZE4FngK1AD3ARGE+4LgLHgzrdQRuaHcA8t9LzsRTYBwyRPOCk6zzwPrAoaPut4PtDfoaSjk7k7uUddNx1HBgJPl8F5uQVbDsG3An8iTzjJvqA34Be5Fm/jAymA5gOdCF3Oq6+5mPgzcxqHbGG+h0bAb4AXgeqKdqoAm8EdWt33HSNIU4rFbcDPwMbkIiflxnI7BDnhP0W+ig122geF0aAmUWJq2KepmzRDVwjOTjudajByMyg05Me+poMrEAC3gBmBwwDD3nQQhfwITAadLzHR6chKsASYB0yJdZ0jAO7XHb8CHIHxoh6/gWXnbZAB/Ai9V/jDNsdzAc+RRYdpuBzj+0Oc2ItHi0EPqd5AOqx1VkZSZp6xoF3C1PniZVIdI1zwOLipLXMXbS+rDbSg3nw53JLc8sdwFqgHziatZHFxN/9A/k1OuVXonoXxBW8rUkj7yj7dOjzsczS/HBE2XosiUxANiLCK62pwGZkSnwgp0DXPEh0zXKO5je7gW6iP6HDob89aUejc44RHcMTpkJxXnlW2WEH/Jhbmh8OK/v5NJW/I+o9Ly8alukiOoZUceufUMXTCWXLzCD1cQyaCpgegSnA/SH7d/u6vBHWPh24TxcwOaBT2adsKvKM1t6wL2lywGRl38wnNX8pW4/N6IBJyr5kTY5//lP23bpAK4uDIs4PbaG1j+sCJgdcUXbZNj3SoLX/rwuYHDCk7GnW5PhHb5Fd0AVMDjir7NKdvKRglrLPtFoxvBDqsyjIN+Ft9P40FfVSONeuSkHMIjqGr0yF4maBE8p+zposf+gXOj2mpjxN1Ht6g6GsdIc+HyU6hmVpGpqArABrlUeRtXSZmYZs429FNkTCp0ZnybCe2U3UgxttKXXESupa9XH6jiwNLlKN/GRFpjsOYd7AvQ48mrXRb5B0lrdxewyelwrRRzbzRoimiuyxl53HiN/CHwZWFSfNDxtIPsrbXpg6D/xA/MCvAp8Ac211VrZYcC/RKa92jQEfAbNtd1gF/kCSEl5CkhSK5GUa8xY+oPFFyCp7Qx2OAt8D65EUWd8bKPuoB7s9NO5pOqGT+ATGQeAg8Cp28gSTOInkB3k/u9hPcuS9BjzlUMNEHOQFtUoXjUlT+tpUlDhfHCB+8L3YeYGqAluAXyjfDMQczBlk4Yh8BFlKp0lnnY0kXX+r2l9tS3gNGxH7IPBai2UHkOOqXuTQ4nLwfQfyLNfS5eOCZx+SsziaUasT5lJPp7sCfI28gSUFyCzXl5T0pPozROArgT0f2IlkZuQddH/QlrWlrAsWIIFKUwEeB95DtqhacchAUHYjsBzHC6sijr06kIVU7d/mKsiJzRByt/8tQFObNm1uUW4AGczgZPXYq/AAAAAASUVORK5CYII="},1151:function(t,e,i){
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
(function(t){let e,i;"function"===typeof queueMicrotask&&(i=t.queueMicrotask),i||"function"!==typeof Promise||(i=t=>(e||(e=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)))),i||"function"!==typeof setTimeout||(i=t=>setTimeout(t,0)),t.queueMicrotask=i})("undefined"!==typeof window?window:i.g)},1320:function(t,e,i){
/*! @riim/map-set-polyfill. MIT License. Dmitry Vibe <https://github.com/Riim/map-set-polyfill> */
(function(t){var e=t.Symbol="function"===typeof t.Symbol?t.Symbol:function(t){return"__symbol_"+t},i=t.Map;if(!i||-1===i.toString().indexOf("[native code]")||!new i([[1,1]]).size){var n=Object.prototype.hasOwnProperty,s=e("mapId"),r=0,a={value:void 0};i=function(t){if(this._entries=Object.create(null),this._objectStamps={},this._first=null,this._last=null,this.size=0,t)for(var e=0,i=t.length;e<i;e++)this.set(t[e][0],t[e][1])},i.prototype={constructor:i,has:function(t){return!!this._entries[this._getValueStamp(t)]},get:function(t){return(this._entries[this._getValueStamp(t)]||a).value},set:function(t,e){var i=this._entries,n=this._getValueStamp(t);if(i[n])i[n].value=e;else{var s=i[n]={key:t,keyStamp:n,value:e,prev:this._last,next:null};this.size++?this._last.next=s:this._first=s,this._last=s}return this},delete:function(t){var e=this._getValueStamp(t),i=this._entries[e];if(!i)return!1;if(--this.size){var n=i.prev,s=i.next;n?n.next=s:this._first=s,s?s.prev=n:this._last=n}else this._first=null,this._last=null;return delete this._entries[e],delete this._objectStamps[e],!0},clear:function(){var t=this._entries;for(var e in t)delete t[e];this._objectStamps={},this._first=null,this._last=null,this.size=0},forEach:function(t,e){var i=this._first;while(i){t.call(e,i.value,i.key,this);do{i=i.next}while(i&&!this._entries[i.keyStamp])}},toString:function(){return"[object Map]"},_getValueStamp:function(t){switch(typeof t){case"undefined":return"undefined";case"object":if(null===t)return"null";break;case"boolean":return"?"+t;case"number":return"+"+t;case"string":return","+t}return this._getObjectStamp(t)},_getObjectStamp:function(t){if(!n.call(t,s)){if(!Object.isExtensible(t)){var e,i=this._objectStamps;for(e in i)if(n.call(i,e)&&i[e]==t)return e;return e=String(++r),i[e]=t,e}Object.defineProperty(t,s,{value:String(++r)})}return t[s]}},[["keys",function(t){return t.key}],["values",function(t){return t.value}],["entries",function(t){return[t.key,t.value]}]].forEach((function(t){var e=t[1];i.prototype[t[0]]=function(){var t,i=this._entries,n=!1,s=this;return{next:function(){if(!n){if(t)do{t=t.next}while(t&&!i[t.keyStamp]);else t=s._first;if(t)return{value:e(t),done:!1};n=!0}return{value:void 0,done:!0}}}}}))}i.prototype[e.iterator]||(i.prototype[e.iterator]=i.prototype.entries);var o=t.Set;o&&-1!==o.toString().indexOf("[native code]")&&new o([1]).size||(o=function(t){this._values=new i(t?t.map((function(t){return[t,t]})):[]),this.size=0},o.prototype={constructor:o,has:function(t){return this._values.has(t)},add:function(t){return this._values.set(t,t),this.size=this._values.size,this},delete:function(t){return!!this._values.delete(t)&&(this.size--,!0)},clear:function(){this._values.clear(),this.size=0},forEach:function(t,e){this._values.forEach((function(i){t.call(e,i,i,this)}),this)},keys:i.prototype.keys,values:i.prototype.values,entries:i.prototype.entries}),o.prototype[e.iterator]||(o.prototype[e.iterator]=o.prototype.values),t.Map=i,t.Set=o})("undefined"!==typeof window?window:i.g)},1583:function(t,e,i){(function(t,e,i){"use strict";let n,s=0,r=["ms","moz","webkit","o"];for(n=0;n<r.length&&!t[e];++n)t[e]=t[r[n]+"RequestAnimationFrame"],t[i]=t[r[n]+"CancelAnimationFrame"]||t[r[n]+"CancelRequestAnimationFrame"];t[e]||(t[e]=function(e){let i=(new Date).getTime(),n=Math.max(0,16-(i-s)),r=t.setTimeout((function(){e(i+n)}),n);return s=i+n,r}),t[i]||(t[i]=function(e){t.clearTimeout(e)})})("undefined"!==typeof window?window:i.g,"requestAnimationFrame","cancelAnimationFrame")},2901:function(t,e,i){
// @license http://opensource.org/licenses/MIT
(function(t){if("performance"in t===!1&&(t.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in t.performance===!1){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),t.performance.now=function(){return Date.now()-e}}})("undefined"!==typeof window?window:i.g)},3269:function(t,e,i){(function(){"use strict";const t=5;"function"!==typeof DataView.prototype.getUint40&&(DataView.prototype.getUint40=function(e,i=!1){if(e+t>this.byteLength)throw new RangeError("offset is outside the bounds of the DataView");if("number"!==typeof e)return;if(i){const t=this.getUint8(e),n=this.getUint32(e+1,i);return 256*n+t}const n=this.getUint32(e),s=this.getUint8(e+4);return 256*n+s},DataView.prototype.setUint40=function(e,i,n=!1){if(e+t>this.byteLength)throw new RangeError("offset is outside the bounds of the DataView");if("number"!==typeof e||"number"!==typeof i||i>0xffffffffff)return;const s=Math.floor(i/256),r=255&i;if(n)return this.setUint8(e,r),void this.setUint32(e+1,s,n);this.setUint32(e,s),this.setUint8(e+4,r)})})("undefined"!==typeof window?window:i.g)},3910:function(){String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var n=i.lastIndexOf(t,e);return-1!==n&&n===e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{configurable:!0,writable:!0,value:function(t,e){return e=e||0,this.substr(e,t.length)===t}})},4474:function(t,e,i){"use strict";t=i.hmd(t);
/*!
* PreloadJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/
const n=function(e,n){this.createjs=this.createjs||{},function(){var t=o.PreloadJS=o.PreloadJS||{};t.version="1.0.0",t.buildDate="Thu, 14 Sep 2017 19:47:47 GMT"}(),this.createjs=this.createjs||{},o.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},o.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},o.deprecate=function(t,e){return function(){var i="Deprecated property or method '"+e+"'. See docs for info.";return console&&(console.warn?console.warn(i):console.log(i)),t&&t.apply(this,arguments)}},this.createjs=this.createjs||{},function(){o.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},o.indexOf=function(t,e){for(var i=0,n=t.length;i<n;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},o.Event=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}var e=o.extend(t,o.Event);e.clone=function(){return new o.ErrorEvent(this.title,this.message,this.data)},o.ErrorEvent=o.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,a=s.length;r<a;r++)if(s[r]==e){1==a?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!e&&(!n||!n[t]))return!0;t=new o.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(h){}if(t.bubbles&&this.parent){var s=this,r=[s];while(s.parent)r.push(s=s.parent);var a,l=r.length;for(a=l-1;a>=0&&!t.propagationStopped;a--)r[a]._dispatchEvent(t,1+(0==a));for(a=1;a<l&&!t.propagationStopped;a++)r[a]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){var e=this;while(e){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n,s=e<=2?this._captureListeners:this._listeners;if(t&&s&&(n=s[t.type])&&(i=n.length)){try{t.currentTarget=this}catch(o){}try{t.eventPhase=0|e}catch(o){}t.removed=!1,n=n.slice();for(var r=0;r<i&&!t.immediatePropagationStopped;r++){var a=n[r];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},o.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}var e=o.extend(t,o.Event);e.clone=function(){return new o.ProgressEvent(this.loaded,this.total)},o.ProgressEvent=o.promote(t,"Event")}(),function(){var n="function"===typeof define&&i.amdO,s={function:!0,object:!0},r=s[typeof exports]&&exports&&!exports.nodeType&&exports,a=s[typeof e]&&e||this,o=r&&s["object"]&&t&&!t.nodeType&&"object"==typeof i.g&&i.g;function l(t,e){t||(t=a["Object"]()),e||(e=a["Object"]());var i=t["Number"]||a["Number"],n=t["String"]||a["String"],r=t["Object"]||a["Object"],o=t["Date"]||a["Date"],h=t["SyntaxError"]||a["SyntaxError"],c=t["TypeError"]||a["TypeError"],u=t["Math"]||a["Math"],d=t["JSON"]||a["JSON"];"object"==typeof d&&d&&(e.stringify=d.stringify,e.parse=d.parse);var f,p,m,g=r.prototype,v=g.toString,_=new o(-0xc782b5b800cec);try{_=-109252==_.getUTCFullYear()&&0===_.getUTCMonth()&&1===_.getUTCDate()&&10==_.getUTCHours()&&37==_.getUTCMinutes()&&6==_.getUTCSeconds()&&708==_.getUTCMilliseconds()}catch(Y){}function b(t){if(b[t]!==m)return b[t];var s;if("bug-string-char-index"==t)s="a"!="a"[0];else if("json"==t)s=b("json-stringify")&&b("json-parse");else{var r,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var l=e.stringify,h="function"==typeof l&&_;if(h){(r=function(){return 1}).toJSON=r;try{h="0"===l(0)&&"0"===l(new i)&&'""'==l(new n)&&l(v)===m&&l(m)===m&&l()===m&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([m])&&"null"==l(null)&&"[null,null,null]"==l([m,v,null])&&l({a:[r,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new o(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new o(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new o(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new o(-1))}catch(Y){h=!1}}s=h}if("json-parse"==t){var c=e.parse;if("function"==typeof c)try{if(0===c("0")&&!c(!1)){r=c(a);var u=5==r["a"].length&&1===r["a"][0];if(u){try{u=!c('"\t"')}catch(Y){}if(u)try{u=1!==c("01")}catch(Y){}if(u)try{u=1!==c("1.")}catch(Y){}}}}catch(Y){u=!1}s=u}}return b[t]=!!s}if(!b("json")){var y="[object Function]",w="[object Date]",E="[object Number]",C="[object String]",T="[object Array]",x="[object Boolean]",S=b("bug-string-char-index");if(!_)var I=u.floor,L=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(t,e){return L[e]+365*(t-1970)+I((t-1969+(e=+(e>1)))/4)-I((t-1901+e)/100)+I((t-1601+e)/400)};if((f=g.hasOwnProperty)||(f=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=v?f=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,f=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,f.call(this,t)}),p=function(t,e){var i,n,r,a=0;for(r in(i=function(){this.valueOf=0}).prototype.valueOf=0,n=new i,n)f.call(n,r)&&a++;return i=n=null,a?p=2==a?function(t,e){var i,n={},s=v.call(t)==y;for(i in t)s&&"prototype"==i||f.call(n,i)||!(n[i]=1)||!f.call(t,i)||e(i)}:function(t,e){var i,n,s=v.call(t)==y;for(i in t)s&&"prototype"==i||!f.call(t,i)||(n="constructor"===i)||e(i);(n||f.call(t,i="constructor"))&&e(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],p=function(t,e){var i,r,a=v.call(t)==y,o=!a&&"function"!=typeof t.constructor&&s[typeof t.hasOwnProperty]&&t.hasOwnProperty||f;for(i in t)a&&"prototype"==i||!o.call(t,i)||e(i);for(r=n.length;i=n[--r];o.call(t,i)&&e(i));}),p(t,e)},!b("json-stringify")){var A={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},k="000000",R=function(t,e){return(k+(e||0)).slice(-t)},P="\\u00",D=function(t){for(var e='"',i=0,n=t.length,s=!S||n>10,r=s&&(S?t.split(""):t);i<n;i++){var a=t.charCodeAt(i);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=A[a];break;default:if(a<32){e+=P+R(2,a.toString(16));break}e+=s?r[i]:t.charAt(i)}}return e+'"'},M=function(t,e,i,n,s,r,a){var o,l,h,u,d,g,_,b,y,S,L,A,k,P,j,B;try{o=e[t]}catch(Y){}if("object"==typeof o&&o)if(l=v.call(o),l!=w||f.call(o,"toJSON"))"function"==typeof o.toJSON&&(l!=E&&l!=C&&l!=T||f.call(o,"toJSON"))&&(o=o.toJSON(t));else if(o>-1/0&&o<1/0){if(O){for(d=I(o/864e5),h=I(d/365.2425)+1970-1;O(h+1,0)<=d;h++);for(u=I((d-O(h,0))/30.42);O(h,u+1)<=d;u++);d=1+d-O(h,u),g=(o%864e5+864e5)%864e5,_=I(g/36e5)%24,b=I(g/6e4)%60,y=I(g/1e3)%60,S=g%1e3}else h=o.getUTCFullYear(),u=o.getUTCMonth(),d=o.getUTCDate(),_=o.getUTCHours(),b=o.getUTCMinutes(),y=o.getUTCSeconds(),S=o.getUTCMilliseconds();o=(h<=0||h>=1e4?(h<0?"-":"+")+R(6,h<0?-h:h):R(4,h))+"-"+R(2,u+1)+"-"+R(2,d)+"T"+R(2,_)+":"+R(2,b)+":"+R(2,y)+"."+R(3,S)+"Z"}else o=null;if(i&&(o=i.call(e,t,o)),null===o)return"null";if(l=v.call(o),l==x)return""+o;if(l==E)return o>-1/0&&o<1/0?""+o:"null";if(l==C)return D(""+o);if("object"==typeof o){for(P=a.length;P--;)if(a[P]===o)throw c();if(a.push(o),L=[],j=r,r+=s,l==T){for(k=0,P=o.length;k<P;k++)A=M(k,o,i,n,s,r,a),L.push(A===m?"null":A);B=L.length?s?"[\n"+r+L.join(",\n"+r)+"\n"+j+"]":"["+L.join(",")+"]":"[]"}else p(n||o,(function(t){var e=M(t,o,i,n,s,r,a);e!==m&&L.push(D(t)+":"+(s?" ":"")+e)})),B=L.length?s?"{\n"+r+L.join(",\n"+r)+"\n"+j+"}":"{"+L.join(",")+"}":"{}";return a.pop(),B}};e.stringify=function(t,e,i){var n,r,a,o;if(s[typeof e]&&e)if((o=v.call(e))==y)r=e;else if(o==T){a={};for(var l,h=0,c=e.length;h<c;l=e[h++],o=v.call(l),(o==C||o==E)&&(a[l]=1));}if(i)if((o=v.call(i))==E){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else o==C&&(n=i.length<=10?i:i.slice(0,10));return M("",(l={},l[""]=t,l),r,a,n,"",[])}}if(!b("json-parse")){var j,B,F=n.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},N=function(){throw j=B=null,h()},X=function(){var t,e,i,n,s,r=B,a=r.length;while(j<a)switch(s=r.charCodeAt(j),s){case 9:case 10:case 13:case 32:j++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=S?r.charAt(j):r[j],j++,t;case 34:for(t="@",j++;j<a;)if(s=r.charCodeAt(j),s<32)N();else if(92==s)switch(s=r.charCodeAt(++j),s){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=U[s],j++;break;case 117:for(e=++j,i=j+4;j<i;j++)s=r.charCodeAt(j),s>=48&&s<=57||s>=97&&s<=102||s>=65&&s<=70||N();t+=F("0x"+r.slice(e,j));break;default:N()}else{if(34==s)break;s=r.charCodeAt(j),e=j;while(s>=32&&92!=s&&34!=s)s=r.charCodeAt(++j);t+=r.slice(e,j)}if(34==r.charCodeAt(j))return j++,t;N();default:if(e=j,45==s&&(n=!0,s=r.charCodeAt(++j)),s>=48&&s<=57){for(48==s&&(s=r.charCodeAt(j+1),s>=48&&s<=57)&&N(),n=!1;j<a&&(s=r.charCodeAt(j),s>=48&&s<=57);j++);if(46==r.charCodeAt(j)){for(i=++j;i<a&&(s=r.charCodeAt(i),s>=48&&s<=57);i++);i==j&&N(),j=i}if(s=r.charCodeAt(j),101==s||69==s){for(s=r.charCodeAt(++j),43!=s&&45!=s||j++,i=j;i<a&&(s=r.charCodeAt(i),s>=48&&s<=57);i++);i==j&&N(),j=i}return+r.slice(e,j)}if(n&&N(),"true"==r.slice(j,j+4))return j+=4,!0;if("false"==r.slice(j,j+5))return j+=5,!1;if("null"==r.slice(j,j+4))return j+=4,null;N()}return"$"},H=function(t){var e,i;if("$"==t&&N(),"string"==typeof t){if("@"==(S?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];;i||(i=!0)){if(t=X(),"]"==t)break;i&&(","==t?(t=X(),"]"==t&&N()):N()),","==t&&N(),e.push(H(t))}return e}if("{"==t){for(e={};;i||(i=!0)){if(t=X(),"}"==t)break;i&&(","==t?(t=X(),"}"==t&&N()):N()),","!=t&&"string"==typeof t&&"@"==(S?t.charAt(0):t[0])&&":"==X()||N(),e[t.slice(1)]=H(X())}return e}N()}return t},V=function(t,e,i){var n=G(t,e,i);n===m?delete t[e]:t[e]=n},G=function(t,e,i){var n,s=t[e];if("object"==typeof s&&s)if(v.call(s)==T)for(n=s.length;n--;)V(s,n,i);else p(s,(function(t){V(s,t,i)}));return i.call(t,e,s)};e.parse=function(t,e){var i,n;return j=0,B=""+t,i=H(X()),"$"!=X()&&N(),j=B=null,e&&v.call(e)==y?G((n={},n[""]=i,n),"",e):i}}}return e["runInContext"]=l,e}if(!o||o["global"]!==o&&o["window"]!==o&&o["self"]!==o||(a=o),r&&!n)l(a,r);else{var h=a.JSON,c=a["JSON3"],u=!1,d=l(a,a["JSON3"]={noConflict:function(){return u||(u=!0,a.JSON=h,a["JSON3"]=c,h=c=null),d}});a.JSON={parse:d.parse,stringify:d.stringify}}n&&define((function(){return d}))}.call(this),function(){var t={a:function(){return t.el("a")},svg:function(){return t.el("svg")},object:function(){return t.el("object")},image:function(){return t.el("image")},img:function(){return t.el("img")},style:function(){return t.el("style")},link:function(){return t.el("link")},script:function(){return t.el("script")},audio:function(){return t.el("audio")},video:function(){return t.el("video")},text:function(t){return n.createTextNode(t)},el:function(t){return n.createElement(t)}};o.Elements=t}(),function(){var t={ABSOLUTE_PATT:/^(?:\w+:)?\/{2}/i,RELATIVE_PATT:/^[./]*?\//i,EXTENSION_PATT:/\/?[^/]+\.(\w{1,5})$/i,parseURI:function(e){var i={absolute:!1,relative:!1,protocol:null,hostname:null,port:null,pathname:null,search:null,hash:null,host:null};if(null==e)return i;var n=o.Elements.a();for(var s in n.href=e,i)s in n&&(i[s]=n[s]);var r,a=e.indexOf("?");return a>-1&&(e=e.substr(0,a)),t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(r=e.match(t.EXTENSION_PATT))&&(i.extension=r[1].toLowerCase()),i},formatQueryString:function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var n in t)i.push(n+"="+escape(t[n]));return e&&(i=i.concat(e)),i.join("&")},buildURI:function(t,e){if(null==e)return t;var i=[],n=t.indexOf("?");if(-1!=n){var s=t.slice(n+1);i=i.concat(s.split("&"))}return-1!=n?t.slice(0,n)+"?"+this.formatQueryString(e,i):t+"?"+this.formatQueryString(e,i)},isCrossDomain:function(t){var e=o.Elements.a();e.href=t.src;var i=o.Elements.a();i.href=location.href;var n=""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname);return n},isLocal:function(t){var e=o.Elements.a();return e.href=t.src,""==e.hostname&&"file:"==e.protocol}};o.URLUtils=t}(),function(){var t={container:null,appendToHead:function(e){t.getHead().appendChild(e)},appendToBody:function(e){if(null==t.container){t.container=n.createElement("div"),t.container.id="preloadjs-container";var i=t.container.style;i.visibility="hidden",i.position="absolute",i.width=t.container.style.height="10px",i.overflow="hidden",i.transform=i.msTransform=i.webkitTransform=i.oTransform="translate(-10px, -10px)",t.getBody().appendChild(t.container)}t.container.appendChild(e)},getHead:function(){return n.head||n.getElementsByTagName("head")[0]},getBody:function(){return n.body||n.getElementsByTagName("body")[0]},removeChild:function(t){t.parent&&t.parent.removeChild(t)},isImageTag:function(t){return t instanceof HTMLImageElement},isAudioTag:function(t){return!!e.HTMLAudioElement&&t instanceof HTMLAudioElement},isVideoTag:function(t){return!!e.HTMLVideoElement&&t instanceof HTMLVideoElement}};o.DomUtils=t}(),function(){var t={parseXML:function(t){var i=null;try{if(e.DOMParser){var n=new DOMParser;i=n.parseFromString(t,"text/xml")}}catch(s){}if(!i)try{i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t)}catch(s){i=null}return i},parseJSON:function(t){if(null==t)return null;try{return JSON.parse(t)}catch(e){throw e}}};o.DataUtils=t}(),this.createjs=this.createjs||{},function(){var t={BINARY:"binary",CSS:"css",FONT:"font",FONTCSS:"fontcss",IMAGE:"image",JAVASCRIPT:"javascript",JSON:"json",JSONP:"jsonp",MANIFEST:"manifest",SOUND:"sound",VIDEO:"video",SPRITESHEET:"spritesheet",SVG:"svg",TEXT:"text",XML:"xml"};o.Types=t}(),this.createjs=this.createjs||{},function(){var t={POST:"POST",GET:"GET"};o.Methods=t}(),this.createjs=this.createjs||{},function(){function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=o.Methods.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},i=t;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof i)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},o.LoadItem=i}(),function(){var t={isBinary:function(t){switch(t){case o.Types.IMAGE:case o.Types.BINARY:return!0;default:return!1}},isText:function(t){switch(t){case o.Types.TEXT:case o.Types.JSON:case o.Types.MANIFEST:case o.Types.XML:case o.Types.CSS:case o.Types.SVG:case o.Types.JAVASCRIPT:case o.Types.SPRITESHEET:return!0;default:return!1}},getTypeByExtension:function(t){if(null==t)return o.Types.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return o.Types.IMAGE;case"ogg":case"mp3":case"webm":return o.Types.SOUND;case"mp4":case"webm":case"ts":return o.Types.VIDEO;case"json":return o.Types.JSON;case"xml":return o.Types.XML;case"css":return o.Types.CSS;case"js":return o.Types.JAVASCRIPT;case"svg":return o.Types.SVG;default:return o.Types.TEXT}}};o.RequestUtils=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?o.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var i=o.extend(t,o.EventDispatcher),n=t;try{Object.defineProperties(n,{POST:{get:o.deprecate((function(){return o.Methods.POST}),"AbstractLoader.POST")},GET:{get:o.deprecate((function(){return o.Methods.GET}),"AbstractLoader.GET")},BINARY:{get:o.deprecate((function(){return o.Types.BINARY}),"AbstractLoader.BINARY")},CSS:{get:o.deprecate((function(){return o.Types.CSS}),"AbstractLoader.CSS")},FONT:{get:o.deprecate((function(){return o.Types.FONT}),"AbstractLoader.FONT")},FONTCSS:{get:o.deprecate((function(){return o.Types.FONTCSS}),"AbstractLoader.FONTCSS")},IMAGE:{get:o.deprecate((function(){return o.Types.IMAGE}),"AbstractLoader.IMAGE")},JAVASCRIPT:{get:o.deprecate((function(){return o.Types.JAVASCRIPT}),"AbstractLoader.JAVASCRIPT")},JSON:{get:o.deprecate((function(){return o.Types.JSON}),"AbstractLoader.JSON")},JSONP:{get:o.deprecate((function(){return o.Types.JSONP}),"AbstractLoader.JSONP")},MANIFEST:{get:o.deprecate((function(){return o.Types.MANIFEST}),"AbstractLoader.MANIFEST")},SOUND:{get:o.deprecate((function(){return o.Types.SOUND}),"AbstractLoader.SOUND")},VIDEO:{get:o.deprecate((function(){return o.Types.VIDEO}),"AbstractLoader.VIDEO")},SPRITESHEET:{get:o.deprecate((function(){return o.Types.SPRITESHEET}),"AbstractLoader.SPRITESHEET")},SVG:{get:o.deprecate((function(){return o.Types.SVG}),"AbstractLoader.SVG")},TEXT:{get:o.deprecate((function(){return o.Types.TEXT}),"AbstractLoader.TEXT")},XML:{get:o.deprecate((function(){return o.Types.XML}),"AbstractLoader.XML")}})}catch(s){}i.getItem=function(){return this._item},i.getResult=function(t){return t?this._rawResult:this._result},i.getTag=function(){return this._tag},i.setTag=function(t){this._tag=t},i.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new o.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},i.cancel=function(){this.canceled=!0,this.destroy()},i.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},i.getLoadedItems=function(){return this._loadedItems},i._createRequest=function(){this._preferXHR?this._request=new o.XHRRequest(this._item):this._request=new o.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},i._createTag=function(t){return null},i._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},i._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new o.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},i._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new o.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},i._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new o.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},i._isCanceled=function(){return!(null!=e.createjs&&!this.canceled)},i.resultFormatter=null,i.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this);e instanceof Function?e.call(this,o.proxy(this._resultFormatSuccess,this),o.proxy(this._resultFormatFailed,this)):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(new o.ErrorEvent("PRELOAD_"+t.type.toUpperCase()+"_ERROR"));break}},i._resultFormatSuccess=function(t){this._result=t,this._sendComplete()},i._resultFormatFailed=function(t){this._sendError(t)},i.toString=function(){return"[PreloadJS AbstractLoader]"},o.AbstractLoader=o.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.on("initialize",this._updateXHR,this)}var i=o.extend(t,o.AbstractLoader);i.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},i._createTag=function(){},i._createRequest=function(){this._preferXHR?this._request=new o.XHRRequest(this._item):this._request=new o.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},i._updateXHR=function(t){t.loader.setResponseType&&t.loader.setResponseType("blob")},i._formatResult=function(t){if(this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR){var i=e.URL||e.webkitURL,n=t.getResult(!0);t.getTag().src=i.createObjectURL(n)}return t.getTag()},o.AbstractMediaLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t=function(t){this._item=t},e=o.extend(t,o.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},o.AbstractRequest=o.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=o.proxy(this._handleTagComplete,this),this._addedToDOM=!1}var e=o.extend(t,o.AbstractRequest);e.load=function(){this._tag.onload=o.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=o.proxy(this._handleReadyStateChange,this),this._tag.onerror=o.proxy(this._handleError,this);var t=new o.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._loadTimeout=setTimeout(o.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(o.DomUtils.appendToBody(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new o.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._handleStalled=function(){},o.TagRequest=o.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=o.proxy(this._handleTagComplete,this)}var e=o.extend(t,o.TagRequest);e.load=function(){var t=o.proxy(this._handleStalled,this);this._stalledCallback=t;var e=o.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;"loaded"!=t.readyState&&"complete"!=t.readyState||this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new o.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},o.MediaTagRequest=o.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=o.proxy(this._handleLoadStart,this),this._handleProgressProxy=o.proxy(this._handleProgress,this),this._handleAbortProxy=o.proxy(this._handleAbort,this),this._handleErrorProxy=o.proxy(this._handleError,this),this._handleTimeoutProxy=o.proxy(this._handleTimeout,this),this._handleLoadProxy=o.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=o.proxy(this._handleReadyStateChange,this),this._createXHR(t)}var i=o.extend(t,o.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],i.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},i.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},i.load=function(){if(null!=this._request){null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(o.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values?this._request.send(o.URLUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new o.ErrorEvent("XHR_SEND",null,t))}}else this._handleError()},i.setResponseType=function(t){"blob"===t&&(t=e.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},i.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},i.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},i._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new o.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},i._handleLoadStart=function(t){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},i._handleAbort=function(t){this._clean(),this.dispatchEvent(new o.ErrorEvent("XHR_ABORTED",null,t))},i._handleError=function(t){this._clean(),this.dispatchEvent(new o.ErrorEvent(t.message))},i._handleReadyStateChange=function(t){4==this._request.readyState&&this._handleLoad()},i._handleLoad=function(t){if(!this.loaded){this.loaded=!0;var i=this._checkError();if(i)this._handleError(i);else{if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(s){if(e.BlobBuilder=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,"TypeError"===s.name&&e.BlobBuilder){var n=new BlobBuilder;n.append(this._response),this._response=n.getBlob()}}this._clean(),this.dispatchEvent(new o.Event("complete"))}}},i._handleTimeout=function(t){this._clean(),this.dispatchEvent(new o.ErrorEvent("PRELOAD_TIMEOUT",null,t))},i._checkError=function(){var t=parseInt(this._request.status);return t>=400&&t<=599?new Error(t):0==t&&/^https?:/.test(location.protocol)?new Error(0):null},i._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},i._createXHR=function(t){var i=o.URLUtils.isCrossDomain(t),n={},r=null;if(e.XMLHttpRequest)r=new XMLHttpRequest,i&&void 0===r.withCredentials&&e.XDomainRequest&&(r=new XDomainRequest);else{for(var a=0,l=s.ACTIVEX_VERSIONS.length;a<l;a++){var h=s.ACTIVEX_VERSIONS[a];try{r=new ActiveXObject(h);break}catch(d){}}if(null==r)return!1}null==t.mimeType&&o.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),this._xhrLevel="string"===typeof r.responseType?2:1;var c=null;if(c=t.method==o.Methods.GET?o.URLUtils.buildURI(t.src,t.values):t.src,r.open(t.method||o.Methods.GET,c,!0),i&&r instanceof XMLHttpRequest&&1==this._xhrLevel&&(n["Origin"]=location.origin),t.values&&t.method==o.Methods.POST&&(n["Content-Type"]="application/x-www-form-urlencoded"),i||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var u in t.headers)n[u]=t.headers[u];for(u in n)r.setRequestHeader(u,n[u]);return r instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(r.withCredentials=t.withCredentials),this._request=r,!0},i._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},i.toString=function(){return"[PreloadJS XHRRequest]"},o.XHRRequest=o.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[o.FontLoader,o.ImageLoader,o.JavaScriptLoader,o.CSSLoader,o.JSONLoader,o.JSONPLoader,o.SoundLoader,o.ManifestLoader,o.SpriteSheetLoader,o.XMLLoader,o.SVGLoader,o.BinaryLoader,o.VideoLoader,o.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,i)}var i=o.extend(t,o.AbstractLoader),n=t;try{Object.defineProperties(n,{POST:{get:o.deprecate((function(){return o.Methods.POST}),"AbstractLoader.POST")},GET:{get:o.deprecate((function(){return o.Methods.GET}),"AbstractLoader.GET")},BINARY:{get:o.deprecate((function(){return o.Types.BINARY}),"AbstractLoader.BINARY")},CSS:{get:o.deprecate((function(){return o.Types.CSS}),"AbstractLoader.CSS")},FONT:{get:o.deprecate((function(){return o.Types.FONT}),"AbstractLoader.FONT")},FONTCSS:{get:o.deprecate((function(){return o.Types.FONTCSS}),"AbstractLoader.FONTCSS")},IMAGE:{get:o.deprecate((function(){return o.Types.IMAGE}),"AbstractLoader.IMAGE")},JAVASCRIPT:{get:o.deprecate((function(){return o.Types.JAVASCRIPT}),"AbstractLoader.JAVASCRIPT")},JSON:{get:o.deprecate((function(){return o.Types.JSON}),"AbstractLoader.JSON")},JSONP:{get:o.deprecate((function(){return o.Types.JSONP}),"AbstractLoader.JSONP")},MANIFEST:{get:o.deprecate((function(){return o.Types.MANIFEST}),"AbstractLoader.MANIFEST")},SOUND:{get:o.deprecate((function(){return o.Types.SOUND}),"AbstractLoader.SOUND")},VIDEO:{get:o.deprecate((function(){return o.Types.VIDEO}),"AbstractLoader.VIDEO")},SPRITESHEET:{get:o.deprecate((function(){return o.Types.SPRITESHEET}),"AbstractLoader.SPRITESHEET")},SVG:{get:o.deprecate((function(){return o.Types.SVG}),"AbstractLoader.SVG")},TEXT:{get:o.deprecate((function(){return o.Types.TEXT}),"AbstractLoader.TEXT")},XML:{get:o.deprecate((function(){return o.Types.XML}),"AbstractLoader.XML")}})}catch(s){}i.init=function(t,e,i){this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=NaN},i.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},i.unregisterLoader=function(t){var e=this._availableLoaders.indexOf(t);-1!=e&&e<this._defaultLoaderLength-1&&this._availableLoaders.splice(e,1)},i.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=e.XMLHttpRequest,this.preferXHR},i.removeAll=function(){this.remove()},i.remove=function(t){var e=null;if(t&&!Array.isArray(t))e=[t];else if(t)e=t;else if(arguments.length>0)return;var i=!1;if(e){while(e.length){var n=e.pop(),s=this.getResult(n);for(r=this._loadQueue.length-1;r>=0;r--)if(a=this._loadQueue[r].getItem(),a.id==n||a.src==n){this._loadQueue.splice(r,1)[0].cancel();break}for(r=this._loadQueueBackup.length-1;r>=0;r--)if(a=this._loadQueueBackup[r].getItem(),a.id==n||a.src==n){this._loadQueueBackup.splice(r,1)[0].cancel();break}if(s)this._disposeItem(this.getItem(n));else for(var r=this._currentLoads.length-1;r>=0;r--){var a=this._currentLoads[r].getItem();if(a.id==n||a.src==n){this._currentLoads.splice(r,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{for(var o in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[o]);this.init(this.preferXHR,this._basePath)}},i.reset=function(){for(var t in this.close(),this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],i=0,n=this._loadQueueBackup.length;i<n;i++)e.push(this._loadQueueBackup[i].getItem());this.loadManifest(e,!1)},i.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var i=0,n=e.types.length;i<n;i++)this._typeCallbacks[e.types[i]]=e;if(null!=e.extensions)for(i=0,n=e.extensions.length;i<n;i++)this._extensionCallbacks[e.extensions[i]]=e}},i.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&this._loadQueue.length>0&&this._loadNext()},i.loadFile=function(t,e,i){if(null!=t)this._addItem(t,null,i),!1!==e?this.setPaused(!1):this.setPaused(!0);else{var n=new o.ErrorEvent("PRELOAD_NO_FILE");this._sendError(n)}},i.loadManifest=function(t,e,i){var s=null,r=null;if(Array.isArray(t)){if(0==t.length){var a=new o.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(a)}s=t}else if("string"===typeof t)s=[{src:t,type:n.MANIFEST}];else{if("object"!=typeof t){a=new o.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(a)}if(void 0!==t.src){if(null==t.type)t.type=n.MANIFEST;else if(t.type!=n.MANIFEST){var a=new o.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(a)}s=[t]}else void 0!==t.manifest&&(s=t.manifest,r=t.path)}for(var l=0,h=s.length;l<h;l++)this._addItem(s[l],r,i);!1!==e?this.setPaused(!1):this.setPaused(!0)},i.load=function(){this.setPaused(!1)},i.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},i.getResult=function(t,e){var i=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==i)return null;var n=i.id;return e&&this._loadedRawResults[n]?this._loadedRawResults[n]:this._loadedResults[n]},i.getItems=function(t){var e=[];for(var i in this._loadItemsById){var n=this._loadItemsById[i],s=this.getResult(i);!0===t&&null==s||e.push({item:n,result:s,rawResult:this.getResult(i,!0)})}return e},i.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},i.close=function(){while(this._currentLoads.length)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=NaN},i._addItem=function(t,e,i){var n=this._createLoadItem(t,e,i);if(null!=n){var s=this._createLoader(n);null!=s&&("plugins"in s&&(s.plugins=this._plugins),n._loader=s,this._loadQueue.push(s),this._loadQueueBackup.push(s),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&n.type==o.Types.JAVASCRIPT||!0===n.maintainOrder)&&(this._scriptOrder.push(n),this._loadedScripts.push(null)))}},i._createLoadItem=function(t,e,i){var n=o.LoadItem.create(t);if(null==n)return null;var s="",r=i||this._basePath;if(n.src instanceof Object){if(!n.type)return null;if(e){s=e;var a=o.URLUtils.parseURI(e);null==r||a.absolute||a.relative||(s=r+s)}else null!=r&&(s=r)}else{var l=o.URLUtils.parseURI(n.src);l.extension&&(n.ext=l.extension),null==n.type&&(n.type=o.RequestUtils.getTypeByExtension(n.ext));var h=n.src;if(!l.absolute&&!l.relative)if(e){s=e;a=o.URLUtils.parseURI(e);h=e+h,null==r||a.absolute||a.relative||(s=r+s)}else null!=r&&(s=r);n.src=s+n.src}n.path=s,void 0!==n.id&&null!==n.id&&""!==n.id||(n.id=h);var c=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(c){var u=c.callback.call(c.scope,n,this);if(!1===u)return null;!0===u||null!=u&&(n._loader=u),l=o.URLUtils.parseURI(n.src),null!=l.extension&&(n.ext=l.extension)}return this._loadItemsById[n.id]=n,this._loadItemsBySrc[n.src]=n,null==n.crossOrigin&&(n.crossOrigin=this._crossOrigin),n},i._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var n=this._availableLoaders[i];if(n&&n.canLoadItem(t))return new n(t,e)}return null},i._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length;t++){if(this._currentLoads.length>=this._maxConnections)break;var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},i._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},i._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},i._handleFileError=function(t){var e=new o.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(e)},i._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();var i=new o.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(i),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},i._handleFileComplete=function(t){var e=t.target,i=e.getItem(),n=e.getResult();this._loadedResults[i.id]=n;var s=e.getResult(!0);null!=s&&s!==n&&(this._loadedRawResults[i.id]=s),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(i,e),this._cleanLoadItem(e)},i._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var i=0;i<e.length;i++){var n=e[i].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=e[i].result,this._loadedRawResults[n.id]=e[i].rawResult}},i._finishOrderedItem=function(t,e){var i=t.getItem();if(this.maintainScriptOrder&&i.type==o.Types.JAVASCRIPT||i.maintainOrder){t instanceof o.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var n=o.indexOf(this._scriptOrder,i);return-1!=n&&(this._loadedScripts[n]=!0===e||i,this._checkScriptLoadOrder(),!0)}return!1},i._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;e<t;e++){var i=this._loadedScripts[e];if(null===i)break;if(!0!==i){var n=this._loadedResults[i.id];i.type==o.Types.JAVASCRIPT&&o.DomUtils.appendToHead(n);var s=i._loader;this._processFinishedLoad(i,s),this._loadedScripts[e]=!0}}},i._processFinishedLoad=function(t,e){if(this._numItemsLoaded++,!this.maintainScriptOrder&&t.type==o.Types.JAVASCRIPT){var i=e.getTag();o.DomUtils.appendToHead(i)}this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},i._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;var e=t.getItem();if(e.type!=o.Types.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;var i=this._scriptOrder.indexOf(e),n=0;while(n<i){var s=this._loadedScripts[n];if(null==s)return!1;n++}return this._currentlyLoadingScript=!0,!0},i._removeLoadItem=function(t){for(var e=this._currentLoads.length,i=0;i<e;i++)if(this._currentLoads[i]==t){this._currentLoads.splice(i,1);break}},i._cleanLoadItem=function(t){var e=t.getItem();e&&delete e._loader},i._handleProgress=function(t){var e=t.target;this._sendFileProgress(e.getItem(),e.progress),this._updateProgress()},i._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(e>0){for(var i=0,n=0,s=this._currentLoads.length;n<s;n++)i+=this._currentLoads[n].progress;t+=i/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},i._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},i._sendFileProgress=function(t,e){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var i=new o.Event("fileprogress");i.progress=e,i.loaded=e,i.total=1,i.item=t,this.dispatchEvent(i)}},i._sendFileComplete=function(t,e){if(!this._isCanceled()&&!this._paused){var i=new o.Event("fileload");i.loader=e,i.item=t,i.result=this._loadedResults[t.id],i.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i)}},i._sendFileStart=function(t){var e=new o.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},i.toString=function(){return"[PreloadJS LoadQueue]"},o.LoadQueue=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,o.Types.TEXT)}o.extend(t,o.AbstractLoader);var e=t;e.canLoadItem=function(t){return t.type==o.Types.TEXT},o.TextLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,o.Types.BINARY),this.on("initialize",this._updateXHR,this)}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},o.BinaryLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=e?o.Elements.style():o.Elements.link(),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.CSS},e._formatResult=function(t){if(this._preferXHR){var e=t.getTag();if(e.styleSheet)e.styleSheet.cssText=t.getResult(!0);else{var i=o.Elements.text(t.getResult(!0));e.appendChild(i)}}else e=this._tag;return o.DomUtils.appendToHead(e),e},o.CSSLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,t.type),this._faces={},this._watched=[],this._count=0,this._watchInterval=null,this._loadTimeout=null,this._injectCSS=void 0===t.injectCSS||t.injectCSS,this.dispatchEvent("initialize")}var e=o.extend(t,o.AbstractLoader);t.canLoadItem=function(t){return t.type==o.Types.FONT||t.type==o.Types.FONTCSS},t.sampleText="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",t._ctx=n.createElement("canvas").getContext("2d"),t._referenceFonts=["serif","monospace"],t.WEIGHT_REGEX=/[- ._]*(thin|normal|book|regular|medium|black|heavy|[1-9]00|(?:extra|ultra|semi|demi)?[- ._]*(?:light|bold))[- ._]*/gi,t.STYLE_REGEX=/[- ._]*(italic|oblique)[- ._]*/gi,t.FONT_FORMAT={woff2:"woff2",woff:"woff",ttf:"truetype",otf:"truetype"},t.FONT_WEIGHT={thin:100,extralight:200,ultralight:200,light:300,semilight:300,demilight:300,book:"normal",regular:"normal",semibold:600,demibold:600,extrabold:800,ultrabold:800,black:900,heavy:900},t.WATCH_DURATION=10,e.load=function(){if(this.type==o.Types.FONTCSS){var t=this._watchCSS();if(!t)return void this.AbstractLoader_load()}else if(this._item.src instanceof Array)this._watchFontArray();else{var e=this._defFromSrc(this._item.src);this._watchFont(e),this._injectStyleTag(this._cssFromDef(e))}this._loadTimeout=setTimeout(o.proxy(this._handleTimeout,this),this._item.loadTimeout),this.dispatchEvent("loadstart")},e._handleTimeout=function(){this._stopWatching(),this.dispatchEvent(new o.ErrorEvent("PRELOAD_TIMEOUT"))},e._createRequest=function(){return this._request},e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response,this._result=!0,this._parseCSS(this._rawResult);break;case"error":this._stopWatching(),this.AbstractLoader_handleEvent(t);break}},e._watchCSS=function(){var t=this._item.src;return t instanceof HTMLStyleElement&&(this._injectCSS&&!t.parentNode&&(n.head||n.getElementsByTagName("head")[0]).appendChild(t),this._injectCSS=!1,t="\n"+t.textContent),-1!==t.search(/\n|\r|@font-face/i)?(this._parseCSS(t),!0):(this._request=new o.XHRRequest(this._item),!1)},e._parseCSS=function(t){var e=/@font-face\s*\{([^}]+)}/g;while(1){var i=e.exec(t);if(!i)break;this._watchFont(this._parseFontFace(i[1]))}this._injectStyleTag(t)},e._watchFontArray=function(){for(var t,e=this._item.src,i="",n=e.length-1;n>=0;n--){var s=e[n];t="string"===typeof s?this._defFromSrc(s):this._defFromObj(s),this._watchFont(t),i+=this._cssFromDef(t)+"\n"}this._injectStyleTag(i)},e._injectStyleTag=function(t){if(this._injectCSS){var e=n.head||n.getElementsByTagName("head")[0],i=n.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(n.createTextNode(t)),e.appendChild(i)}},e._parseFontFace=function(t){var e=this._getCSSValue(t,"font-family"),i=this._getCSSValue(t,"src");return e&&i?this._defFromObj({family:e,src:i,style:this._getCSSValue(t,"font-style"),weight:this._getCSSValue(t,"font-weight")}):null},e._watchFont=function(t){t&&!this._faces[t.id]&&(this._faces[t.id]=t,this._watched.push(t),this._count++,this._calculateReferenceSizes(t),this._startWatching())},e._startWatching=function(){null==this._watchInterval&&(this._watchInterval=setInterval(o.proxy(this._watch,this),t.WATCH_DURATION))},e._stopWatching=function(){clearInterval(this._watchInterval),clearTimeout(this._loadTimeout),this._watchInterval=null},e._watch=function(){for(var e=this._watched,i=t._referenceFonts,n=e.length,s=n-1;s>=0;s--)for(var r=e[s],a=r.refs,l=a.length-1;l>=0;l--){var h=this._getTextWidth(r.family+","+i[l],r.weight,r.style);if(h!=a[l]){var c=new o.Event("fileload");r.type="font-family",c.item=r,this.dispatchEvent(c),e.splice(s,1);break}}if(n!==e.length){c=new o.ProgressEvent(this._count-e.length,this._count);this.dispatchEvent(c)}0===n&&(this._stopWatching(),this._sendComplete())},e._calculateReferenceSizes=function(e){for(var i=t._referenceFonts,n=e.refs=[],s=0;s<i.length;s++)n[s]=this._getTextWidth(i[s],e.weight,e.style)},e._defFromSrc=function(e){var i,n=/[- ._]+/g,s=e,r=null;i=s.search(/[?#]/),-1!==i&&(s=s.substr(0,i)),i=s.lastIndexOf("."),-1!==i&&(r=s.substr(i+1),s=s.substr(0,i)),i=s.lastIndexOf("/"),-1!==i&&(s=s.substr(i+1));var a=s,o=a.match(t.WEIGHT_REGEX);o&&(o=o[0],a=a.replace(o,""),o=o.replace(n,"").toLowerCase());var l=s.match(t.STYLE_REGEX);l&&(a=a.replace(l[0],""),l="italic"),a=a.replace(n,"");var h="local('"+s.replace(n," ")+"'), url('"+e+"')",c=t.FONT_FORMAT[r];return c&&(h+=" format('"+c+"')"),this._defFromObj({family:a,weight:t.FONT_WEIGHT[o]||o,style:l,src:h})},e._defFromObj=function(t){var e={family:t.family,src:t.src,style:t.style||"normal",weight:t.weight||"normal"};return e.id=e.family+";"+e.style+";"+e.weight,e},e._cssFromDef=function(t){return"@font-face {\n\tfont-family: '"+t.family+"';\n\tfont-style: "+t.style+";\n\tfont-weight: "+t.weight+";\n\tsrc: "+t.src+";\n}"},e._getTextWidth=function(e,i,n){var s=t._ctx;return s.font=n+" "+i+" 72px "+e,s.measureText(t.sampleText).width},e._getCSSValue=function(t,e){var i=new RegExp(e+":s*([^;}]+?)s*[;}]"),n=i.exec(t);return n&&n[1]?n[1]:null},o.FontLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",o.DomUtils.isImageTag(t)?this._tag=t:o.DomUtils.isImageTag(t.src)?this._tag=t.src:o.DomUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=o.Elements.img(),this.on("initialize",this._updateXHR,this)}var i=o.extend(t,o.AbstractLoader),n=t;n.canLoadItem=function(t){return t.type==o.Types.IMAGE},i.load=function(){if(""!=this._tag.src&&this._tag.complete)this._sendComplete();else{var t=this._item.crossOrigin;1==t&&(t="Anonymous"),null==t||o.URLUtils.isLocal(this._item)||(this._tag.crossOrigin=t),this.AbstractLoader_load()}},i._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},i._formatResult=function(t){return this._formatImage},i._formatImage=function(t,i){var n=this._tag,s=e.URL||e.webkitURL;if(this._preferXHR)if(s){var r=s.createObjectURL(this.getResult(!0));n.src=r,n.addEventListener("load",this._cleanUpURL,!1),n.addEventListener("error",this._cleanUpURL,!1)}else n.src=this._item.src;else;n.complete?t(n):(n.onload=o.proxy((function(){t(this._tag),n.onload=n.onerror=null}),this),n.onerror=o.proxy((function(t){i(new o.ErrorEvent("IMAGE_FORMAT",null,t)),n.onload=n.onerror=null}),this))},i._cleanUpURL=function(t){var i=e.URL||e.webkitURL;i.revokeObjectURL(t.target.src)},o.ImageLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(o.Elements.script())}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},o.JavaScriptLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,o.Types.JSON),this.resultFormatter=this._formatResult}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.JSON},e._formatResult=function(t){var e=null;try{e=o.DataUtils.parseJSON(t.getResult(!0))}catch(n){var i=new o.ErrorEvent("JSON_FORMAT",null,n);return this._sendError(i),n}return e},o.JSONLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!1,o.Types.JSONP),this.setTag(o.Elements.script()),this.getTag().type="text/javascript"}var i=o.extend(t,o.AbstractLoader),n=t;n.canLoadItem=function(t){return t.type==o.Types.JSONP},i.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},i.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=e[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");e[this._item.callback]=o.proxy(this._handleLoad,this),o.DomUtils.appendToBody(this._tag),this._loadTimeout=setTimeout(o.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},i._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},i._handleTimeout=function(){this._dispose(),this.dispatchEvent(new o.ErrorEvent("timeout"))},i._dispose=function(){o.DomUtils.removeChild(this._tag),delete e[this._item.callback],clearTimeout(this._loadTimeout)},o.JSONPLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=o.extend(t,o.AbstractLoader),i=t;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(t){return t.type==o.Types.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new o.JSONPLoader(this._item):new o.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new o.LoadQueue(this._preferXHR);e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var i=0,n=this.plugins.length;i<n;i++)e.installPlugin(this.plugins[i]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(t){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new o.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},o.ManifestLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,o.Types.SOUND),o.DomUtils.isAudioTag(t)||o.DomUtils.isAudioTag(t.src)?this._tag=t:o.DomUtils.isAudioTag(t.tag)&&(this._tag=o.DomUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=o.extend(t,o.AbstractMediaLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.SOUND},e._createTag=function(t){var e=o.Elements.audio();return e.autoplay=!1,e.preload="none",e.src=t,e},o.SoundLoader=o.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractMediaLoader_constructor(t,e,o.Types.VIDEO),o.DomUtils.isVideoTag(t)||o.DomUtils.isVideoTag(t.src)?(this.setTag(o.DomUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=o.extend(t,o.AbstractMediaLoader),i=t;e._createTag=function(){return o.Elements.video()},i.canLoadItem=function(t){return t.type==o.Types.VIDEO},o.VideoLoader=o.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.SPRITESHEET),this._manifestQueue=null}var e=o.extend(t,o.AbstractLoader),i=t;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(t){return t.type==o.Types.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new o.JSONPLoader(this._item):new o.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||this.progress==1/0)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){if(t&&t.images){var e=this._manifestQueue=new o.LoadQueue(this._preferXHR,this._item.path,this._item.crossOrigin);e.on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images)}},e._handleManifestFileLoad=function(t){var e=t.result;if(null!=e){var i=this.getResult().images,n=i.indexOf(t.item.src);i[n]=e}},e._handleManifestComplete=function(t){this._result=new o.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new o.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},o.SpriteSheetLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.AbstractLoader_constructor(t,e,o.Types.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(o.Elements.svg()):(this.setTag(o.Elements.object()),this.getTag().type="image/svg+xml")}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.SVG},e._formatResult=function(t){var e=o.DataUtils.parseXML(t.getResult(!0)),i=t.getTag();if(!this._preferXHR&&n.body.contains(i)&&n.body.removeChild(i),null!=e.documentElement){var s=e.documentElement;return n.importNode&&(s=n.importNode(s,!0)),i.appendChild(s),i}return e},o.SVGLoader=o.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){function t(t){this.AbstractLoader_constructor(t,!0,o.Types.XML),this.resultFormatter=this._formatResult}var e=o.extend(t,o.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==o.Types.XML},e._formatResult=function(t){return o.DataUtils.parseXML(t.getResult(!0))},o.XMLLoader=o.promote(t,"AbstractLoader")}()};if("undefined"===typeof r)var r=i.g.window||{};const a=r.document||{},o=r.createjs=r.createjs||{};n.call(r,r,a),e.A=o},5146:function(t,e,i){"use strict";var n=i(2547),s=i(5149),r=i(9949);const a={id:"app",class:"mk-p-ui"},o={key:1,class:"error_popup"},l=(0,s.Lk)("div",{class:"title"},"Oops!",-1),h={class:"content"};function c(t,e,i,n,c,u){const d=(0,s.g2)("Player");return(0,s.uX)(),(0,s.CE)("div",a,[!this.error&&this.visible?((0,s.uX)(),(0,s.Wv)(d,{key:0,id:"game-container",ref:"game",theme:c.theme,onPlay:e[0]||(e[0]=t=>u.evtProxy("play")),onSaveImage:e[1]||(e[1]=t=>u.evtProxy("save-image")),saveImageForceDownload:c.saveImageForceDownload,transparent:!1,colorWheel:!!this.manifest.color_wheel,poweredByPremiumLabel:this.manifest.poweredByPremiumLabel,poweredByPremiumHref:this.manifest.poweredByPremiumHref,presentationMode:c.presentationMode},null,8,["theme","saveImageForceDownload","colorWheel","poweredByPremiumLabel","poweredByPremiumHref","presentationMode"])):(0,s.Q3)("",!0),this.error?((0,s.uX)(),(0,s.CE)("div",o,[l,(0,s.Lk)("span",h,(0,r.v_)(c.error),1)])):(0,s.Q3)("",!0)])}function u(t,e,i,n,r,a){const o=(0,s.g2)("WelcomeScreen"),l=(0,s.g2)("GameCanvas"),h=(0,s.g2)("SplashScreen"),c=(0,s.g2)("ListItemButton"),u=(0,s.g2)("ScrollableList"),d=(0,s.g2)("Theme");return(0,s.uX)(),(0,s.Wv)(d,{ref:"wrapper",onPrepareSave:a.handlePrepareSave,onCancelSave:a.handleCancelSave,onSaveGame:a.handleSaveOnline,onRandom:a.handleRandomClick,onReset:a.handleResetClick,onUndo:a.handleUndoClick,onRedo:a.handleRedoClick,onFullscreenToggle:a.handleFullscreenToggle,onColor:a.handleSelectColorClick,onGamepad:a.handleGamePadClick,onStamps:a.handleStampsApplyClick,onDuplicateStamp:a.handleDuplicateStampClick,onFlipStampHorizontally:a.handleFlipStampHorizontallyClick,state:r.gameState,buttons:a.selectedItemMoveButtons,colors:a.selectedItemColors,colorWheel:a.isColorWheelActive,onColorVisible:a.handleColorVisibleChange,onColorWheelChange:a.handleColorWheelChange,loading:r.loading,fullPageLoading:r.saveFile&&r.saveFile.saving,showSaveButton:!!r.saveAction,showStampButtons:r.showStampButtons,showUndoRedoButtons:r.enableUndoButton||r.enableRedoButton,hamburgerMenuVisible:r.hamburgerMenuVisible,"onUpdate:hamburgerMenuVisible":e[1]||(e[1]=t=>{r.hamburgerMenuVisible=t}),enableUndoButton:r.enableUndoButton,enableRedoButton:r.enableRedoButton,enableFullscreenButton:r.enableFullscreenButton,blockStampButtons:r.isStampMovingOrDragging,saveImage:r.saveImage,saveImageForceDownload:i.saveImageForceDownload,saveScreenAnimation:i.saveScreenAnimation,poweredByHref:a.siteHomeLink,transparent:i.transparent,poweredByPremiumHref:i.poweredByPremiumHref,poweredByPremiumLabel:i.poweredByPremiumLabel,presentationMode:i.presentationMode},{welcomescreen:(0,s.k6)((()=>[r.welcomeScreenData?((0,s.uX)(),(0,s.Wv)(o,{key:0,data:r.welcomeScreenData,showPlayButton:!r.loading,onClickPlay:a.startLoadingGame,fullScreenOnPlay:r.fullScreenOnPlay,enableFullscreenButton:r.enableFullscreenButton,onFullscreenToggle:e[0]||(e[0]=t=>{r.fullScreenOnPlay=t}),poweredByPremiumHref:i.poweredByPremiumHref,poweredByPremiumLabel:i.poweredByPremiumLabel,presentationMode:i.presentationMode},null,8,["data","showPlayButton","onClickPlay","fullScreenOnPlay","enableFullscreenButton","poweredByPremiumHref","poweredByPremiumLabel","presentationMode"])):(0,s.Q3)("",!0)])),canvas:(0,s.k6)((()=>[(0,s.bF)(l,{ref:"display",canvasWidth:r.manifest.gameWidth,canvasHeight:r.manifest.gameHeight},null,8,["canvasWidth","canvasHeight"])])),"splash-screen":(0,s.k6)((()=>[a.isSplashScreenVisible?((0,s.uX)(),(0,s.Wv)(h,{key:0,presentationMode:i.presentationMode,onFinish:a.onSplashFinished},null,8,["presentationMode","onFinish"])):(0,s.Q3)("",!0)])),items:(0,s.k6)((()=>[(0,s.bF)(u,{items:a.selectedCategory.children,onSelect:a.handleImageClick,"highlight-active-items":!0},{default:(0,s.k6)((t=>[(0,s.bF)(c,{"parent-list":"items",item:t,"update-signal":r.itemsUpdateSignal,"base-url":r.manifest.baseUrl||""},null,8,["item","update-signal","base-url"])])),_:1},8,["items","onSelect"])])),categories:(0,s.k6)((()=>[(0,s.bF)(u,{items:r.categories,onSelect:a.handleCategoryClick},{default:(0,s.k6)((t=>[(0,s.bF)(c,{"parent-list":"categories",item:t,"base-url":r.manifest.baseUrl||""},null,8,["item","base-url"])])),_:1},8,["items","onSelect"])])),_:1},8,["onPrepareSave","onCancelSave","onSaveGame","onRandom","onReset","onUndo","onRedo","onFullscreenToggle","onColor","onGamepad","onStamps","onDuplicateStamp","onFlipStampHorizontally","state","buttons","colors","colorWheel","onColorVisible","onColorWheelChange","loading","fullPageLoading","showSaveButton","showStampButtons","showUndoRedoButtons","hamburgerMenuVisible","enableUndoButton","enableRedoButton","enableFullscreenButton","blockStampButtons","saveImage","saveImageForceDownload","saveScreenAnimation","poweredByHref","transparent","poweredByPremiumHref","poweredByPremiumLabel","presentationMode"])}const d=t=>((0,s.Qi)("data-v-08a15c64"),t=t(),(0,s.jt)(),t),f=d((()=>(0,s.Lk)("canvas",{width:"9px",height:"16px"},null,-1))),p={class:"hamburger-items"},m={class:"toolbar-tl"},g={class:"toolbar-br"},v={class:"g-categories g-scroll-container noselect"};function _(t,e,i,a,o,l){const h=(0,s.g2)("LoadingEllipsis"),c=(0,s.g2)("ColorWheelModal"),u=(0,s.g2)("OverlayAnimation"),d=(0,s.g2)("SaveGameOverlay"),_=(0,s.g2)("ScrollableColorList"),b=(0,s.g2)("GamePad"),y=(0,s.g2)("HamburgerButton"),w=(0,s.g2)("RandomButton"),E=(0,s.g2)("UndoButton"),C=(0,s.g2)("RedoButton"),T=(0,s.g2)("ResetButton"),x=(0,s.g2)("FullscreenButton"),S=(0,s.g2)("HelpButton"),I=(0,s.g2)("ModalOverlay"),L=(0,s.g2)("SaveButton"),O=(0,s.g2)("StampDuplicateButton"),A=(0,s.g2)("StampFlipHorizontalButton"),k=(0,s.g2)("StampRemoveButton"),R=(0,s.g2)("PoweredBy"),P=(0,s.g2)("LoadingOverlay"),D=(0,s.g2)("ScrollableList"),M=(0,s.g2)("ItemsBackButton"),j=(0,s.g2)("ResizeObserver"),B=(0,s.gN)("wheelblock");return(0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(`g-theme ${o.isFullscreen?"fullscreen-mode":""} ${o.isMobileIOS?"ios-device":""} ${l.backgroundColor?"":"g-rainbow"}`),style:(0,r.Tr)({background:i.transparent?"":l.backgroundColor})},[(0,s.Lk)("div",{class:(0,r.C4)(`g-theme-container ${o.columnsClass}`),style:(0,r.Tr)({backgroundColor:l.backgroundColor})},[(0,s.Lk)("div",{id:"ad-container",style:(0,r.Tr)({display:l.hideAdContainer?"none":"block"})},null,4),i.fullPageLoading?((0,s.uX)(),(0,s.CE)("div",{key:0,id:"full-overlay",style:(0,r.Tr)({backgroundColor:"rgba(0,0,0,0.3)"})},[(0,s.bF)(h)],4)):(0,s.Q3)("",!0),l.onWelcomeScreen?((0,s.uX)(),(0,s.CE)("div",{key:1,class:"g-loading",style:(0,r.Tr)({backgroundColor:l.backgroundColor})},[(0,s.Lk)("div",{class:(0,r.C4)(["progress-div",l.isLoadingGame?"":"hidden"])},[(0,s.bF)(h)],2),(0,s.RG)(t.$slots,"welcomescreen",{},void 0,!0)],4)):(0,s.Q3)("",!0),l.isColorWheelVisible?((0,s.uX)(),(0,s.Wv)(c,{key:2,modelValue:o.colorWheelColor,"onUpdate:modelValue":e[0]||(e[0]=t=>o.colorWheelColor=t),onClickCancel:l.hideColorWheelPopup,onClickApply:l.handleColorWheelChanged},null,8,["modelValue","onClickCancel","onClickApply"])):(0,s.Q3)("",!0),(0,s.bF)(u,{visible:l.onSaveScreen&&i.saveScreenAnimation,color:l.saveAnimationColor},null,8,["visible","color"]),l.onSaveScreen?((0,s.uX)(),(0,s.Wv)(d,{key:3,image:i.saveImage,showSaveButton:i.showSaveButton,mountDelayed:i.saveScreenAnimation,forceDownload:i.saveImageForceDownload,onClickCancel:l.exitSaveMode,onClickSave:l.handleSaveGameFile},null,8,["image","showSaveButton","mountDelayed","forceDownload","onClickCancel","onClickSave"])):(0,s.Q3)("",!0),(0,s.Lk)("div",{ref:"container",class:"g-content noselect",style:(0,r.Tr)({backgroundColor:l.canvasBackgroundColor})},[(0,s.RG)(t.$slots,"canvas",{},(()=>[f]),!0),(0,s.bF)(_,{class:"color-picker",ref:"colorPicker",visible:!l.onSaveScreen&&!i.hamburgerMenuVisible,colorWheel:i.colorWheel,colors:i.colors,onColor:l.handleColor,onColorVisible:l.handleColorVisible,onColorWheelClick:l.handleColorWheelClick,onOpen:e[1]||(e[1]=e=>t.$refs.gamePad.close())},null,8,["visible","colorWheel","colors","onColor","onColorVisible","onColorWheelClick"]),(0,s.bF)(b,{class:"game-pad",ref:"gamePad",visible:!l.onSaveScreen&&!i.hamburgerMenuVisible,buttons:i.buttons,onButtonclick:l.handleMove,onOpen:e[2]||(e[2]=e=>t.$refs.colorPicker.close())},null,8,["visible","buttons","onButtonclick"]),i.hamburgerMenuVisible?((0,s.uX)(),(0,s.Wv)(I,{key:1,class:(0,r.C4)(`hamburger-overlay ${l.hideSaveAndRandomButtons}`),onClosed:l.hideHamburgerMenu,transparent:!o.hamburgerMenuShowLabels,style:{"z-index":"auto"}},{default:(0,s.k6)((()=>[(0,s.bF)(y,{class:"hamburger-button",onClick:l.hideHamburgerMenu},null,8,["onClick"]),(0,s.Lk)("div",p,[(0,s.bF)(w,{"show-label":o.hamburgerMenuShowLabels,onClick:l.handleClickRandom,style:{margin:"8px 2px"}},null,8,["show-label","onClick"]),i.enableUndoButton?((0,s.uX)(),(0,s.Wv)(E,{key:0,"show-label":o.hamburgerMenuShowLabels,onClick:l.handleClickUndo,style:{margin:"8px 2px"}},null,8,["show-label","onClick"])):(0,s.Q3)("",!0),i.enableRedoButton?((0,s.uX)(),(0,s.Wv)(C,{key:1,"show-label":o.hamburgerMenuShowLabels,onClick:l.handleClickRedo,style:{margin:"8px 2px"}},null,8,["show-label","onClick"])):(0,s.Q3)("",!0),(0,s.bF)(T,{"show-label":o.hamburgerMenuShowLabels,onClick:l.handleClickReset,style:{margin:"8px 2px"}},null,8,["show-label","onClick"]),i.enableFullscreenButton?((0,s.uX)(),(0,s.Wv)(x,{key:2,"show-label":o.hamburgerMenuShowLabels,onClick:l.handleFullscreenToggle,style:{margin:"8px 2px"}},null,8,["show-label","onClick"])):(0,s.Q3)("",!0),(0,s.bF)(S,{onClick:e[3]||(e[3]=()=>{o.hamburgerMenuShowLabels=!o.hamburgerMenuShowLabels}),style:{margin:"8px 2px"}})])])),_:1},8,["class","onClosed","transparent"])):((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,r.C4)(`hamburger-items ${l.hideSaveAndRandomButtons}`)},[(0,s.bF)(y,{class:(0,r.C4)(["hamburger-button",l.hideSaveAndRandomButtons]),onClick:l.showHamburgerMenu},null,8,["class","onClick"])],2)),o.showDownloadButton?((0,s.uX)(),(0,s.Wv)(L,{key:2,class:(0,r.C4)(`enter-save-mode ${l.hideSaveAndRandomButtons}`),onClick:l.enterSaveMode},null,8,["class","onClick"])):(0,s.Q3)("",!0),l.onStampEditScreen?((0,s.uX)(),(0,s.CE)("div",{key:3,class:(0,r.C4)(`stamp-toolbar ${l.stampsButtonBlockClasses} ${l.canExpandItems?"expanded":""}`)},[(0,s.Lk)("div",m,[(0,s.bF)(O,{class:"btn-duplicate",onClick:l.duplicateCurrentStamp},null,8,["onClick"]),(0,s.bF)(A,{class:"btn-flip-h",onClick:l.flipCurrentStampHorizontally},null,8,["onClick"])]),(0,s.Lk)("div",g,[(0,s.bF)(k,{class:"btn-save",onClick:l.exitStampEditMode},null,8,["onClick"])])],2)):(0,s.Q3)("",!0),i.poweredByHref?((0,s.uX)(),(0,s.Wv)(R,{key:4,href:i.poweredByHref,by:"meiker.io",premiumHref:i.poweredByPremiumHref,premiumLabel:i.poweredByPremiumLabel,presentationMode:i.presentationMode},null,8,["href","premiumHref","premiumLabel","presentationMode"])):(0,s.Q3)("",!0),l.isLoadingGame?((0,s.uX)(),(0,s.Wv)(P,{key:5})):(0,s.Q3)("",!0)],4),(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(`g-items g-scroll-container noselect push-right-sm ${l.canExpandItems?"visible":""} ${l.onStampEditScreen?"g-no-events":""}`)},[l.onStampEditScreen?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("a",{key:0,class:"g-btn-back-overlay",onClick:e[4]||(e[4]=(0,n.D$)(((...t)=>l.handleClickClose&&l.handleClickClose(...t)),["stop","prevent"]))})),(0,s.Lk)("div",{class:"g-scroll",style:(0,r.Tr)({backgroundColor:l.itemsScrollBackgroundColor,backgroundImage:l.itemsScrollBackgroundGradient})},[(0,s.RG)(t.$slots,"items",{},(()=>[(0,s.bF)(D,{items:[1,2,3,4,5,6,7,8,9,10],"highlight-active-items":!0})]),!0)],4),(0,s.bF)(M,{class:"g-btn-back",onClick:(0,n.D$)(l.handleClickClose,["stop","prevent"])},null,8,["onClick"])],2)),[[B,!0]]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("div",{class:"g-scroll",style:(0,r.Tr)({backgroundColor:l.categoriesScrollBackgroundColor,backgroundImage:l.categoriesScrollBackgroundGradient})},[(0,s.RG)(t.$slots,"categories",{},(()=>[(0,s.bF)(D,{items:[1,2,3,4,5,6,7,8,9,10]})]),!0)],4)])),[[B,!0]])],6),(0,s.RG)(t.$slots,"splash-screen",{},void 0,!0),(0,s.bF)(j,{onNotify:l.handleResize},null,8,["onNotify"])],6)}const b=document.createElement("a");function y(t){if("string"!==typeof t)throw new Error("Invalid image src type");return b.href=t,""===b.hostname&&"file:"===b.protocol}const w=document.createElement("div"),E=/iPad/i.test(navigator.userAgent)||/Mac/.test(navigator.userAgent)&&navigator.maxTouchPoints>0,C=E||/iPhone|iPad|iPod/i.test(navigator.userAgent),T=Object.freeze({get isEnabled(){return Boolean(document[O.fullscreenEnabled])&&!E},get isFullScreen(){return Boolean(R.fullscreenElement||document[O.fullscreenElement])},enter(t){if(!(t instanceof HTMLDivElement))throw new TypeError("Invalid target div");this.isFullScreen||(x(t),w.dispatchEvent(new Event("fullscreenchange")))},exit(){this.isFullScreen&&(S(),w.dispatchEvent(new Event("fullscreenchange")))},addEventListener(t,e,i){return w.addEventListener(t,e,i)},removeEventListener(t,e,i){return w.removeEventListener(t,e,i)}});function x(t){return T.isEnabled?t.webkitRequestFullscreen?t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t[O.requestFullscreen]():R.requestFullscreen(t)}function S(){return T.isEnabled?document[O.exitFullscreen]():R.exitFullscreen()}var I=T;const L=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],O=(()=>{if("undefined"===typeof document)return!1;const t=L[0],e={};for(const i of L){const n=i?.[1];if(n in document){for(const[n,s]of i.entries())e[t[n]]=s;return e}}return!1})(),A="viewport-fit=cover,width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no",k="\n  #page-fscreen-overlay-div {\n    position: relative !important;\n    padding-right: 0;\n    padding-right: env(safe-area-inset-right);\n    padding-left: 0;\n    padding-left: env(safe-area-inset-left);\n    padding-top: 0;\n    padding-top: env(safe-area-inset-top);\n    padding-bottom: 0;\n    padding-bottom: env(safe-area-inset-bottom);\n    margin: 0 !important;\n    z-index: 2;\n    overflow: hidden;\n    flex-grow: 1;\n    display: block;\n  }\n  .page-fscreen-doc-el,\n  .page-fscreen-doc-el body {\n    margin: 0 !important;\n    padding: 0 !important;\n    box-sizing: border-box !important;\n    display: flex;\n    flex-direction: column;\n    overflow: auto !important;\n    width: 100vw !important;\n    height: 100% !important;\n    flex-grow: 1;\n    background: #fff !important;\n  }\n  .page-fscreen-doc-el, .page-fscreen-doc-el body {\n    -webkit-overflow-scrolling: auto !important;\n    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;\n    transform: scale(1) !important;\n    -ms-touch-action: manipulation !important;\n    touch-action: manipulation !important;\n    -ms-high-contrast-adjust: none !important;\n  }\n  .page-fscreen-doc-el body > *:not(#page-fscreen-overlay-div) {\n    z-index: -1;\n    display: none !important;\n  }\n";if(!T.isEnabled){const t=document.createElement("style");t.innerHTML=k,document.head.appendChild(t)}const R=Object.seal({viewportMetaTagContent:null,sourceDiv:null,overlayDiv:document.createElement("div"),fullscreenElement:null,requestFullscreen(t){if(!(t instanceof HTMLDivElement))throw new TypeError("Invalid target div");this.fullscreenElement&&this.exitFullscreen(),this.overlayDiv.id="page-fscreen-overlay-div",document.body.appendChild(this.overlayDiv),this.sourceDiv=t.parentElement,this.overlayDiv.appendChild(t),this.fullscreenElement=t,document.documentElement.classList.add("page-fscreen-doc-el");let e=document.querySelector('meta[name="viewport"]');e||(e=document.createElement("meta"),e.name="viewport",document.head.appendChild(e)),this.viewportMetaTagContent=e.content,e.content=A},exitFullscreen(){if(!this.fullscreenElement)return;this.sourceDiv.appendChild(this.fullscreenElement),this.sourceDiv=null,document.body.removeChild(this.overlayDiv),this.fullscreenElement=null,document.documentElement.classList.remove("page-fscreen-doc-el");const t=document.querySelector('meta[name="viewport"]');t.content=this.viewportMetaTagContent}});var P=i(9621);function D(t,e,i,a,o,l){const h=(0,s.g2)("ScrollableItem"),c=(0,s.g2)("Scrollable");return Array.isArray(i.items)?((0,s.uX)(),(0,s.Wv)(c,{key:0,ref:"scrollable",horizontal:i.horizontal},{default:(0,s.k6)((()=>[(0,s.Lk)("template",null,[(0,s.Lk)("div",{class:(0,r.C4)(`scrollable-item empty-item first ${l.orientation}`)},null,2)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.items,((e,a)=>((0,s.uX)(),(0,s.Wv)(h,{key:`${o.itemId}-${a}`,onClick:(0,n.D$)((t=>l.handleClick(e,a)),["stop","prevent"]),selected:a===o.selectedIndex,highlightActiveItems:i.highlightActiveItems,visible:!e.hideIcon,item:e},{default:(0,s.k6)((()=>[(0,s.RG)(t.$slots,"default",(0,r._B)((0,s.Ng)(e)),(()=>[(0,s.Lk)("span",null,(0,r.v_)(e),1)]))])),_:2},1032,["onClick","selected","highlightActiveItems","visible","item"])))),128)),(0,s.Lk)("template",null,[(0,s.Lk)("div",{class:(0,r.C4)(`scrollable-item empty-item latest ${l.orientation}`)},null,2)])])),_:3},8,["horizontal"])):(0,s.Q3)("",!0)}const M={class:"scrollable"},j={class:"scrollable-content"};function B(t,e,i,n,r,a){const o=(0,s.g2)("vuescroll");return(0,s.uX)(),(0,s.CE)("div",M,[(0,s.bF)(o,{ref:"scroll",ops:r.ops,onHandleScroll:a.handleScroll,onHandleScrollComplete:a.handleScrollComplete},{default:(0,s.k6)((()=>[(0,s.Lk)("div",j,[(0,s.RG)(t.$slots,"default")])])),_:3},8,["ops","onHandleScroll","onHandleScrollComplete"])])}var F=i(8920);const U=(t,e)=>{const i="onwheel"in window.document||window.document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];i.forEach((i=>t.addEventListener(i,e)))};var N=()=>({bind:function(t,e,i){U(t,(t=>{t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()}))}}),X={name:"Scrollable",components:{vuescroll:F.A},data(){return{scrolling:!1,ops:{vuescroll:{mode:"slide",detectResize:!0,sizeStrategy:"percent",paging:!1,zooming:!1,locking:!0,scroller:{bouncing:{top:100,bottom:100,left:100,right:100},penetrationDeceleration:.8,penetrationAcceleration:.8}},scrollPanel:{initialScrollY:!1,initialScrollX:!1,scrollingX:this.horizontal,scrollingY:!this.horizontal,speed:100,easing:void 0},bar:{disable:!1,showDelay:100,keepShow:!0,background:"#c1c1c1",opacity:.5,hoverStyle:!1,specifyBorderRadius:!1,minSize:0,size:"5px"}}}},watch:{horizontal:function(t){this.ops.scrollPanel.scrollingX=t,this.ops.scrollPanel.scrollingY=!t}},props:{horizontal:{type:Boolean,default:!1}},mounted(){U(this.$el,(t=>{t.preventDefault(),this.handleMouseWhell(t)})),this.$nextTick((()=>{this.scrolling=!1}))},methods:{handleMouseWhell(t){const e=Math.abs(Math.round(t.deltaY)),i=Math.round(t.deltaY)/e;this.$refs.scroll.scrollBy({dy:(e>20?e:20)*i}),this.scrolling=!1,this.$emit("scroll",this.scrolling)},handleScrollUp(){this.$refs.scroll.scrollBy({dy:"-200"},200,"easeOutCubic")},handleScrollDown(){this.$refs.scroll.scrollBy({dy:"200"},200,"easeOutCubic")},handleScroll(){this.scrolling||(this.scrolling=!0)},handleScrollComplete(){this.$nextTick((()=>{this.scrolling=!1}))}}},H=i(9890);const V=(0,H.A)(X,[["render",B]]);var G=V;function Y(t,e,i,n,a,o){return o.visible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,r.C4)(["scrollable-item","noselect",i.highlightActiveItems&&i.item.visible?"active":"",i.selected?"selected":""])},[(0,s.RG)(t.$slots,"default",(0,r._B)((0,s.Ng)(i.item)))],2)):(0,s.Q3)("",!0)}var z={name:"ScrollableItem",computed:{active(){return this.item&&this.item.visible},visible(){return!(this.item&&this.item.hideIcon)}},props:{highlightActiveItems:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},item:{validate(t){return t&&("object"===typeof t||"string"===typeof t)}}}};const W=(0,H.A)(z,[["render",Y]]);var $=W,q={name:"ScrollableList",components:{ScrollableItem:$,Scrollable:G},data(){return{itemId:Math.random().toString(36).substring(2,6),scrolling:!1,selectedIndex:-1}},computed:{orientation(){return this.horizontal?"horizontal":"vertical"}},watch:{items:function(){this.selectedIndex=-1}},props:{horizontal:{type:Boolean,default:!1},items:{type:Array,default:null},highlightActiveItems:{type:Boolean,default:!1}},methods:{isScrolling(){return this.$refs.scrollable.scrolling},handleClick(t,e){this.isScrolling()||(this.selectedIndex=e,this.$emit("select",t,e))}}};const Q=(0,H.A)(q,[["render",D]]);var J=Q;const K=t=>((0,s.Qi)("data-v-782048f6"),t=t(),(0,s.jt)(),t),Z=K((()=>(0,s.Lk)("span",{class:"color overlay--a",style:{background:"#f9f9f9"}},null,-1)));function tt(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(o.classes)},[Z,(0,s.Lk)("span",{class:"color overlay--b",style:(0,r.Tr)({background:o.colorB})},null,4),(0,s.Lk)("span",{class:"color overlay--c",style:(0,r.Tr)({background:o.colorC})},null,4),(0,s.Lk)("span",{class:"color overlay--d",style:(0,r.Tr)({background:o.colorD})},null,4)],2)}var et={name:"OverlayAnimation",data(){return{hidden:!1,mouseThrough:!1}},watch:{visible:function(t){this.hidden=!t,this.mouseThrough=!t,t&&(setTimeout((()=>{this.mouseThrough=!0}),1500),setTimeout((()=>{this.hidden=!0}),2500))}},computed:{classes(){return["overlay",this.visible?"expanded":"",this.hidden?"hide":"",this.mouseThrough?"pointer-none":""]},colorB(){return this.colorToRGBA(.33)},colorC(){return this.colorToRGBA(.66)},colorD(){return this.colorToRGBA(1)}},props:{visible:{type:Boolean,default:!1},color:{type:String,default:"#f69bc5"}},methods:{colorToRGBA(t=1){let e=this.color.replace(/^#/,"");3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const i=parseInt(e,16),n=[i>>16,i>>8&255,255&i,t];return`rgba(${n.join(",")})`}}};const it=(0,H.A)(et,[["render",tt],["__scopeId","data-v-782048f6"]]);var nt=it;const st=t=>((0,s.Qi)("data-v-31a3e66f"),t=t(),(0,s.jt)(),t),rt=st((()=>(0,s.Lk)("g",null,[(0,s.Lk)("path",{d:"M87.748,388.784c0.461,11.01,9.521,19.699,20.539,19.699h191.911c11.018,0,20.078-8.689,20.539-19.699l13.705-289.316\n          H74.043L87.748,388.784z M247.655,171.329c0-4.61,3.738-8.349,8.35-8.349h13.355c4.609,0,8.35,3.738,8.35,8.349v165.293\n          c0,4.611-3.738,8.349-8.35,8.349h-13.355c-4.61,0-8.35-3.736-8.35-8.349V171.329z M189.216,171.329\n          c0-4.61,3.738-8.349,8.349-8.349h13.355c4.609,0,8.349,3.738,8.349,8.349v165.293c0,4.611-3.737,8.349-8.349,8.349h-13.355\n          c-4.61,0-8.349-3.736-8.349-8.349V171.329L189.216,171.329z M130.775,171.329c0-4.61,3.738-8.349,8.349-8.349h13.356\n          c4.61,0,8.349,3.738,8.349,8.349v165.293c0,4.611-3.738,8.349-8.349,8.349h-13.356c-4.61,0-8.349-3.736-8.349-8.349V171.329z"}),(0,s.Lk)("path",{d:"M343.567,21.043h-88.535V4.305c0-2.377-1.927-4.305-4.305-4.305h-92.971c-2.377,0-4.304,1.928-4.304,4.305v16.737H64.916\n          c-7.125,0-12.9,5.776-12.9,12.901V74.47h304.451V33.944C356.467,26.819,350.692,21.043,343.567,21.043z"})],-1))),at=[rt];function ot(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow stamp-remove-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 408.483 408.483",xmlns:"http://www.w3.org/2000/svg"},at,4))],4)}var lt=i(6250),ht=i.n(lt);const ct={isDark(t){const e=ht().get.rgb(t),i=(299*e[0]+587*e[1]+114*e[2])/1e3;return i<128},isLight(t){return!this.isDark()},getAlphaChannel(t){const e=ht().get.rgb(t);return 1*e[3]}};var ut=ct,dt={name:"StampRemoveButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnRemoveItems||"#f69bc5"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const ft=(0,H.A)(dt,[["render",ot],["__scopeId","data-v-31a3e66f"]]);var pt=ft;const mt=t=>((0,s.Qi)("data-v-7cc4979e"),t=t(),(0,s.jt)(),t),gt={fill:"none","fill-rule":"evenodd",id:"Page-1",stroke:"none","stroke-width":"1"},vt={fill:"none","fill-rule":"evenodd",id:"Page-1",stroke:"none","stroke-width":"1"},_t=["fill"],bt=mt((()=>(0,s.Lk)("g",{id:"content-copy",transform:"translate(86.500000, 127.000000)"},[(0,s.Lk)("path",{d:"M14,0 L2,0 C0.9,0 0,0.9 0,2 L0,16 L2,16 L2,2 L14,2 L14,0 L14,0 Z M17,4 L6,4 C4.9,4 4,4.9 4,6 L4,20 C4,21.1 4.9,22 6,22 L17,22 C18.1,22 19,21.1 19,20 L19,6 C19,4.9 18.1,4 17,4 L17,4 Z M17,20 L6,20 L6,6 L17,6 L17,20 L17,20 Z",id:"Shape"})],-1))),yt=[bt];function wt(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow stamp-duplicate-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 21 22",xmlns:"http://www.w3.org/2000/svg"},[(0,s.Lk)("g",gt,[(0,s.Lk)("g",vt,[(0,s.Lk)("g",{fill:o.color,id:"Core",transform:"translate(-86.000000, -127.000000)"},yt,8,_t)])])],4))],4)}var Et={name:"StampDuplicateButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnStampButtons||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const Ct=(0,H.A)(Et,[["render",wt],["__scopeId","data-v-7cc4979e"]]);var Tt=Ct;const xt=["stroke"];function St(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow stamp-flip-horizontal",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 36.8 21.65",xmlns:"http://www.w3.org/2000/svg"},[(0,s.Lk)("path",{id:"Layer0_0_1_STROKES",stroke:o.color,class:"cls-1",style:{fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4px"},d:"M27.65,8.7l8.75,8.75-8.9,8.9M12.45,8.7,3.6,17.55l32.8-.1m-24,8.9-8.8-8.8",transform:"translate(-1.6 -6.7)"},null,8,xt)],4))],4)}var It={name:"StampFlipHorizontalButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnStampButtons||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const Lt=(0,H.A)(It,[["render",St],["__scopeId","data-v-01fd555c"]]);var Ot=Lt;const At=["href"],kt={class:"show-more"},Rt={key:0,class:"premium-label"},Pt=["href"],Dt=["href"];function Mt(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",{class:"btn-default powered-by",onMouseleave:e[1]||(e[1]=t=>a.opened=!1)},[(0,s.Lk)("a",{target:"_blank",href:o.computedHref},[(0,s.Lk)("i",{class:"svg-icon svg-logo",onMouseover:e[0]||(e[0]=t=>a.opened=!0)},null,32)],8,At),(0,s.Lk)("div",kt,[i.premiumLabel?((0,s.uX)(),(0,s.CE)("span",Rt,[(0,s.Lk)("a",{target:"_blank",rel:"noopener",href:o.computedPremiumHref},(0,r.v_)(i.premiumLabel),9,Pt)])):(0,s.Q3)("",!0),(0,s.Lk)("span",{class:(0,r.C4)(["info",a.opened&&"active"])},[(0,s.eW)(" powered by "),(0,s.Lk)("a",{target:"_blank",href:o.computedHref},(0,r.v_)(i.by),9,Dt)],2)])],32)}var jt={name:"PoweredBy",data(){return{opened:!1}},computed:{classes(){return["color-picker",this.opened&&this.visible?"opened":"",0!==this.colors.length&&this.visible?"":"hidden"]},computedHref(){return this.presentationMode?"javascript:;":this.href},computedPremiumHref(){return this.presentationMode?"javascript:;":this.premiumHref}},props:{href:{type:String,default:"#"},by:{type:String,default:"meiker.io"},premiumHref:{type:String,default:"#"},premiumLabel:{type:String},presentationMode:{type:Boolean,required:!0}}};const Bt=(0,H.A)(jt,[["render",Mt],["__scopeId","data-v-f21226a0"]]);var Ft=Bt;const Ut={class:"loading-anim"};function Nt(t,e,i,n,r,a){const o=(0,s.g2)("LoadingEllipsis");return(0,s.uX)(),(0,s.CE)("div",Ut,[(0,s.bF)(o)])}const Xt=t=>((0,s.Qi)("data-v-0eb460ce"),t=t(),(0,s.jt)(),t),Ht={class:"loading-ellipsis"},Vt=Xt((()=>(0,s.Lk)("div",null,null,-1))),Gt=Xt((()=>(0,s.Lk)("div",null,null,-1))),Yt=Xt((()=>(0,s.Lk)("div",null,null,-1))),zt=Xt((()=>(0,s.Lk)("div",null,null,-1))),Wt=[Vt,Gt,Yt,zt];function $t(t,e,i,n,r,a){return(0,s.uX)(),(0,s.CE)("div",Ht,Wt)}var qt={name:"LoadingEllipsis"};const Qt=(0,H.A)(qt,[["render",$t],["__scopeId","data-v-0eb460ce"]]);var Jt=Qt,Kt={name:"LoadingOverlay",components:{LoadingEllipsis:Jt},props:{label:{type:String,default:""}}};const Zt=(0,H.A)(Kt,[["render",Nt],["__scopeId","data-v-51cdf861"]]);var te=Zt;const ee=["src"];function ie(t,e,i,a,o,l){const h=(0,s.g2)("SaveImageButton"),c=(0,s.g2)("SaveCancelButton"),u=(0,s.g2)("SaveGameOnlineButton");return(0,s.uX)(),(0,s.CE)("div",{class:"g-save-screen",style:(0,r.Tr)({backgroundColor:l.backgroundColor,display:o.display})},[(0,s.Lk)("img",{class:"float-image",src:i.image&&i.image.link},null,8,ee),(0,s.bF)(h,{class:"btn-save",image:i.image,target:l.saveImageTarget,forceDownload:i.forceDownload},null,8,["image","target","forceDownload"]),(0,s.bF)(c,{class:"btn-save-cancel",onClick:e[0]||(e[0]=e=>t.$emit("click-cancel"))}),i.showSaveButton?((0,s.uX)(),(0,s.Wv)(u,{key:0,class:"btn-save-online",onClick:e[1]||(e[1]=(0,n.D$)((e=>t.$emit("click-save")),["stop","prevent"]))})):(0,s.Q3)("",!0)],4)}const ne=t=>((0,s.Qi)("data-v-65ddc0ac"),t=t(),(0,s.jt)(),t),se=["target","href","download"],re=ne((()=>(0,s.Lk)("path",{d:"M14,6 L10,6 L10,0 L4,0 L4,6 L0,6 L7,13 L14,6 L14,6 Z M0,15 L0,17 L14,17 L14,15 L0,15 L0,15 Z"},null,-1))),ae=[re],oe=ne((()=>(0,s.Lk)("span",null,"Download",-1)));function le(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("a",{class:"btn-default btn-shadow image-save-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color}),target:i.target,href:i.image?i.image.link:"",download:i.forceDownload&&i.image?i.image.name:void 0},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 14 19",xmlns:"http://www.w3.org/2000/svg"},ae,4)),oe],12,se)}var he={name:"SaveImageButton",props:{forceDownload:{type:Boolean,default:!0},target:{type:String,default:null},image:{type:Object,default(){return{link:"",name:""}}}},inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnSaveImage||"#f69bc5"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const ce=(0,H.A)(he,[["render",le],["__scopeId","data-v-65ddc0ac"]]);var ue=ce;const de=t=>((0,s.Qi)("data-v-edd3e6c6"),t=t(),(0,s.jt)(),t),fe=de((()=>(0,s.Lk)("path",{d:"M14.757,46.02c-1.412,0-2.825-0.521-3.929-1.569c-2.282-2.17-2.373-5.78-0.204-8.063l12.758-13.418L10.637,9.645\n        C8.46,7.37,8.54,3.76,10.816,1.582c2.277-2.178,5.886-2.097,8.063,0.179l16.505,17.253c2.104,2.2,2.108,5.665,0.013,7.872\n        L18.893,44.247C17.77,45.424,16.267,46.02,14.757,46.02z"},null,-1))),pe=[fe],me=de((()=>(0,s.Lk)("span",null,"Back",-1)));function ge(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow cancel-save-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 46.02 46.02",xmlns:"http://www.w3.org/2000/svg"},pe,4)),me],4)}var ve={name:"SaveCancelButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnCancelSave||"#b0a9f9"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const _e=(0,H.A)(ve,[["render",ge],["__scopeId","data-v-edd3e6c6"]]);var be=_e;const ye=t=>((0,s.Qi)("data-v-36ab43ea"),t=t(),(0,s.jt)(),t),we=ye((()=>(0,s.Lk)("path",{d:"M19.4,6 C18.7,2.6 15.7,0 12,0 C9.1,0 6.6,1.6 5.4,4 C2.3,4.4 0,6.9 0,10 C0,13.3 2.7,16 6,16 L19,16 C21.8,16 24,13.8 24,11 C24,8.4 21.9,6.2 19.4,6 L19.4,6 Z M10,13 L6.5,9.5 L7.9,8.1 L10,10.2 L15.2,5 L16.6,6.4 L10,13 L10,13 Z"},null,-1))),Ee=[we],Ce=ye((()=>(0,s.Lk)("span",null,"Save Online",-1)));function Te(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow save-game-online-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 24 16",xmlns:"http://www.w3.org/2000/svg"},Ee,4)),Ce],4)}var xe={name:"SaveGameOnlineButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnSaveImage||"#f69bc5"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const Se=(0,H.A)(xe,[["render",Te],["__scopeId","data-v-36ab43ea"]]);var Ie=Se,Le={name:"SaveGameOverlay",data(){return{display:"flex"}},mounted(){this.mountDelayed&&(this.display="none",setTimeout((()=>this.$nextTick((()=>{this.display="flex"}))),1e3))},components:{SaveImageButton:ue,SaveCancelButton:be,SaveGameOnlineButton:Ie},inject:["theme"],computed:{saveImageTarget(){return this.isInAppBrowsing()?"_self":"_blank"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.canvasBg||"#000000"}},props:{image:{type:Object,default(){return{link:"",name:""}}},showSaveButton:{type:Boolean,default:!1},mountDelayed:{type:Boolean,default:!1},forceDownload:{type:Boolean,default:!0}},methods:{isInAppBrowsing(){try{const t=navigator.userAgent||navigator.vendor||window.opera;return t.indexOf("FBAN")>-1||t.indexOf("FBAV")>-1||t.indexOf("Instagram")>-1}catch(t){return!1}}}};const Oe=(0,H.A)(Le,[["render",ie],["__scopeId","data-v-85dfb334"]]);var Ae=Oe;const ke={key:1,class:"buttons",style:{marginTop:"13px",height:"40px",marginBottom:"-2px"}};function Re(t,e,i,n,a,o){const l=(0,s.g2)("ColorPickerButton"),h=(0,s.g2)("ColorVisibilityToggle"),c=(0,s.g2)("Tooltip"),u=(0,s.g2)("ColorWheelButton"),d=(0,s.g2)("ColorRoundedButton"),f=(0,s.g2)("ScrollableList");return(0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(o.classes)},[o.hasColorsButtons?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"buttons",style:(0,r.Tr)({marginBottom:(o.visibleColorButtons.length-1)*a.distance+"px"}),onClick:e[0]||(e[0]=(...t)=>o.moveNextButton&&o.moveNextButton(...t))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.visibleColorButtons,((t,e)=>((0,s.uX)(),(0,s.Wv)(l,{key:`color-btn-${e}`,class:"color-items",label:t.label,selectedColor:t.activeColor,style:(0,r.Tr)({top:e*a.distance+"px",zIndex:t.zIndex}),disabled:t!==o.activeColorButton},null,8,["label","selectedColor","style","disabled"])))),128))],4)):(0,s.Q3)("",!0),o.hasRemovableButton?((0,s.uX)(),(0,s.CE)("div",ke,[(0,s.bF)(h,{isVisible:o.isVisible,isShaking:a.isShaking,onClick:o.handleRemoveActiveButtonClick},null,8,["isVisible","isShaking","onClick"])])):(0,s.Q3)("",!0),o.hasColorsButtons&&!o.isUiHidden?((0,s.uX)(),(0,s.CE)("div",{key:2,class:(0,r.C4)(["selector",o.isVisible?"":"disabled"])},[o.isColorWheelLocked&&o.selectedAvailableColors.includes("color-wheel")?((0,s.uX)(),(0,s.Wv)(c,{key:0,modelValue:a.showTooltip,"onUpdate:modelValue":e[1]||(e[1]=t=>a.showTooltip=t),style:{width:"250px"}},{default:(0,s.k6)((()=>[(0,s.eW)(" Unlock the Grande Palette with Premium. ")])),_:1},8,["modelValue"])):(0,s.Q3)("",!0),(0,s.bF)(f,{items:o.selectedAvailableColors,onSelect:o.handleColor},{default:(0,s.k6)((t=>["color-wheel"===t?((0,s.uX)(),(0,s.Wv)(u,{key:0,color:o.selectedActiveColor,active:!o.selectedAvailableColors.includes(o.selectedActiveColor),locked:o.isColorWheelLocked,onClick:o.handleColorWheelClick},null,8,["color","active","locked","onClick"])):((0,s.uX)(),(0,s.Wv)(d,{key:1,color:t,active:t===o.selectedActiveColor},null,8,["color","active"]))])),_:1},8,["items","onSelect"])],2)):(0,s.Q3)("",!0)],2)}const Pe=t=>((0,s.Qi)("data-v-9816aba6"),t=t(),(0,s.jt)(),t),De=["fill"],Me=["fill"],je=Pe((()=>(0,s.Lk)("path",{d:"M3,1V12.23a5,5,0,0,0,3.24,4.68l4.81,1.8.72,8.62a4,4,0,0,0,4,3.67h.48a4,4,0,0,0,4-3.67l.72-8.62,4.81-1.8A5,5,0,0,0,29,12.23V1ZM27,3v8H5V3ZM25.05,15l-5.9,2.25-.92,10.08a2,2,0,0,1-2,1.83h-.48a2,2,0,0,1-2-1.83l-.92-10.08L6.95,15a3,3,0,0,1-1.84-2H26.89A3,3,0,0,1,25.05,15Z"},null,-1)));function Be(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:(0,r.C4)("btn-default btn-shadow color-picker-button "+(i.disabled?"disabled":"")),style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 33 33",xmlns:"http://www.w3.org/2000/svg"},[i.selectedColor?((0,s.uX)(),(0,s.CE)("path",{key:0,fill:i.selectedColor,class:"a",d:"m28 2v10h-24v-10z"},null,8,De)):(0,s.Q3)("",!0),i.label?((0,s.uX)(),(0,s.CE)("text",{key:1,x:"0",y:"32",fill:o.color,"font-size":"18"},(0,r.v_)(i.label),9,Me)):(0,s.Q3)("",!0),je],4))],6)}var Fe={name:"ColorPickerButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnColorPicker||"#ffffff"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{label:{type:String,default:""},selectedColor:{type:String,default:""},disabled:{type:Boolean,default:!1}}};const Ue=(0,H.A)(Fe,[["render",Be],["__scopeId","data-v-9816aba6"]]);var Ne=Ue;const Xe={key:0,class:"color-rounded-has-alpha has-alpha center-absolute no-events no-filter"},He={key:1,class:"color-rounded-active center-absolute no-events no-filter"};function Ve(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)(s.FK,null,[o.hasAlphaChannel?((0,s.uX)(),(0,s.CE)("span",Xe)):(0,s.Q3)("",!0),(0,s.Lk)("span",{class:"color-rounded-button center-absolute btn-shadow no-filter",style:(0,r.Tr)({"background-color":i.color}),onClick:e[0]||(e[0]=e=>t.$emit("click"))},null,4),this.active?((0,s.uX)(),(0,s.CE)("i",He)):(0,s.Q3)("",!0)],64)}const Ge={name:"ColorRoundedButton",computed:{hasAlphaChannel(){return this.color&&ut.getAlphaChannel(this.color)<1},outlineColor(){return ut.isDark(this.color||"#000")?"#f2f3f466":"#31393C66"}},props:{color:{type:String,default:"#ffffff"},active:{type:Boolean,default:!1}}},Ye=()=>{(0,n.$9)((t=>({"4761b782":t.outlineColor})))},ze=Ge.setup;Ge.setup=ze?(t,e)=>(Ye(),ze(t,e)):Ye;var We=Ge;const $e=(0,H.A)(We,[["render",Ve],["__scopeId","data-v-1d9c0fa6"]]);var qe=$e;const Qe=t=>((0,s.Qi)("data-v-3b260164"),t=t(),(0,s.jt)(),t),Je={key:0,class:"color-wheel-active center-absolute no-events no-filter"},Ke={key:1,class:"color-wheel-locked center-absolute no-events no-filter",version:"1.2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 192 192"},Ze=Qe((()=>(0,s.Lk)("path",{fill:"none",stroke:"#fff","stroke-width":"20",d:"m94.1 128.7v-14.4q0-27.6-23.9-27h-25.2q-23.9-0.6-23.9 27v14.4q-2.5 1.4-4.7 3.6-5.8 5.9-5.8 14.2v14.1q0 8.3 5.8 14.1 5.8 5.9 14.2 5.9h54.1q8.3 0 14.1-5.9 5.9-5.8 5.9-14.1v-14.1q0-8.3-5.9-14.2-2.2-2.2-4.7-3.6zm-14-14.4v12.2h-45v-12.2q0.1-12.5 9.9-13h25.2q9.8 0.5 9.9 13z"},null,-1))),ti=Qe((()=>(0,s.Lk)("path",{fill:"#c7bbbe",d:"m94.1 128.7v-14.4q0-27.6-23.9-27h-25.2q-23.9-0.6-23.9 27v14.4q-2.5 1.4-4.7 3.6-5.8 5.9-5.8 14.2v14.1q0 8.3 5.8 14.1 5.8 5.9 14.2 5.9h54.1q8.3 0 14.1-5.9 5.9-5.8 5.9-14.1v-14.1q0-8.3-5.9-14.2-2.2-2.2-4.7-3.6zm-14-14.4v12.2h-45v-12.2q0.1-12.5 9.9-13h25.2q9.8 0.5 9.9 13z"},null,-1))),ei=[Ze,ti];function ii(t,e,i,n,r,a){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("span",{class:"color-wheel-button center-absolute btn-shadow no-filter color-wheel-bg",onClick:e[0]||(e[0]=e=>t.$emit("click",this.$el))}),this.active?((0,s.uX)(),(0,s.CE)("i",Je)):(0,s.Q3)("",!0),this.locked?((0,s.uX)(),(0,s.CE)("svg",Ke,ei)):(0,s.Q3)("",!0)],64)}const ni={name:"ColorWheelButton",computed:{hasAlphaChannel(){return this.color&&ut.getAlphaChannel(this.color)<1},outlineColor(){return"#31393C66"}},props:{color:{type:String,default:"#ffffff"},active:{type:Boolean,default:!1},locked:{type:Boolean,default:!0}}},si=()=>{(0,n.$9)((t=>({"1ab0ee49":t.outlineColor})))},ri=ni.setup;ni.setup=ri?(t,e)=>(si(),ri(t,e)):si;var ai=ni;const oi=(0,H.A)(ai,[["render",ii],["__scopeId","data-v-3b260164"]]);var li=oi;const hi=t=>((0,s.Qi)("data-v-ac3d1abc"),t=t(),(0,s.jt)(),t),ci=hi((()=>(0,s.Lk)("ellipse",{cx:"12",cy:"12",rx:"8",ry:"6",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1))),ui=hi((()=>(0,s.Lk)("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"},null,-1))),di=hi((()=>(0,s.Lk)("circle",{cx:"10",cy:"10",r:"1.5",fill:"white"},null,-1))),fi=[ci,ui,di],pi=hi((()=>(0,s.Lk)("ellipse",{cx:"12",cy:"12",rx:"8",ry:"6",stroke:"currentColor","stroke-width":"2",fill:"none"},null,-1))),mi=hi((()=>(0,s.Lk)("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"},null,-1))),gi=hi((()=>(0,s.Lk)("circle",{cx:"10",cy:"10",r:"1.5",fill:"white"},null,-1))),vi=hi((()=>(0,s.Lk)("line",{x1:"4",y1:"4",x2:"20",y2:"20",stroke:"currentColor","stroke-width":"2"},null,-1))),_i=[pi,mi,gi,vi];function bi(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("span",{class:(0,r.C4)("color-visibility-button center-absolute btn-shadow no-filter "+(i.isShaking?"animate-shake":"")),style:(0,r.Tr)({backgroundColor:o.backgroundColor})},[this.isVisible?((0,s.uX)(),(0,s.CE)("svg",{key:0,class:"color-visibility-button center-absolute no-events no-filter",style:(0,r.Tr)({color:o.color}),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},fi,4)):((0,s.uX)(),(0,s.CE)("svg",{key:1,class:"color-visibility-button center-absolute no-events no-filter",style:(0,r.Tr)({color:o.color}),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_i,4))],6)}var yi={name:"ColorVisibilityToggle",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnVisibilityToggle||"#ffffff"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{isVisible:{type:Boolean,default:!1},isShaking:{type:Boolean,default:!1}}};const wi=(0,H.A)(yi,[["render",bi],["__scopeId","data-v-ac3d1abc"]]);var Ei=wi;function Ci(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("span",{class:(0,r.C4)(o.classes)},[(0,s.RG)(t.$slots,"default",{},void 0,!0)],2)}var Ti={props:{modelValue:{type:Boolean,default:!1,required:!0}},emits:["update:modelValue"],computed:{classes(){return["tooltip-text",this.modelValue?"is-visible":""]}},mounted(){window.addEventListener("click",this.handleClickOutside)},beforeDestroy(){window.removeEventListener("click",this.handleClickOutside)},methods:{handleClickOutside(t){this.modelValue&&this.$emit("update:modelValue",!1)}}};const xi=(0,H.A)(Ti,[["render",Ci],["__scopeId","data-v-7bd29556"]]);var Si=xi;const Ii=["id","acp-palette"];function Li(t,e,i,n,r,a){return(0,s.uX)(),(0,s.CE)("div",{class:"color-wheel",id:r.pickerId,"acp-color":"#ffffff","acp-show-rgb":"no","acp-show-hsl":"no","acp-show-hex":"yes","acp-show-alpha":"no","acp-palette":a.acpPalette},null,8,Ii)}const Oi=()=>"undefined"!==typeof window.AColorPicker;var Ai={name:"ColorWheel",data(){return{pickerId:`picker-${Math.random().toString(36).substring(3,9)}`}},mounted(){if(!Oi())return;const t=window.AColorPicker.from(`#${this.pickerId}`);t[0].color=this.modelValue||"#ffffff",t.on("change",((t,e)=>{this.$emit("update:modelValue",t.color)}))},computed:{acpPalette(){return this.swatches&&this.swatches.join("|")||"no"}},props:{modelValue:{default:"#ffffff",required:!0},swatches:{type:Array,default:()=>[]}},emits:["update:modelValue"]};const ki=(0,H.A)(Ai,[["render",Li]]);var Ri=ki,Pi={name:"ScrollableColorList",components:{ScrollableList:J,ColorPickerButton:Ne,ColorRoundedButton:qe,ColorWheelButton:li,ColorVisibilityToggle:Ei,Tooltip:Si},data(){return{isShaking:!1,maxVisibleItems:3,distance:20,opened:!0,colorsButtons:[],activeColorIndex:0,showTooltip:!1}},computed:{classes(){return["scrollable-color-list",this.opened&&this.visible?"opened":"",this.hasColorsButtons&&this.visible?"":"hidden"]},hasColorsButtons(){return this.colorsButtons.length>0},hasRemovableButton(){return this.activeColorButton&&this.activeColorButton.isRemovable},isUiHidden(){return this.activeColorButton&&this.activeColorButton.isHidden},isVisible(){return this.activeColorButton&&this.activeColorButton.isVisible},activeColorButton(){return 0===this.colorsButtons.length?null:this.colorsButtons[this.activeColorIndex]},selectedActiveColor(){if(this.activeColorButton)return this.activeColorButton.activeColor},selectedAvailableColors(){return this.activeColorButton?this.colorWheel&&this.activeColorButton.availableColors.length>0?["color-wheel",...this.activeColorButton.availableColors]:this.activeColorButton.availableColors:[]},visibleColorButtons(){const t=this.maxVisibleItems;let e=this.activeColorIndex-(t-1)+1,i=this.activeColorIndex+2;return this.activeColorIndex===this.colorsButtons.length-1&&(e--,i--),this.activeColorIndex<t-1&&(e=0,i=t),this.colorsButtons.slice(e,i)},isColorWheelLocked(){return!Oi()}},props:{visible:{type:Boolean,default:!0},size:{type:String,default:"40px"},colors:{type:Array,required:!0,default:()=>[]},colorWheel:{type:Boolean,default:!1}},watch:{colors:function(t){const e=t.length>1;this.colorsButtons=t.map((({activeColor:i,availableColors:n,isVisible:s,isRemovable:r,isHidden:a},o)=>({index:o,get base(){return t[o]},availableColors:n,activeColor:i,isVisible:s,isRemovable:r,isHidden:a,label:e?(t.length-o).toString():"",zIndex:0}))).reverse(),this.setActiveButtonIndex(0)}},methods:{checkIfIsOpened(){this.opened||(this.opened=!0,this.$emit("open"))},setActiveButtonIndex(t){this.updateVisibilityProps(),this.activeColorIndex=t,this.colorsButtons.forEach(((t,e)=>{t.zIndex=2*(this.colorsButtons.length-Math.abs(e-this.activeColorIndex))}))},moveNextButton(){this.checkIfIsOpened(),!this.colorsButtons.length>1||(this.activeColorIndex++,this.activeColorIndex>=this.colorsButtons.length&&(this.activeColorIndex=0),this.setActiveButtonIndex(this.activeColorIndex))},close(){this.opened=!1},updateVisibilityProps(){if(this.activeColorButton&&this.activeColorButton.isVisible!==this.activeColorButton.base.isVisible){const t=this.activeColorButton.base.isVisible;this.activeColorButton.isVisible=t,this.$emit("color-visible",t,this.activeColorButton.index)}},handleColor(t){this.updateVisibilityProps(),this.checkIfIsOpened(),this.hasColorsButtons&&"color-wheel"!==t&&(this.activeColorButton&&!this.activeColorButton.isVisible&&(this.handleRemoveActiveButtonClick(),this.shakeToggleButtonIfInvisible()),this.activeColorButton.activeColor=t,this.$emit("color",t,this.activeColorButton.index),this.showTooltip=!1)},handleColorWheelClick(t){if(this.updateVisibilityProps(),this.checkIfIsOpened(),this.hasColorsButtons){if(this.activeColorButton&&!this.activeColorButton.isVisible&&(this.handleRemoveActiveButtonClick(),this.shakeToggleButtonIfInvisible()),!this.isColorWheelLocked){const e=this.activeColorButton.activeColor;this.activeColorButton.activeColor="",this.$emit("color-wheel-click",t,e,this.activeColorButton.index)}this.showTooltip=!this.showTooltip}},handleRemoveActiveButtonClick(){if(this.checkIfIsOpened(),!this.activeColorButton)return;const t=!this.activeColorButton.base.isVisible;this.activeColorButton.isVisible=t,this.$emit("color-visible",t,this.activeColorButton.index)},shakeToggleButtonIfInvisible(t){this.checkIfIsOpened(),this.activeColorButton&&this.activeColorButton.isRemovable&&this.selectedAvailableColors&&0!==this.selectedAvailableColors.length&&(this.isShaking=!0,setTimeout((()=>{this.isShaking=!1}),310))}}};const Di=(0,H.A)(Pi,[["render",Re]]);var Mi=Di;const ji=t=>((0,s.Qi)("data-v-2ef15751"),t=t(),(0,s.jt)(),t),Bi={class:"game-pad-wrapper"},Fi={class:"game-pad-buttons"},Ui=["disabled"],Ni=ji((()=>(0,s.Lk)("i",{class:"svg-icon svg-arrow-right"},null,-1))),Xi=[Ni],Hi=["disabled"],Vi=ji((()=>(0,s.Lk)("i",{class:"svg-icon svg-arrow-right"},null,-1))),Gi=[Vi],Yi=["disabled"],zi=ji((()=>(0,s.Lk)("i",{class:"svg-icon svg-arrow-right"},null,-1))),Wi=[zi],$i=["disabled"],qi=ji((()=>(0,s.Lk)("i",{class:"svg-icon svg-arrow-right"},null,-1))),Qi=[qi],Ji={class:"game-pad-rotate"};function Ki(t,e,i,a,o,l){const h=(0,s.g2)("GamePadButton"),c=(0,s.gN)("clickandhold");return(0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(l.classes)},[(0,s.bF)(h,{class:"btn-gamepad",onClick:(0,n.D$)(l.toggleGamePad,["stop","prevent"])},null,8,["onClick"]),(0,s.Lk)("div",Bi,[(0,s.Lk)("div",Fi,[(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow btn-top",disabled:-1===i.buttons.indexOf("up"),onClick:e[0]||(e[0]=(0,n.D$)((t=>l.handleClick("up")),["stop","prevent"]))},Xi,8,Ui)),[[c,()=>l.handleClick("up")]]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow btn-right",disabled:-1===i.buttons.indexOf("right"),onClick:e[1]||(e[1]=(0,n.D$)((t=>l.handleClick("right")),["stop","prevent"]))},Gi,8,Hi)),[[c,()=>l.handleClick("right")]]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow btn-bottom",disabled:-1===i.buttons.indexOf("down"),onClick:e[2]||(e[2]=(0,n.D$)((t=>l.handleClick("down")),["stop","prevent"]))},Wi,8,Yi)),[[c,()=>l.handleClick("down")]]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow btn-left",disabled:-1===i.buttons.indexOf("left"),onClick:e[3]||(e[3]=(0,n.D$)((t=>l.handleClick("left")),["stop","prevent"]))},Qi,8,$i)),[[c,()=>l.handleClick("left")]])]),(0,s.Lk)("div",Ji,[(0,s.Lk)("button",{class:"btn-default btn-shadow btn-cancel",onClick:e[4]||(e[4]=(0,n.D$)((t=>l.handleClick("default")),["stop","prevent"]))}," Default ")])])],2)}const Zi=t=>((0,s.Qi)("data-v-62510c9f"),t=t(),(0,s.jt)(),t),tn=Zi((()=>(0,s.Lk)("polygon",{points:"18,20 18,26 22,26 16,32 10,26 14,26 14,20   "},null,-1))),en=Zi((()=>(0,s.Lk)("polygon",{points:"14,12 14,6 10,6 16,0 22,6 18,6 18,12   "},null,-1))),nn=Zi((()=>(0,s.Lk)("polygon",{points:"12,18 6,18 6,22 0,16 6,10 6,14 12,14   "},null,-1))),sn=Zi((()=>(0,s.Lk)("polygon",{points:"20,14 26,14 26,10 32,16 26,22 26,18 20,18   "},null,-1))),rn=[tn,en,nn,sn];function an(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow game-pad-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},rn,4))],4)}var on={name:"GamePadButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnGamePad||"#ffffff"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const ln=(0,H.A)(on,[["render",an],["__scopeId","data-v-62510c9f"]]);var hn=ln,cn=({delay:t=400,interval:e=50})=>({bind:function(i,n,s){if("function"!==typeof n.value){const t=s.context.name;let e=`[longclick:] provided expression '${n.expression}' is not a function, but has to be`;t&&(e+=`Found in component '${t}' `),console.warn(e)}let r=null,a=null;const o=i=>{"click"===i.type&&0!==i.button||null===r&&(r=setTimeout((()=>{e&&e>0&&(a=setInterval((()=>{h()}),e)),h()}),t))},l=()=>{null!==r&&(clearTimeout(r),r=null),a&&(clearInterval(a),a=null)},h=t=>{n.value(t)};["mousedown","touchstart"].forEach((t=>i.addEventListener(t,o))),["click","mouseout","touchend","touchcancel"].forEach((t=>i.addEventListener(t,l)))}});const un=cn({delay:100,interval:50});var dn={name:"GamePad",components:{GamePadButton:hn},directives:{clickandhold:un},data(){return{opened:!1}},computed:{classes(){return["game-pad",this.opened&&this.visible?"opened":"",0!==this.buttons.length&&this.visible?"":"hidden"]}},props:{visible:{type:Boolean,default:!0},buttons:{type:Array,default:()=>[]}},methods:{toggleGamePad(){this.opened=!this.opened,this.opened&&this.$emit("open")},close(){this.opened=!1},handleClick(t){this.$emit("buttonclick",{source:t})}}};const fn=(0,H.A)(dn,[["render",Ki],["__scopeId","data-v-2ef15751"]]);var pn=fn;const mn={class:"overlay-black"};function gn(t,e,i,a,o,l){return(0,s.uX)(),(0,s.CE)("div",mn,[(0,s.Lk)("a",{class:(0,r.C4)(["close-modal",i.transparent?"transparent":""]),style:(0,r.Tr)([]),onClick:e[0]||(e[0]=(0,n.D$)(((...t)=>l.handleClickClose&&l.handleClickClose(...t)),["stop","prevent"]))},null,2),(0,s.RG)(t.$slots,"default",{},void 0,!0)])}var vn={name:"ModalOverlay",methods:{handleClickClose(){this.$emit("closed")}},props:{transparent:{type:Boolean,default:!1}}};const _n=(0,H.A)(vn,[["render",gn],["__scopeId","data-v-1d5a3441"]]);var bn=_n;const yn={class:"color-wheel-overlay-content"},wn=(0,s.Lk)("div",{class:"color-wheel-overlay-headers"}," Grande Palette ",-1),En={class:"color-wheel-overlay-buttons"},Cn=["disabled"];function Tn(t,e,i,n,r,a){const o=(0,s.g2)("ColorWheel"),l=(0,s.g2)("ModalOverlay");return(0,s.uX)(),(0,s.Wv)(l,{onClosed:a.handleClickCancel,class:"color-wheel-overlay"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",yn,[wn,(0,s.bF)(o,{modelValue:i.modelValue,"onUpdate:modelValue":e[0]||(e[0]=e=>t.$emit("update:modelValue",e)),swatches:r.swatches},null,8,["modelValue","swatches"]),(0,s.Lk)("div",En,[(0,s.Lk)("button",{class:"btn-default btn-shadow btn-color-wheel-cancel",onClick:e[1]||(e[1]=(...t)=>a.handleClickCancel&&a.handleClickCancel(...t))},"Cancel"),(0,s.Lk)("button",{class:"btn-default btn-shadow btn-color-wheel-apply",disabled:!i.modelValue,onClick:e[2]||(e[2]=(...t)=>a.handleClickApply&&a.handleClickApply(...t))},"Apply",8,Cn)])])])),_:1},8,["onClosed"])}const xn=new Set;var Sn={name:"ColorWheelModal",components:{ColorWheel:Ri,ModalOverlay:bn},data(){return{swatches:[...xn].reverse()}},methods:{handleClickCancel(){this.$emit("click-cancel")},handleClickApply(){if(xn.add(this.modelValue),xn.size>6){const[t]=xn;xn.delete(t)}this.$emit("click-apply")}},props:{modelValue:{default:"#ffffff",required:!0}},emits:["update:modelValue","click-cancel","click-apply"]};const In=(0,H.A)(Sn,[["render",Tn]]);var Ln=In;const On=t=>((0,s.Qi)("data-v-17b25d74"),t=t(),(0,s.jt)(),t),An=On((()=>(0,s.Lk)("path",{d:"m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"},null,-1))),kn=[An];function Rn(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow save-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},kn,4))],4)}var Pn={name:"SaveButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnSave||"#b0a9f9"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const Dn=(0,H.A)(Pn,[["render",Rn],["__scopeId","data-v-17b25d74"]]);var Mn=Dn;const jn=t=>((0,s.Qi)("data-v-268166c4"),t=t(),(0,s.jt)(),t),Bn={class:"btn-group"},Fn=jn((()=>(0,s.Lk)("g",null,[(0,s.Lk)("path",{d:" M 32.121 28.852 C 30.488 28.852 28.917 28.485 27.81 27.847 L 7.867 16.331 C 7.009 15.835 6.516 15.234 6.516 14.681 C 6.516 14.13 7.009 13.528 7.867 13.033 L 27.81 1.518 C 28.917 0.879 30.488 0.513 32.121 0.513 C 33.755 0.513 35.326 0.879 36.433 1.518 L 56.376 13.033 C 57.234 13.528 57.727 14.13 57.727 14.681 C 57.727 15.234 57.234 15.835 56.376 16.331 L 36.433 27.845 C 35.326 28.485 33.755 28.852 32.121 28.852 Z  M 32.121 16.743 C 30.281 16.743 28.728 15.8 28.728 14.683 C 28.728 13.566 30.283 12.622 32.121 12.622 C 33.96 12.622 35.515 13.566 35.515 14.683 C 35.515 15.8 33.961 16.743 32.121 16.743 Z ","fill-rule":"evenodd"}),(0,s.Lk)("path",{d:" M 55.909 47.096 C 54.792 47.096 53.849 45.713 53.849 44.076 C 53.849 42.44 54.792 41.055 55.909 41.055 C 57.026 41.055 57.969 42.439 57.969 44.076 C 57.969 45.714 57.026 47.096 55.909 47.096 L 55.909 47.096 Z  M 34.921 63 C 33.707 63 33.576 61.506 33.576 60.863 L 33.576 37.833 C 33.576 35.135 35.55 31.716 37.887 30.366 L 57.831 18.852 C 58.383 18.532 58.907 18.363 59.342 18.363 C 60.556 18.363 60.687 19.858 60.687 20.501 L 60.687 43.529 C 60.687 46.228 58.713 49.649 56.376 50.997 L 36.433 62.513 C 35.88 62.831 35.358 63 34.921 63 L 34.921 63 L 34.921 63 Z  M 39.335 40.914 C 38.217 40.914 37.275 39.531 37.275 37.893 C 37.275 36.255 38.217 34.872 39.335 34.872 C 40.452 34.872 41.396 36.255 41.396 37.893 C 41.394 39.531 40.45 40.914 39.335 40.914 Z ","fill-rule":"evenodd"}),(0,s.Lk)("path",{d:" M 7.607 47.096 C 6.489 47.096 5.547 45.713 5.547 44.076 C 5.547 42.44 6.489 41.055 7.607 41.055 C 8.724 41.055 9.666 42.439 9.666 44.076 C 9.666 45.714 8.722 47.096 7.607 47.096 L 7.607 47.096 L 7.607 47.096 L 7.607 47.096 Z  M 7.607 29.733 C 6.489 29.733 5.547 28.35 5.547 26.713 C 5.547 25.076 6.489 23.692 7.607 23.692 C 8.724 23.692 9.666 25.076 9.666 26.713 C 9.666 28.35 8.722 29.733 7.607 29.733 L 7.607 29.733 L 7.607 29.733 Z  M 24.728 40.914 C 23.611 40.914 22.668 39.531 22.668 37.893 C 22.668 36.255 23.611 34.872 24.728 34.872 C 25.845 34.872 26.789 36.255 26.789 37.893 C 26.788 39.531 25.845 40.914 24.728 40.914 L 24.728 40.914 Z  M 29.08 63 C 28.644 63 28.121 62.831 27.569 62.513 L 7.624 50.997 C 5.287 49.649 3.313 46.229 3.313 43.529 L 3.313 20.501 C 3.313 19.858 3.444 18.363 4.658 18.363 C 5.093 18.363 5.617 18.532 6.169 18.852 L 26.113 30.366 C 28.449 31.716 30.424 35.135 30.424 37.833 L 30.424 60.863 C 30.424 61.615 30.261 62.232 29.966 62.601 C 29.748 62.873 29.465 63 29.08 63 L 29.08 63 L 29.08 63 L 29.08 63 L 29.08 63 Z  M 24.728 56.945 C 23.611 56.945 22.668 55.561 22.668 53.924 C 22.668 52.286 23.611 50.903 24.728 50.903 C 25.845 50.903 26.789 52.286 26.789 53.924 C 26.789 55.561 25.845 56.945 24.728 56.945 Z ","fill-rule":"evenodd"})],-1))),Un=[Fn],Nn={key:0};function Xn(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",Bn,[(0,s.Lk)("button",{class:"btn-default btn-shadow random-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},Un,4))],4),i.showLabel?((0,s.uX)(),(0,s.CE)("label",Nn,(0,r.v_)(o.labelText),1)):(0,s.Q3)("",!0)])}var Hn={name:"RandomButton",inject:["theme","lang"],computed:{labelText(){return this.lang&&this.lang.btnRandomLabel||"Random"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnHamburgerItems||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!1}}};const Vn=(0,H.A)(Hn,[["render",Xn],["__scopeId","data-v-268166c4"]]);var Gn=Vn;const Yn=t=>((0,s.Qi)("data-v-654f2b84"),t=t(),(0,s.jt)(),t),zn=Yn((()=>(0,s.Lk)("g",null,[(0,s.Lk)("path",{d:"M18,24H78a6,6,0,0,0,0-12H18a6,6,0,0,0,0,12Z"}),(0,s.Lk)("path",{d:"M78,42H18a6,6,0,0,0,0,12H78a6,6,0,0,0,0-12Z"}),(0,s.Lk)("path",{d:"M78,72H18a6,6,0,0,0,0,12H78a6,6,0,0,0,0-12Z"})],-1))),Wn=[zn];function $n(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow hamburger-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg"},Wn,4))],4)}
/*! Iconset: Essentials Pack (https://www.iconfinder.com/iconsets/essentials-pack) */var qn={name:"HamburgerButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&(this.theme.colors.btnHamburger||this.theme.colors.btnRandom)||"#f69bc5"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const Qn=(0,H.A)(qn,[["render",$n],["__scopeId","data-v-654f2b84"]]);var Jn=Qn;const Kn=t=>((0,s.Qi)("data-v-98df6e0e"),t=t(),(0,s.jt)(),t),Zn={class:"btn-group"},ts=Kn((()=>(0,s.Lk)("path",{d:"M30,60H6A6,6,0,0,0,6,72H24V90a6,6,0,0,0,12,0V66A5.9966,5.9966,0,0,0,30,60Z"},null,-1))),es=Kn((()=>(0,s.Lk)("path",{d:"M90,60H66a5.9966,5.9966,0,0,0-6,6V90a6,6,0,0,0,12,0V72H90a6,6,0,0,0,0-12Z"},null,-1))),is=Kn((()=>(0,s.Lk)("path",{d:"M66,36H90a6,6,0,0,0,0-12H72V6A6,6,0,0,0,60,6V30A5.9966,5.9966,0,0,0,66,36Z"},null,-1))),ns=Kn((()=>(0,s.Lk)("path",{d:"M30,0a5.9966,5.9966,0,0,0-6,6V24H6A6,6,0,0,0,6,36H30a5.9966,5.9966,0,0,0,6-6V6A5.9966,5.9966,0,0,0,30,0Z"},null,-1))),ss=[ts,es,is,ns],rs=Kn((()=>(0,s.Lk)("path",{d:"M30,0H6A5.9966,5.9966,0,0,0,0,6V30a6,6,0,0,0,12,0V12H30A6,6,0,0,0,30,0Z"},null,-1))),as=Kn((()=>(0,s.Lk)("path",{d:"M90,0H66a6,6,0,0,0,0,12H84V30a6,6,0,0,0,12,0V6A5.9966,5.9966,0,0,0,90,0Z"},null,-1))),os=Kn((()=>(0,s.Lk)("path",{d:"M30,84H12V66A6,6,0,0,0,0,66V90a5.9966,5.9966,0,0,0,6,6H30a6,6,0,0,0,0-12Z"},null,-1))),ls=Kn((()=>(0,s.Lk)("path",{d:"M90,60a5.9966,5.9966,0,0,0-6,6V84H66a6,6,0,0,0,0,12H90a5.9966,5.9966,0,0,0,6-6V66A5.9966,5.9966,0,0,0,90,60Z"},null,-1))),hs=[rs,as,os,ls],cs={key:0};function us(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",Zn,[(0,s.Lk)("button",{class:"btn-default btn-shadow fullscreen-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[a.isFullscreen?((0,s.uX)(),(0,s.CE)("svg",{key:0,class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg"},ss,4)):((0,s.uX)(),(0,s.CE)("svg",{key:1,class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg"},hs,4))],4),i.showLabel?((0,s.uX)(),(0,s.CE)("label",cs,(0,r.v_)(o.labelText),1)):(0,s.Q3)("",!0)])}
/*! Iconset: Essentials Pack (https://www.iconfinder.com/iconsets/essentials-pack) */var ds={name:"FullscreenButton",data(){return{isFullscreen:I.isFullScreen,onFullscreenChanged:null}},mounted(){this.onFullscreenChanged=()=>this.$nextTick((()=>{this.isFullscreen=!I.isFullScreen})),I.addEventListener("fullscreenchange",this.onFullscreenChanged)},beforeUnmount(){I.removeEventListener("fullscreenchange",this.onFullscreenChanged)},inject:["theme","lang"],computed:{labelText(){return this.lang&&this.lang.btnRedoLabel||"Fullscreen"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnHamburgerItems||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!1}}};const fs=(0,H.A)(ds,[["render",us],["__scopeId","data-v-98df6e0e"]]);var ps=fs;const ms=t=>((0,s.Qi)("data-v-19727ae1"),t=t(),(0,s.jt)(),t),gs={class:"btn-group"},vs=ms((()=>(0,s.Lk)("defs",null,[(0,s.Lk)("path",{id:"Layer1_0_1_STROKES","stroke-width":"28.05","stroke-linejoin":"round","stroke-linecap":"round",fill:"none",d:"\n  M 235.35 179\n  Q 234.6490234375 180.213671875 233.95 181.4 234.9755859375 179.7302734375 235.925 178.025 235.63359375 178.5087890625 235.35 179 Z\n  M 233.95 181.4\n  Q 231.8041015625 184.94375 229.425 188.3 226.67265625 192.1640625 223.6 195.775 217.5568359375 203.0517578125 210.45 208.95 192.807421875 223.623046875 168.85 230.05 125 241.75 85.75 219.05 46.45 196.4 34.7 152.6\n  M 16 30.5\n  L 16.05 100.5 32.7 100.5\n  Q 39.25 70.9 62.1 48.05 94.2 16 139.55 16 184.9 16 216.95 48.05 249.05 80.15 249.05 125.5 249.05 149.26953125 240.275 169.4 238.98828125 172.2501953125 237.525 175.05 236.74921875 176.5447265625 235.925 178.025\n  M 32.7 100.5\n  L 86.05 100.5\n  M 223.6 195.775\n  Q 220.4498046875 199.405859375 216.95 202.9 213.7673828125 206.0876953125 210.45 208.95"})],-1))),_s=ms((()=>(0,s.Lk)("g",{transform:"matrix( 1, 0, 0, 1, 0,0) "},[(0,s.Lk)("use",{"xlink:href":"#Layer1_0_1_STROKES"})],-1))),bs=[vs,_s],ys={key:0};function ws(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",gs,[(0,s.Lk)("button",{class:"btn-default btn-shadow reset-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({stroke:o.color}),xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 264 250"},bs,4))],4),i.showLabel?((0,s.uX)(),(0,s.CE)("label",ys,(0,r.v_)(o.labelText),1)):(0,s.Q3)("",!0)])}var Es={name:"ResetButton",inject:["theme","lang"],computed:{labelText(){return this.lang&&this.lang.btnRedoLabel||"Reset"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnHamburgerItems||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!1}}};const Cs=(0,H.A)(Es,[["render",ws],["__scopeId","data-v-19727ae1"]]);var Ts=Cs;const xs=t=>((0,s.Qi)("data-v-7613defb"),t=t(),(0,s.jt)(),t),Ss=xs((()=>(0,s.Lk)("path",{d:"M14.757,46.02c-1.412,0-2.825-0.521-3.929-1.569c-2.282-2.17-2.373-5.78-0.204-8.063l12.758-13.418L10.637,9.645\n        C8.46,7.37,8.54,3.76,10.816,1.582c2.277-2.178,5.886-2.097,8.063,0.179l16.505,17.253c2.104,2.2,2.108,5.665,0.013,7.872\n        L18.893,44.247C17.77,45.424,16.267,46.02,14.757,46.02z"},null,-1))),Is=[Ss];function Ls(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("a",{class:"items-back-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 46.02 46.02",xmlns:"http://www.w3.org/2000/svg"},Is,4))],4)}var Os={name:"ItemsBackButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnItemsBack||"#6a615c"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const As=(0,H.A)(Os,[["render",Ls],["__scopeId","data-v-7613defb"]]);var ks=As;const Rs=t=>((0,s.Qi)("data-v-a0306cc6"),t=t(),(0,s.jt)(),t),Ps={class:"btn-group"},Ds=Rs((()=>(0,s.Lk)("defs",null,[(0,s.Lk)("path",{id:"Layer1_0_1_STROKES","stroke-width":"28.05","stroke-linejoin":"round","stroke-linecap":"round",fill:"none",d:"\n  M 235.35 179\n  Q 234.6490234375 180.213671875 233.95 181.4 234.9755859375 179.7302734375 235.925 178.025 235.63359375 178.5087890625 235.35 179 Z\n  M 233.95 181.4\n  Q 231.8041015625 184.94375 229.425 188.3 226.67265625 192.1640625 223.6 195.775 217.5568359375 203.0517578125 210.45 208.95 192.807421875 223.623046875 168.85 230.05 125 241.75 85.75 219.05 46.45 196.4 34.7 152.6\n  M 16 30.5\n  L 16.05 100.5 32.7 100.5\n  Q 39.25 70.9 62.1 48.05 94.2 16 139.55 16 184.9 16 216.95 48.05 249.05 80.15 249.05 125.5 249.05 149.26953125 240.275 169.4 238.98828125 172.2501953125 237.525 175.05 236.74921875 176.5447265625 235.925 178.025\n  M 32.7 100.5\n  L 86.05 100.5\n  M 223.6 195.775\n  Q 220.4498046875 199.405859375 216.95 202.9 213.7673828125 206.0876953125 210.45 208.95"})],-1))),Ms=Rs((()=>(0,s.Lk)("g",{transform:"matrix( 1, 0, 0, 1, 0,0) "},[(0,s.Lk)("use",{"xlink:href":"#Layer1_0_1_STROKES"})],-1))),js=[Ds,Ms],Bs={key:0};function Fs(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",Ps,[(0,s.Lk)("button",{class:"btn-default btn-shadow redo-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({stroke:o.color}),xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 264 250"},js,4))],4),i.showLabel?((0,s.uX)(),(0,s.CE)("label",Bs,(0,r.v_)(o.labelText),1)):(0,s.Q3)("",!0)])}var Us={name:"HistoryRedoButton",inject:["theme","lang"],computed:{labelText(){return this.lang&&this.lang.btnRedoLabel||"Redo"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnUndoRedo||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!1}}};const Ns=(0,H.A)(Us,[["render",Fs],["__scopeId","data-v-a0306cc6"]]);var Xs=Ns;const Hs=t=>((0,s.Qi)("data-v-48977c31"),t=t(),(0,s.jt)(),t),Vs={class:"btn-group"},Gs=Hs((()=>(0,s.Lk)("defs",null,[(0,s.Lk)("path",{id:"Layer1_0_1_STROKES","stroke-width":"28.05","stroke-linejoin":"round","stroke-linecap":"round",fill:"none",d:"\n  M 235.35 179\n  Q 234.6490234375 180.213671875 233.95 181.4 234.9755859375 179.7302734375 235.925 178.025 235.63359375 178.5087890625 235.35 179 Z\n  M 233.95 181.4\n  Q 231.8041015625 184.94375 229.425 188.3 226.67265625 192.1640625 223.6 195.775 217.5568359375 203.0517578125 210.45 208.95 192.807421875 223.623046875 168.85 230.05 125 241.75 85.75 219.05 46.45 196.4 34.7 152.6\n  M 16 30.5\n  L 16.05 100.5 32.7 100.5\n  Q 39.25 70.9 62.1 48.05 94.2 16 139.55 16 184.9 16 216.95 48.05 249.05 80.15 249.05 125.5 249.05 149.26953125 240.275 169.4 238.98828125 172.2501953125 237.525 175.05 236.74921875 176.5447265625 235.925 178.025\n  M 32.7 100.5\n  L 86.05 100.5\n  M 223.6 195.775\n  Q 220.4498046875 199.405859375 216.95 202.9 213.7673828125 206.0876953125 210.45 208.95"})],-1))),Ys=Hs((()=>(0,s.Lk)("g",{transform:"matrix( 1, 0, 0, 1, 0,0) "},[(0,s.Lk)("use",{"xlink:href":"#Layer1_0_1_STROKES"})],-1))),zs=[Gs,Ys],Ws={key:0};function $s(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("div",Vs,[(0,s.Lk)("button",{class:"btn-default btn-shadow undo-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({stroke:o.color}),xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 264 250"},zs,4))],4),i.showLabel?((0,s.uX)(),(0,s.CE)("label",Ws,(0,r.v_)(o.labelText),1)):(0,s.Q3)("",!0)])}var qs={name:"HistoryUndoButton",inject:["theme","lang"],computed:{labelText(){return this.lang&&this.lang.btnRedoLabel||"Undo"},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnUndoRedo||"#f0f9fe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!1}}};const Qs=(0,H.A)(qs,[["render",$s],["__scopeId","data-v-48977c31"]]);var Js=Qs;const Ks=t=>((0,s.Qi)("data-v-606dbafc"),t=t(),(0,s.jt)(),t),Zs=Ks((()=>(0,s.Lk)("g",null,[(0,s.Lk)("path",{d:"M48,0A24.0275,24.0275,0,0,0,24,24a6,6,0,0,0,12,0,12,12,0,0,1,24,0c0,5.2031-3.0586,8.3965-8.0859,13.0371C47.2617,41.32,42,46.1719,42,54a6,6,0,0,0,12,0c0-2.4434,2.2969-4.6875,6.0469-8.1445C65.0859,41.2031,72,34.834,72,24A24.0275,24.0275,0,0,0,48,0Z"}),(0,s.Lk)("path",{d:"M48,72A12,12,0,1,0,60,84,12.0119,12.0119,0,0,0,48,72Z"})],-1))),tr=[Zs];function er(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default btn-shadow help-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 96 96",xmlns:"http://www.w3.org/2000/svg"},tr,4))],4)}
/*! Iconset: Essentials Pack (https://www.iconfinder.com/iconsets/essentials-pack) */var ir={name:"HelpButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnSave||"#b0a9f9"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const nr=(0,H.A)(ir,[["render",er],["__scopeId","data-v-606dbafc"]]);var sr=nr;const rr=window&&window.location&&y(window.location.toString()),ar=N(),or={WelcomeScreen:"welcome-screen",SaveScreen:"save-screen",Playing:"playing"};var lr={components:{ResizeObserver:P.tb,ScrollableList:J,LoadingEllipsis:Jt,OverlayAnimation:nt,LoadingOverlay:te,PoweredBy:Ft,SaveGameOverlay:Ae,SaveButton:Mn,RandomButton:Gn,ResetButton:Ts,RedoButton:Xs,UndoButton:Js,HelpButton:sr,ItemsBackButton:ks,ScrollableColorList:Mi,GamePad:pn,StampRemoveButton:pt,StampDuplicateButton:Tt,StampFlipHorizontalButton:Ot,HamburgerButton:Jn,FullscreenButton:ps,ModalOverlay:bn,ColorWheelModal:Ln},directives:{wheelblock:ar},data(){return{expand:!1,showDownloadButton:!rr,isMobileIOS:C,isMobileIPad:E,isFullscreen:I.isFullScreen,onFullscreenChanged:null,hamburgerMenuShowLabels:!1,colorWheelClickIndex:-1,colorWheelColor:"#fff",columnsClass:"",columnsWidth:80,offsetBounds:{width:0,height:0},debug:{isLoadingGame:!1,onWelcomeScreen:!1,onSaveScreen:!1,onStampEditScreen:!1}}},inject:["theme","lang"],computed:{canExpandItems(){return this.expand&&!this.onSaveScreen},hideAdContainer(){return this.state===or.WelcomeScreen||this.isLoadingGame},isLoadingGame(){return this.loading||this.debug.isLoadingGame},isColorWheelVisible(){return-1!==this.colorWheelClickIndex},onWelcomeScreen(){return this.state===or.WelcomeScreen||this.debug.onWelcomeScreen},onSaveScreen(){return this.state===or.SaveScreen||this.debug.onSaveScreen},onStampEditScreen(){return this.showStampButtons||this.debug.onStampEditScreen},hideSaveAndRandomButtons(){return this.onSaveScreen||this.onStampEditScreen?"hide":this.expand?"hide-sm":""},backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.mainBg||"#bebebe"},saveAnimationColor(){return this.theme&&this.theme.colors&&this.theme.colors.saveAnimation||"#f69bc5"},canvasBackgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.canvasBg||"#000000"},itemsScrollBackgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.itemsBg||"#ffffff"},itemsScrollBackgroundGradient(){if(this.theme&&this.theme.colors&&this.theme.colors.itemsBgGradient){const t=this.theme.colors.itemsBgGradient;return`${t.type||"linear"}-gradient(${t.deg||0}deg, ${t.from}, ${t.to});`}return"none"},categoriesScrollBackgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.categoriesBg||"#f3f3f3"},categoriesScrollBackgroundGradient(){if(this.theme&&this.theme.colors&&this.theme.colors.categoriesBgGradient){const t=this.theme.colors.categoriesBgGradient;return`${t.type||"linear"}-gradient(${t.deg||0}deg, ${t.from}, ${t.to});`}return"none"},stampsButtonBlockClasses(){return this.blockStampButtons?"button-disabled":""}},props:{colors:{type:Array,default:()=>[]},buttons:{type:Array,default:()=>[]},state:{type:String,default:or.WelcomeScreen},loading:{type:Boolean,default:!1},fullPageLoading:{type:Boolean,default:!1},saveImage:{type:Object,default(){return null}},saveImageForceDownload:{type:Boolean,default:!0},poweredByHref:{type:String,default:null},poweredByPremiumHref:{type:String},poweredByPremiumLabel:{type:String},transparent:{type:Boolean,default:!0},showSaveButton:{type:Boolean,default:!1},showStampButtons:{type:Boolean,default:!1},hamburgerMenuVisible:{type:Boolean,default:!1},enableUndoButton:{type:Boolean,default:!0},enableRedoButton:{type:Boolean,default:!0},enableFullscreenButton:{type:Boolean,default:!0},blockStampButtons:{type:Boolean,default:!1},presentationMode:{type:Boolean,required:!0},colorWheel:{type:Boolean,default:!1},saveScreenAnimation:{type:Boolean,default:!0}},methods:{setExpanded(t){this.$nextTick((()=>{this.expand=t}))},hideHamburgerMenu(){this.$emit("update:hamburgerMenuVisible",!1),this.hamburgerMenuShowLabels=!1},showHamburgerMenu(){this.$emit("update:hamburgerMenuVisible",!0)},handleFullscreenToggle(){this.hideHamburgerMenu(),this.$emit("fullscreen-toggle")},handleClickClose(){this.setExpanded(!1)},handleClickRandom(){this.$emit("random")},handleClickReset(){this.hideHamburgerMenu(),this.$emit("reset")},handleClickUndo(){this.$emit("undo")},handleClickRedo(){this.$emit("redo")},handleColor(t,e=0){this.$emit("color",t,e)},handleColorVisible(t,e=0){this.$emit("color-visible",t,e)},hideColorWheelPopup(){this.colorWheelClickIndex=-1},handleColorWheelClick(t,e,i=0){this.colorWheelClickIndex=i,e&&(this.colorWheelColor=e)},handleColorWheelChanged(){this.colorWheelColor&&this.$emit("color-wheel-change",this.colorWheelColor,this.colorWheelClickIndex),this.hideColorWheelPopup()},handleMove(t){this.$emit("gamepad",t)},handleSaveGameFile(t){this.$emit("save-game",t)},enterSaveMode(t){this.$emit("prepare-save",t)},exitSaveMode(t){this.$emit("cancel-save",t)},onClickSave(t){this.$emit("save-online",t)},applyStamp(t){this.$emit("stamps",!0)},exitStampEditMode(t){this.$emit("stamps",!1)},duplicateCurrentStamp(t){this.$emit("duplicate-stamp",t)},flipCurrentStampHorizontally(t){this.$emit("flip-stamp-horizontally",t)},handleResize({width:t,height:e}){this.offsetBounds.width=t-this.$refs.container.offsetWidth,this.offsetBounds.height=e-this.$refs.container.offsetHeight,this.offsetBounds.width>=5*this.columnsWidth?this.columnsClass="columns-3x2":this.offsetBounds.width>=4*this.columnsWidth?this.columnsClass="columns-2x2":this.offsetBounds.width>=3*this.columnsWidth?this.columnsClass="columns-2x1":(this.columnsClass="columns-1x1",t<480&&(this.columnsClass+=" push-right-sm"))}},mounted(){this.handleResize({width:this.$el.offsetWidth,height:this.$el.offsetHeight}),this.onFullscreenChanged=()=>this.$nextTick((()=>{this.isFullscreen=!I.isFullScreen})),I.addEventListener("fullscreenchange",this.onFullscreenChanged)},beforeUnmount(){I.removeEventListener("fullscreenchange",this.onFullscreenChanged)}};const hr=(0,H.A)(lr,[["render",_],["__scopeId","data-v-08a15c64"]]);var cr=hr;function ur(t,e,i,n,r,a){const o=(0,s.g2)("RemoveItemsButton"),l=(0,s.g2)("ThumbnailImageLoad"),h=(0,s.g2)("ColorPickerBadge"),c=(0,s.g2)("StampBadge");return(0,s.uX)(),(0,s.CE)(s.FK,null,[i.item.delete?((0,s.uX)(),(0,s.Wv)(o,{key:0,style:{"margin-top":"11px"}})):((0,s.uX)(),(0,s.Wv)(l,{key:1,"parent-list":i.parentList,item:i.item,"base-url":i.baseUrl},null,8,["parent-list","item","base-url"])),!i.item.isColorPicker&&!i.item.isDynamic||i.item.isHidden?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(h,{key:2,class:"no-filter"})),i.item.isStamps?((0,s.uX)(),(0,s.Wv)(c,{key:3,class:"no-filter"})):(0,s.Q3)("",!0)],64)}const dr={key:0,class:"icon-wrapper"},fr=["src"];function pr(t,e,i,n,a,o){const l=(0,s.g2)("LoadingIcon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[o.src?((0,s.uX)(),(0,s.CE)("span",dr,[(0,s.Lk)("img",{ref:"icon",src:o.src,class:(0,r.C4)(a.thumbnailOrientation),onError:e[0]||(e[0]=(...t)=>o.handleImageError&&o.handleImageError(...t)),onLoad:e[1]||(e[1]=(...t)=>o.handleImageLoad&&o.handleImageLoad(...t))},null,42,fr)])):(0,s.Q3)("",!0),o.loading?((0,s.uX)(),(0,s.Wv)(l,{key:1,"parent-list":i.parentList,class:"no-filter"},null,8,["parent-list"])):(0,s.Q3)("",!0)],64)}i(2901),i(1151),i(1320),i(1583);class mr extends Error{}Object.freeze({exit(){throw new mr},exitWithMessage(t){throw new mr(t)}});const gr=Object.freeze({HIGH:"high",MEDIUM:"medium",LOW:"low"}),vr=()=>{},_r=(console.log.bind(console),Object.seal({debug:!0,levels:["ERROR","WARNING","DEBUG"],icons:{ERROR:"",WARNING:"",DEBUG:"",DEFAULT:""},logFunc:vr}));var br=(t,e="debug",i=null)=>_r.debug?(e=e.toUpperCase(),-1===_r.levels.indexOf(e)?vr:(i||"string"!==typeof _r.icons[e]||(i=_r.icons[e]),i||(i=_r.icons.DEFAULT||""),function(n,s=void 0){_r.logFunc.apply(null,[`${i} [${e}]%c[${t}]`,"color: gray",...arguments])})):vr;const yr=br("nextTick","ERROR"),wr="undefined"!==typeof Promise,Er=(wr&&Promise.resolve(),"undefined"!==typeof window&&window.navigator.userAgent.toLowerCase()),Cr=(Er&&/iphone|ipad|ipod|ios/.test(Er),12.5);function Tr(t){const e=[];let i=!1;function n(s=void 0){if("function"===typeof s&&e.push(s),i||(i=!0,t((()=>{i=!1,Sr(e)}))),!s&&wr)return new Promise((t=>n(t)))}return n}function xr(t){try{const e=t.apply(null);wr&&e instanceof Promise&&e.catch((t=>yr(t)))}catch(e){yr(e)}}function Sr(t,e=0){const i=t.slice(0);t.length=0;for(let n=e;n<i.length;n++)xr(i[n])}const Ir=Object.seal({programCounter:0,pendingCallbacks:[],flushCallbacks(){return Sr(this.pendingCallbacks)}}),Lr=t=>{Ir.programCounter++,queueMicrotask((()=>{xr(t),Ir.programCounter--,0===Ir.programCounter&&Ir.flushCallbacks()}))},Or=t=>{Ir.pendingCallbacks.push(t),queueMicrotask((()=>{0===Ir.programCounter&&Ir.flushCallbacks()}))},Ar=Tr(Lr);let kr=Ar;const Rr=Tr(Or);let Pr=Rr;var Dr=kr;const Mr=Symbol("@watch"),jr=Object.freeze({ATTRIBUTE_CHANGE:"attribute-change",CHILD_ATTRIBUTE_CHANGE:"child-attribute-change",CHILDREN_LENGTH_CHANGE:"children-length-change",DESTROYED:"destroyed",CREATED:"created"});class Br{observers=[];notifyScopes=[];notifyId=null;constructor(){Object.seal(this)}register(t){return"function"===typeof t?(this.observers.push(t),()=>this.unregister(t)):null}unregister(t){if("function"!==typeof t)return!1;const e=this.observers.indexOf(t);return-1!==e&&(this.observers.splice(e,1),!0)}notify(t){0!==this.observers.length?(-1===this.notifyScopes.indexOf(t)&&this.notifyScopes.push(t),this.notifyId||(this.notifyId=1,Pr((()=>{this.notifyId=null,0!==this.notifyScopes.length&&(this.notifyScopes.forEach((t=>{this.observers.forEach((e=>{kr((()=>e(t)))}))})),this.notifyScopes.length=0)})))):this.notifyId=null}static getObserverOf(t){return"object"!==typeof t||"object"!==typeof t[Mr]?null:t[Mr]}}function Fr(t){if("object"!==typeof t)return null;if(!Object.isExtensible(t))return null;if(Object.prototype.hasOwnProperty.call(t,Mr))return null;const e=new Br;return Object.defineProperty(t,Mr,{value:e,writable:!1,enumerable:!1,configurable:!1}),e}function Ur(t,e,i=null){if(Array.isArray(t)&&Array.isArray(i))throw new TypeError("Layer can't be the child of an array.");Array.isArray(t)?t.forEach((i=>Ur(i,e,t))):"object"===typeof t&&(e(t,i),Array.isArray(t.children)&&t.children.forEach((i=>Ur(i,e,t))))}function Nr(t,e,i=null){if(Array.isArray(t)&&Array.isArray(i))throw new TypeError("Layer can't be the child of an array.");if(Array.isArray(t))for(let n=t.length-1;n>=0;n--)Nr(t[n],e,t);else if("object"===typeof t&&(e(t,i),Array.isArray(t.children)))for(let n=t.children.length-1;n>=0;n--)Nr(t.children[n],e,t)}function Xr(t=0,e=0){return e.toString(36)+Math.random().toString(36).substring(2)+t.toString(36)}function Hr(t){const e=t.toString().trim();return t=parseFloat(t),e===t.toString()?t:e}function Vr(t,e){if("undefined"===typeof t||null===t)return!1;const i=t.constructor.name.toLowerCase(),n="string"===typeof e?e:"function"===typeof e?e.name:e.toString();return n.toLowerCase()===i.toLowerCase()}function Gr(t,e){if(null===t||null===e||void 0===t||void 0===e)return t===e;if(typeof t!==typeof e)return!1;if(["string","number","boolean"].includes(typeof t))return t===e;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Gr(t[i],e[i]))return!1;return!0}if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(t instanceof Object&&e instanceof Object){const i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(const s of i)if(!Object.prototype.hasOwnProperty.call(e,s)||!Gr(t[s],e[s]))return!1;return!0}return!1}function Yr(t){return"undefined"===typeof Proxy?t:new Proxy(t,{get:function(t,e,i){if(!(e in t))return;if("symbol"===typeof e||"hasOwnProperty"===e||"isPrototypeOf"===e||"propertyIsEnumerable"===e||"toLocaleString"===e||"toString"===e||"constructor"===e||"__proto__"===e)return t[e];const n=Object.getOwnPropertyDescriptor.call(t,e);return n&&!1===n.configurable&&!1===n.writable||"function"===typeof t[e]&&Array.isArray(t)&&-1===["unshift","splice","sort","shift","reverse","push","pop"].indexOf(e)?t[e]:"function"===typeof t[e]?()=>{throw new TypeError("Readonly proxy of object")}:null!==t[e]&&"object"===typeof t[e]?Yr(t[e]):t[e]},set(){throw new TypeError("Readonly proxy of object")},deleteProperty(){throw new TypeError("Readonly proxy of object")},defineProperty(){return!1},isExtensible(){return!1}})}let zr=Object.create(null);const Wr=/\s+/gi;class $r{raw;name;value;constructor(t){let[e,i]=t.split(":").map((t=>t.trim()));this.raw=t.trim(),this.name=e,i&&(i=i.replace(Wr," ").split(" ").map((t=>Hr(t.trim())))),this.value=Object.freeze(i||[]),Object.freeze(this),zr[t]=this}static create(t){return Object.prototype.hasOwnProperty.call(zr,t)?zr[t]:new $r(t)}static compileRawTagText(t){const{name:e,value:i}=t;if(!Array.isArray(i)||0===i.length)return`${e}`;const n=i.map((t=>{if("number"!==typeof t&&"string"!==typeof t)throw new TypeError("Invalid value type: "+typeof t);return t.toString().trim().replace(/\s/gi,"")})).join(" ");return`${e}:${n}`}static clearObjectPool(){zr=Object.create(null)}}class qr{value=null;constructor(t){if("function"===typeof t)throw new Error("Functions not serializable by this class");this.value=JSON.stringify(t),Object.freeze(this)}toJson(){return this.value}unserialize(){return JSON.parse(this.value)}clone(){return this.unserialize()}toObject(){return this.unserialize()}static that(t,e=!0){return e&&(Vr(t,Number)||Vr(t,String)||Vr(t,Boolean))?t:new qr(t)}}class Qr{pistonUnitId;observer=null;scope=jr.ATTRIBUTE_CHANGE;constructor(t,e=jr.ATTRIBUTE_CHANGE){if(!t||!e||"object"!==typeof t||"string"!==typeof e)throw new Error("Incorrect notification params");if(!t.base||!t.id||isNaN(t.id))throw new Error("Incorrect piston unit");this.observer=Br.getObserverOf(t.base),this.pistonUnitId=t.id,this.scope=e,Object.defineProperty(this,"identifier",{value:`notify-${t.id}-${e}`,writable:!1})}execute({context:t},e){this.observer.notify(this.scope)}}const Jr=br("Commit","error");class Kr{pistonUnitId;propName;currentValue;newValue;createdAt=performance.now();constructor(t,e,i,n){if("object"===typeof t&&t.id&&(t=t.id),!t||!e)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),this.propName=e,this.newValue=qr.that(i),this.currentValue=qr.that(n)}commit(t){const e=t.find(this.pistonUnitId);if(!e)return 1;if("object"!==typeof e.properties[this.propName])return 2;const i=this.newValue instanceof qr?this.newValue.clone():this.newValue,n=this.currentValue instanceof qr?this.currentValue.clone():this.currentValue,s=e.get(this.propName);return Gr(s,i)?3:Gr(s,n)?(e.properties[this.propName].set(e.base,i),void this.notify(t,e)):(Jr("Cant revert that because the current object value is inconsistent"),4)}revert(t){const e=t.find(this.pistonUnitId);if(!e)return 1;if("object"!==typeof e.properties[this.propName])return 2;const i=this.newValue instanceof qr?this.newValue.clone():this.newValue,n=this.currentValue instanceof qr?this.currentValue.clone():this.currentValue,s=e.get(this.propName);return Gr(s,n)?3:Gr(s,i)?(e.properties[this.propName].set(e.base,n),void this.notify(t,e)):(Jr("Cant revert that because the current object value is inconsistent"),4)}notify(t,e){t.schedule(new Qr(e),gr.LOW);const i=t.find(e.parentId);i&&t.schedule(new Qr(i,jr.CHILD_ATTRIBUTE_CHANGE),gr.LOW)}}class Zr{pistonUnitId;propName;propValue;constructor(t,e,i){if("object"===typeof t&&t.id&&(t=t.id),!t||!e)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),this.propName=e,this.propValue=i,Object.defineProperty(this,"identifier",{value:this.pistonUnitId+"-"+this.propName,writable:!1})}execute({context:t},e){const i=t.find(this.pistonUnitId);if(!i)return 1;if("object"!==typeof i.properties[this.propName])return 2;const n=i.get(this.propName);if(Gr(n,this.propValue))return 3;if(!Vr(this.propValue,i.properties[this.propName].type))return 5;i.rules.forEach((e=>{e.validate(t,i,this.propName,this.propValue)}));const s=i.properties[this.propName].set(i.base,this.propValue);if(!1===s)return 4;const r=new Kr(this.pistonUnitId,this.propName,this.propValue,n);t.history.pushState(r),r.notify(t,i)}}const ta=Symbol("@uuid");function ea(t,e){let i=(new Date).getTime();t=((t||"").toString(16)||"").padStart(12,"x"),e=(e||"").toString().padStart(4,"x");const n=("xxxxxxxx-"+e+"-4xxx-axxx-"+t).replace(/[xy]/g,(function(t){const e=(i+16*Math.random(16))%16|0;return i=Math.floor(i/16),("x"===t?e:3&e|8).toString(16)}));return n}const ia=()=>null;class na{pistonUnitId;actionName;actionPayload;returnCallback;constructor(t,e,i,n=null){if("object"===typeof t&&t.id&&(t=t.id),!Number.isInteger(t)||!e)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),this.actionName=e,this.actionPayload=i,this.returnCallback=n||null}execute({context:t},e){const i=this.returnCallback||ia,n=t.find(this.pistonUnitId);if(!n)return i(new Error("Piston unit not found"));if("object"!==typeof n.actions[this.actionName])return i(void 0);try{const e=n.actions[this.actionName].invoke(t,n,this.actionPayload);return e instanceof Promise?(i(e),e):i(e)}catch(yr){throw i(yr),yr}}}class sa{pistonUnitId;attemptCount;constructor(t,e=0){if("object"===typeof t&&t.id&&(t=t.id),!t)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),this.attemptCount=parseInt(e)||0}execute({context:t},e){const i=t.find(this.pistonUnitId);if(!i)return;const n=i.get("visible");if(n&&0===this.attemptCount)return i.set("visible",!1),void t.schedule(new sa(this.pistonUnitId,this.attemptCount+1));if(!n){i.base.children.forEach((e=>{const i=t.find(e);i&&i.dispose()}));while(i.rules.length>0)i.rules.shift();for(const t in i.properties)delete i.properties[t];for(const t in i.actions)delete i.actions[t];t.pistonUnits.delete(i),delete i.base[ta],t.schedule(new Qr(i,jr.DESTROYED),gr.LOW)}}}const ra=0xffffffffff,aa=ra-68719476735;let oa=ra;class la{constructor(){throw new TypeError("LocalID can't be initialized")}static get MAX_VALUE(){return ra}static get MIN_VALUE(){return aa}static get lastGeneratedId(){return oa}static updateLastGeneratedId(t){la.canBeLastGeneratedId(t)&&(oa=t)}static generate(){if(oa<=aa)throw new Error("Fatal Error! maximum number of generated ids reached");return--oa}static isValid(t){return t>=aa&&t<=ra}static canBeLastGeneratedId(t){return!!la.isValid(t)&&!(t>=oa)}static reset(){oa=ra}}const ha=Symbol("@context"),ca=Symbol("@metadata");class ua{base;tags=[];rules=[];actions=Object.create(null);properties=Object.create(null);constructor(t,e){if("object"!==typeof t)throw new Error("PistonUnit base is not a object");if(Object.prototype.hasOwnProperty.call(t,ta))throw new Error('The base object "'+t[ta]+'" is being used by another context.');if(this.base=t,t.parent_id="undefined"===typeof t.parent_id?null:t.parent_id,t.children=t.children||[],t.tags=t.tags||[],t.tags.forEach((t=>{this.tags.push($r.create(t))})),(!Number.isInteger(t.id)||t.id<0)&&(t.id=la.generate()),t.parent_id===t.id)throw new Error("Invalid parent id");Object.defineProperty(this,ha,{value:e}),Object.isExtensible(t)&&(Object.prototype.hasOwnProperty.call(t,ca)||Object.defineProperty(t,ca,{value:new Map,writable:!1}),Object.defineProperty(t,ta,{value:ea(t.id||"00a"),configurable:!0,writable:!1})),Fr(t),Object.freeze(this)}get id(){return this.base.id}get parentId(){return this.base.parent_id}static getMetadataOf(t,e="global",i=!0){if(t instanceof ua&&(t=t.base),"object"===typeof t&&Object.prototype.hasOwnProperty.call(t,ca))return e="string"===typeof e&&e.length>0?e.toLowerCase():"global",i="global"===e||i,i&&!t[ca].has(e)&&t[ca].set(e,Object.create(null)),t[ca].get(e)}static clearMetadataOf(t,e){if(t instanceof ua&&(t=t.base),"object"!==typeof t||!Object.prototype.hasOwnProperty.call(t,ca))return!1;if(e="string"===typeof e&&e.length>0?e.toLowerCase():null,!e||"global"===e)throw new TypeError("global scope can't be deleted");return t[ca].delete(e)}static getUUIDOf(t){return t instanceof ua&&(t=t.base),"object"===typeof t&&Object.prototype.hasOwnProperty.call(t,ta)?t[ta]:null}dispose(){const t=this[ha];"object"===typeof t&&t.schedule(new sa(this.id))}clone(t=void 0){const e=JSON.parse(JSON.stringify(this.base));if("object"===typeof t)for(const i in t)e[i]=t[i];return new ua(e,this[ha])}invoke(t,e){const i=this[ha];return"object"!==typeof i||"string"!==typeof t||"object"!==typeof this.actions[t]?Promise.resolve(void 0):new Promise(((n,s)=>{i.schedule(new na(this.id,t,e,(t=>{if(t instanceof Error)return s(t);n(t)})),gr.MEDIUM)}))}set(t,e){const i=this[ha];"object"===typeof i&&"string"===typeof t&&"object"===typeof this.properties[t]&&i.schedule(new Zr(this.id,t,e),gr.HIGH)}get(t){if("object"===typeof this.properties[t])return this.properties[t].get(this.base)}has(t){return Object.prototype.hasOwnProperty.call(this.properties,t)}attachProperty(t,e=void 0){e||"object"!==typeof t||"function"!==typeof t.get||(this.properties[t.name]=t),"string"===typeof t&&"object"===typeof e&&"function"===typeof e.get&&(this.properties[t]=e)}attachRule(t){"object"===typeof t&&"function"===typeof t.validate&&(this.rules.push(t),"function"===typeof t.setup&&t.setup(this[ha],this))}attachAction(t,e=void 0){e||"object"!==typeof t||"function"!==typeof t.invoke||(this.actions[t.name]=t),"string"===typeof t&&"object"===typeof e&&"function"===typeof e.invoke&&(this.actions[t]=e)}}class da{list=[];listById=Object.create(null);listByUUID=Object.create(null);get length(){return this.list.length}get size(){return this.list.length}push(t){if("object"!==typeof t)return-1;if(!t.id&&!t[ta])return-1;t.id&&(this.listById[t.id]=t);const e=t[ta];return e&&(this.listByUUID[e]=t),this.list.push(t)}find(t,e){return this.list.find(t,e)}findById(t){return this.listById[t]}findByUUID(t){return this.listByUUID[t]}delete(t){let e=null;if("object"===typeof t&&(e=t,t=e.id||e[ta]),e||(e=this.findById(t)),e||(e=this.findByUUID(t)),e)return this.list.splice(this.list.indexOf(e),1),delete this.listById[t],delete this.listByUUID[t],e}forEach(t,e){return this.list.forEach(t,e)}filter(t,e){return this.list.filter(t,e)}}class fa{startTimeInMs=0;now(){return this.startTimeInMs+performance.now()}}class pa{constructor(t){if("function"!==typeof t)throw new Error("Invalid callback function");this.execute=(e,i)=>t(e,i)}execute(t,e){}}class ma{name;createdAt=performance.now();constructor(t=""){this.name=t||"Unknown"}commit(t){}revert(t){}}class ga{execute({context:t}){const e=t.history,i=e.changes,n=e.length-1,s=e.indexOfPreviousCheckpoint();if(s<0)return 1;i.pointer=s+1;for(let r=n;r>s;r--)i[r]instanceof ma||i[r].revert(t)}}class va{execute({context:t}){const e=t.history,i=e.changes,n=e.length-1;let s=e.indexOfNextCheckpoint();if(s<0&&e.length===e.changes.length)return 1;s=s>=0?s:e.changes.length-1,i.pointer=s+1;for(let r=n+1;r<=s;r++)i[r]instanceof ma||i[r].commit(t)}}class _a{execute({context:t}){const e=t.history,i=e.changes,n=e.length-1,s=e.changes.length-1;if(!(n>=s)){i.pointer=s;for(let e=n;e<=s;e++){const n=i[e]instanceof ma;n||i[e].commit(t)}}}}class ba{execute({context:t}){const e=t.history,i=e.changes,n=e.length-1,s=i[0]instanceof ma?0:e.indexOfNextCheckpoint(0);if(s<0)return 1;i.pointer=s+1;for(let r=n;r>s;r--)i[r]instanceof ma||i[r].revert(t)}}const ya=Symbol("@context");class wa{changes=[];get startedAt(){return this.timer.startTimeInMs}timer=new fa;constructor(t){if("object"!==typeof t)throw new Error("Context not found ");Object.defineProperty(this,ya,{value:t}),this.changes.pointer=0,Object.freeze(this)}get length(){return this.changes.pointer}getCheckpointsIndexes(){const t=[];return this.changes.forEach(((e,i)=>{e instanceof ma&&t.push(i)})),t}indexOfNextCheckpoint(t=-1){(t<0||t>=this.changes.length)&&(t=this.changes.pointer-1);let e=t;while(e<this.changes.length&&this.changes[e]instanceof ma)e++;let i=e+1;while(i<this.changes.length&&!(this.changes[i]instanceof ma))i++;return i>=this.changes.length?-1:i}indexOfPreviousCheckpoint(t=-1){(t<0||t>=this.changes.length)&&(t=this.changes.pointer-1);let e=t;while(e>0&&this.changes[e]instanceof ma)e--;let i=e-1;while(i>=0&&!(this.changes[i]instanceof ma))i--;return i<0?-1:i}pushState(t){if(!t||"function"!==typeof t.commit||"function"!==typeof t.revert)return-1;this.changes.length>this.changes.pointer&&(this.changes.length=this.changes.pointer),t.createdAt=this.timer.now();const e=this.changes.push(t);return this.changes.pointer++,e}pushAndCommitState(t){const e=this[ya];if("object"!==typeof e)throw new Error("Context not found ");const i=this.pushState(t);return-1!==i&&t.commit(e),i}go(t){const e=this[ya];if("object"!==typeof e)return Promise.reject(new Error("Context not found "));let i=Math.abs(t);return i>this.changes.length&&(i=this.changes.length),new Promise(((n,s)=>{if(t>0&&this.length<this.changes.length){for(let t=0;t<i;t++)e.jobQueue.lazyEnqueue(new va);return e.jobQueue.lazyEnqueue(new pa((()=>n()))),void e.jobQueue.next(e)}if(t<0&&this.length>0){for(let t=0;t<i;t++)e.jobQueue.lazyEnqueue(new ga);return e.jobQueue.lazyEnqueue(new pa((()=>n()))),void e.jobQueue.next(e)}n()}))}back(){return this.go(-1)}forward(){return this.go(1)}rewind(){const t=this[ya];return"object"!==typeof t?Promise.reject(new Error("Context not found ")):new Promise(((e,i)=>{t.jobQueue.lazyEnqueue(new ba),t.jobQueue.lazyEnqueue(new pa((()=>e()))),t.jobQueue.next(t)}))}forwardToLastCheckpoint(){const t=this[ya];return"object"!==typeof t?Promise.reject(new Error("Context not found ")):new Promise(((e,i)=>{t.jobQueue.lazyEnqueue(new _a),t.jobQueue.lazyEnqueue(new pa((()=>e()))),t.jobQueue.next(t)}))}clear(){this.changes.length=0,this.changes.pointer=0}}const Ea="function"===typeof WeakMap?new WeakMap:new Map;class Ca{variables;context;constructor(t){if("object"!==typeof t)throw new Error("Context is not a object");this.variables=Object.freeze(new Map),this.context=t,Object.freeze(this),Ea.set(t,this)}static create(t){if(Ea.has(t)){const e=Ea.get(t);return e.variables.clear(),e}return new Ca(t)}}class Ta{keys;entries;lastDequeue;constructor(t){if(!Array.isArray(t))throw new TypeError("Queues names are not an array");const e=[],i=[],n=Object.create(null);n.lengthOfQueue=Object.create(null),n.chosen=Object.seal({job:null,priority:null}),t.forEach((t=>{if("string"!==typeof t)throw new TypeError("Queue name invalid");this[t]=new Array(1024),this[t].length=0,i.push(this[t]),e.push(t),n.lengthOfQueue[t]=0})),Object.defineProperty(this,"lastDequeue",{value:n,enumerable:!1}),Object.defineProperty(this,"keys",{value:e,enumerable:!1}),Object.defineProperty(this,"entries",{value:i,enumerable:!1}),Object.freeze(this),Object.freeze(e),Object.freeze(i),Object.freeze(n),Object.seal(n.lengthOfQueue),Object.seal(n.chosen)}enqueue(t,e){if(!t||"function"!==typeof t.execute)return!1;const i=this.keys.indexOf(e);return-1!==i&&("string"===typeof t.identifier&&this.removeByIdentifier(t.identifier),this.entries[i].push(t),!0)}dequeue(){for(let t=0;t<this.entries.length;t++){const e=this.entries[t];if(0===e.length)continue;const i=this.lastDequeue.chosen;return i.job=e.shift(),i.priority=this.keys[t],this.lastDequeue.lengthOfQueue[i.priority]=e.length,i}return null}flush(){this.forEach(((t,e)=>{t.length=this.lastDequeue.lengthOfQueue[e]}))}clear(){this.forEach(((t,e)=>{t.length=0,this.lastDequeue.lengthOfQueue[e]=0}))}forEach(t,e){return this.keys.forEach((e=>{t(this[e],e,this.entries)}),e)}removeByIdentifier(t){"string"===typeof t&&this.forEach(((e,i)=>{const n=e.findIndex((e=>e.identifier===t));-1!==n&&e.splice(n,1)}))}}const xa=br("Queue","error"),Sa=br("Queue","warning");let Ia=kr,La=Pr;class Oa{waitingToEnqueue=[];queues;blocked=!1;running=null;closure=null;stats=Object.seal({executed:0,fails:0,totalTimeMs:0,lastFrameTime:0});constructor(t){if("object"!==typeof t)throw new Error("Context is not a object");this.queues=new Ta([gr.HIGH,gr.MEDIUM,gr.LOW]),Object.seal(this)}get isIdle(){return!this.closure}next(t,e=Number.POSITIVE_INFINITY){let i,n;if(this.running||this.blocked)return;if(this.stats.totalTimeMs-this.stats.lastFrameTime>Cr)return this.lockUntilNextFrame(t,e);const s=this.queues.dequeue();return s&&(n=s.priority,i=s.job),!i&&this.waitingToEnqueue.length>0?(i=this.waitingToEnqueue.shift(),this.closure&&this.closure.variables.clear(),this.enqueue(i,gr.HIGH),Ia((()=>this.next(t)))):i&&"function"===typeof i.execute?(this.closure=this.closure||Ca.create(t),this.running=i,void Ia((async()=>{if(this.running!==i){const t=new Error("Out of sync");return xa("Job Error",[t,i])}let s=performance.now();try{const t=i.execute(this.closure,n);t instanceof Promise&&await t}catch(r){r instanceof mr||(this.queues.flush(),this.stats.fails++,xa("Job Error",[r,i]))}s=performance.now()-s,s>Cr&&Sa("Job executed exceeds frame time",[i,s]),this.running=null,this.stats.executed++,this.stats.totalTimeMs+=s,e>0&&this.next(t,--e)}))):(this.closure&&(this.closure.variables.clear(),this.closure=null),void(this.stats.lastFrameTime=this.stats.totalTimeMs))}enqueue(t,e=gr.HIGH){return!(!t||"function"!==typeof t.execute)&&this.queues.enqueue(t,e)}lazyEnqueue(t){return!(!t||"function"!==typeof t.execute)&&!!this.waitingToEnqueue.push(t)}clear(){this.queues.clear(),this.waitingToEnqueue.length=0}lockUntilNextFrame(t,e=Number.POSITIVE_INFINITY){this.blocked=!0,this.stats.lastFrameTime=this.stats.totalTimeMs,La((()=>{this.blocked=!1,this.next(t,e)}))}async setJobRunner(t){return"function"!==typeof t?Promise.reject(new Error("runJobFunc is a invalid function")):new Promise(((e,i)=>t((()=>{Ia=t,e()}))))}}class Aa{constructor(t){this.find=(...e)=>t.find.apply(t,e),this.schedule=(...e)=>t.schedule.apply(t,e),Object.freeze(this)}}const ka=br("Context","error");class Ra{mainUnit;base;manifest;history;variables;presetsData;presets;pistonUnits;jobQueue;static MAIN=Symbol("main");constructor(t){if(!Array.isArray(t)&&!Array.isArray(t.children))throw new Error("PistonUnit base is not a valid object");if(Object.prototype.hasOwnProperty.call(t,ta))throw new Error('The base object "'+this.base[ta]+'" is being used by another context.');let e,i;this.presets=[],this.presetsData={},this.history=new wa(this),this.pistonUnits=new da(this),this.jobQueue=new Oa(this),this.variables=new Map,Array.isArray(t)&&(e={game_id:0,release_id:0,children:t},i=t),Array.isArray(t.children)&&(e=t,i=t.children),this.base=i,this.manifest=e,Object.isExtensible(i)&&Object.defineProperty(i,ta,{value:ea(),writable:!1,configurable:!0}),Object.defineProperties(e,{id:{value:0,writable:!1,enumerable:!1},type:{value:Ra.MAIN,writable:!1,enumerable:!1}}),this.mainUnit=new ua(e,new Aa(this)),this.createUnits(i),$r.clearObjectPool(),Object.freeze(this),Object.seal(this.manifest),Object.freeze(this.mainUnit.tags),Object.freeze(this.mainUnit.properties),Object.freeze(this.mainUnit.rules)}loadPresetSetup(t){"object"===typeof t&&"function"===typeof t.performSetup&&"string"===typeof t.name&&(Object.isFrozen(t)||Object.freeze(t),"function"===typeof t.data&&Object.defineProperty(this.presetsData,t.name,{value:t.data(),writable:!1,configurable:!0}),-1===this.presets.findIndex((e=>e.name===t.name))&&this.presets.push(t),Pa(t,this.mainUnit,this),this.pistonUnits.forEach((e=>Pa(t,e,this))))}getPresetData(t){if("object"===typeof t&&"string"===typeof t.name&&(t=t.name),!Object.hasOwnProperty.call(this.presetsData,t))throw new TypeError("Preset data not found for "+t);return this.presetsData[t]}createUnits(t){Array.isArray(t)||(t=[t]);const e=new Aa(this);Nr(t,(t=>{if(t.tags=t.tags||[],t.children=t.children||[],Object.prototype.hasOwnProperty.call(t,ta))return;const i=new ua(t,e);this.pistonUnits.push(i),this.presets.forEach((t=>Pa(t,i,this)))}))}find(t){"object"===typeof t&&t&&(t=t.id);let e=this.pistonUnits.findById(t);return e||(this.mainUnit.id===t&&(e=this.mainUnit),e)}schedule(t,e=gr.HIGH){this.jobQueue.enqueue(t,e),this.jobQueue.next(this)}deleteUnit(t){if("object"===typeof t&&Object.prototype.hasOwnProperty.call(t.base,ta)){while(t.rules.length>0)t.rules.shift();for(const e in t.properties)delete t.properties[e];for(const e in t.actions)delete t.actions[e];this.pistonUnits.delete(t),delete t.base[ta]}}dispose(){return new Promise(((t,e)=>{this.variables.clear(),this.jobQueue.clear(),this.pistonUnits.forEach((t=>t.dispose())),delete this.base[ta],this.jobQueue.lazyEnqueue(new pa((()=>{this.history.clear(),this.jobQueue.clear(),t()}))),this.jobQueue.next(this)}))}}const Pa=(t,e,i)=>{try{t.checkIfItMatches(e)&&t.performSetup(e,i)}catch(n){ka(t.name,n)}};class Da{name="visible";type=Boolean;get(t){return t.visible}set(t,e){if(t.visible===!!e)return!1;t.visible=!!e}}const Ma=Object.freeze(new Da);var ja=Ma,Ba=Object.freeze({name:"Commons",checkIfItMatches(t){return t.base.type!==Ra.MAIN},performSetup(t,e){t.attachProperty(ja)}});class Fa{name="sort_id";type=Number;get(t){return t.sort_id}set(t,e){if(t.sort_id===e)return!1;t.sort_id=e}}const Ua=Object.freeze(new Fa);var Na=Ua;const Xa=10,Ha=10;var Va=Object.freeze({name:"Sorting",checkIfItMatches(t){return t.base.type!==Ra.MAIN},performSetup(t,e){if(t.attachProperty(Na),Object.hasOwnProperty.call(t.base,Na.name))return;const i=null!==t.parentId?e.find(t.parentId):e.mainUnit;Object.defineProperty(t.base,Na.name,{value:i.base.children.indexOf(t.base)*Ha+Xa,enumerable:!1,writable:!0})}});function Ga(t){if(0===t.base.children.length)return!1;if(t.parentId)return!1;const e=t.base.type;if(e&&"category"!==e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===Ya.FIXED));if(i)return!0;const n=-1!==t.tags.findIndex((t=>t.name===Ya.OPTIONAL));if(n)return!0;const s=-1!==t.tags.findIndex((t=>t.name===Ya.MIXED));return!!s}const Ya=Object.freeze({FIXED:"fixed",OPTIONAL:"optional",MIXED:"mixed",ICON:"icon"});class za{categoryId;chosenItemId;constructor(t,e){if("number"!==typeof t||"number"!==typeof e)throw new Error("Category or Pivot ID's is invalid");this.categoryId=t,this.chosenItemId=e}execute({context:t},e){const i=t.find(this.categoryId),n=i.base;if(0===n.children.length)return;const s=-1!==i.tags.findIndex((t=>t.name===Ya.FIXED)),r=-1!==i.tags.findIndex((t=>t.name===Ya.OPTIONAL)),a=-1!==i.tags.findIndex((t=>t.name===Ya.MIXED)),o=t.find(this.chosenItemId);if(!o)return;const l=o.get("visible"),h=[];return n.children.forEach((t=>{t!==o.base&&t.visible&&h.push(t.id)})),!l&&s&&0===h.length?o.set("visible",!0):l&&(s||r)?h.forEach((e=>{const i=t.find(e);i.set("visible",!1)})):h.length>1&&!a?(s&&h.shift(),h.forEach((e=>{const i=t.find(e);i.set("visible",!1)}))):void 0}get identifier(){return this.categoryId.toString()}}class Wa{name="CategoryMember";validate(t,e,i,n){if("visible"!==i)return;const s=t.find(e.parentId);if(!s)throw new Error("Category id "+e.parentId+" not found");t.schedule(new za(s.id,e.id),gr.MEDIUM)}}const $a=Object.freeze(new Wa);var qa=$a,Qa=Object.freeze({name:"Category",checkIfItMatches(t){return Ga(t)},performSetup(t,e){const i=-1!==t.tags.findIndex((t=>t.name===Ya.FIXED)),n=t.base;let s=0,r=null;if(n.children.forEach((t=>{const i=e.find(t.id);i.attachRule(qa);const n=i.get("visible");s+=n?1:0,!r&&n&&(r=i)})),i&&0===s&&n.children.length>0){const i=n.children[0];return r=e.find(i.id),r.set("visible",!0),t.invoke("randomize")}r&&e.schedule(new za(t.id,r.id),gr.MEDIUM)}});class Ja{pistonUnitId;constructor(t){if("number"!==typeof t)throw new TypeError("Invalid pistonUnitId. Expected a number.");this.pistonUnitId=t}execute({context:t,variables:e},i){const n=t.getPresetData(zl),s=t.find(this.pistonUnitId);if(!s)throw new Error(`Piston unit with id ${this.pistonUnitId} not found`);const{scopeName:r}=ua.getMetadataOf(s,zl.name);if(!r||!n.has(r))return;const a=t.find(s.parentId);if(!a||!a.get("visible")||!s.get("visible"))return;const{availableColors:o,membersIds:l}=n.get(r),h=s.get("active_color");o.has(h)&&l.forEach((e=>{const i=t.find(e);if(!i)throw new Error(`Member unit with id ${e} not found`);i.set("active_color",h)}))}get identifier(){return"SyncCG#"+this.pistonUnitId}}class Ka{name="EnableColorGlobal";validate(t,e,i,n){if("active_color"!==i&&"visible"!==i)return;if("boolean"===typeof n&&!n)return;const s=e.get("available_colors");("string"!==typeof n||s.includes(n))&&t.schedule(new Ja(e.id),gr.MEDIUM)}}const Za=Object.freeze(new Ka);var to=Za;function eo(t){const e=-1!==t.tags.findIndex((t=>t.name===no.COLORGLOBAL));if(!e)return!1;const i=Ga(t);return!!i}function io(t){const e=t.tags.find((t=>t.name===no.COLORLINK));return!!e&&(0!==e.value.length&&!!t.parentId)}const no=Object.freeze({COLORGLOBAL:"enable-color-global",COLORLINK:"color-link"});var so=/^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i;function ro(t){if(!t.parentId)return!1;const e=t.base.type;if(e&&"image-color"!==e)return!1;const i=so.test(t.base.name),n=0===t.base.children.length,s=0===t.tags.length;return!!(i&&n&&s)}function ao(t){if(!t.parentId)return!1;const e=t.base.type;if(e&&"color-picker"!==e)return!1;const i=0===t.base.children.length;if(i)return!1;const n=-1!==t.tags.findIndex((t=>t.name===Mo.COLORPIKER));if(!n)return!1;const s=-1===t.base.children.findIndex((t=>!so.test(t.name)));return!!s}class oo{name="active_color";type=String;get(t){const e=ua.getMetadataOf(t);let i=null;const n=t.children||{};for(let s=0;s<n.length;s++)if(n[s].visible){if(i)return null;i=n[s].name}return e.lastActiveColorName===i?i:null}set(t,e){const i=t.children||{},n=i.find((t=>t.name===e));if(!n)return!1;const s=ua.getMetadataOf(t);return s.lastActiveColorName=e,!1}}const lo=Object.freeze(new oo);var ho=lo;class co{name="available_colors";type=Array;get(t){const e=ua.getMetadataOf(t,Do.name);return e.availableColors||(e.availableColors=t.children.map((t=>t.name))),e.availableColors}set(t,e){return!1}}const uo=Object.freeze(new co);var fo=uo;class po{name="SetActiveColor";validate(t,e,i,n){if("active_color"!==i)return;if(!so.test(n))throw new Error("ImageColor name "+n+" is invalid");const s=e.base.children.find((t=>t.name===n));if(!s)return;const r=t.find(s.id);if(!r)throw new Error("ImageColor id "+s.id+" not found");r.set("visible",!0)}}const mo=Object.freeze(new po);var go=mo;class vo{colorPickerId;chosenColorItemId;constructor(t,e){if("number"!==typeof t||"number"!==typeof e)throw new Error("Category or Pivot ID's is invalid");this.colorPickerId=t,this.chosenColorItemId=e}execute({context:t},e){const i=t.find(this.colorPickerId),n=i.base.children;if(0===n.length)return;const s=t.find(this.chosenColorItemId);if(!s)return;const r=s.get("visible"),a=[];if(n.forEach((t=>{t!==s.base&&t.visible&&a.push(t.id)})),!r&&0===a.length)return s.set("visible",!0);r&&a.forEach((e=>{const i=t.find(e);i.set("visible",!1)}))}get identifier(){return this.colorPickerId.toString()}}class _o{name="ColorPickerMember";validate(t,e,i,n){if("visible"!==i)return;const s=t.find(e.parentId);if(!s)throw new Error("ImageColor id "+e.parentId+" not found");n&&s.set("active_color",e.base.name),t.schedule(new vo(s.id,e.id),gr.HIGH)}}const bo=Object.freeze(new _o);var yo=bo;function wo(t){if(!t.parentId)return!1;const e=t.base.type;if(e&&"color"!==e)return!1;const i=so.test(t.base.name),n=0===t.base.children.length,s=-1!==t.tags.findIndex((t=>t.name===Ro.COLOR));return!!(s&&n&&i)}class Eo{name="active_color";type=String;get(t){return t.visible?t.name:null}set(t,e){return!1}}const Co=Object.freeze(new Eo);var To=Co;class xo{name="available_colors";type=Array;get(t){const e=ua.getMetadataOf(t,ko.name);return e.availableColors||(e.availableColors=[t.name]),e.availableColors}set(t,e){return!1}}const So=Object.freeze(new xo);var Io=So;class Lo{name="SetActiveColor";validate(t,e,i,n){if("active_color"!==i)return;if(!so.test(n))throw new Error("ImageColor name "+n+" is invalid");const s=e.get("available_colors");s.includes(n)&&e.get("active_color")!==n&&e.set("visible",!0)}}const Oo=Object.freeze(new Lo);var Ao=Oo,ko=Object.freeze({name:"ColorPickerSingle",checkIfItMatches(t){return!!wo(t)},performSetup(t,e){t.attachRule(Ao),t.attachProperty(To),t.attachProperty(Io)}});const Ro=Object.freeze({COLOR:"color"}),Po=br("ColorPicker","DEBUG");var Do=Object.freeze({name:"ColorPicker",checkIfItMatches(t){return!!ro(t)||!!ao(t)},performSetup(t,e){if(ro(t))return!0;t.attachRule(go),t.attachProperty(ho),t.attachProperty(fo);let i=null;if(t.base.children.forEach((n=>{const s=e.find(n.id);if(!s)throw new Error("image-color item "+n.id+" isn't loaded!");if(s.tags.length>0&&(s.tags.length=0,Po("image-color item "+s.id+" tag's disposed!",s.base.tags)),!ro(s))throw new Error("image-color item "+s.id+" isn't valid!");n.visible&&(i&&i!==n&&(i=t.base.children[0]),i=i||n),ko.performSetup(s,e),s.attachRule(yo)})),!i)return t.set("active_color",t.base.children[0].name),t.invoke("randomize");t.set("active_color",i.name),e.schedule(new vo(t.id,i.id),gr.HIGH)}});const Mo=Object.freeze({COLORPIKER:"color-picker"});class jo{execute({context:t},e){const i=t.getPresetData(zl);i.forEach((({availableColors:e,membersIds:i})=>{i.forEach((i=>{const n=t.find(i),s=n.get("available_colors");Array.isArray(s)&&s.forEach((t=>{so.test(t)&&!e.has(t)&&e.add(t)}))}))}))}}function Bo(t){const e=t.tags.find((t=>t.name===qo.VISIBILITYLINK));return!!e&&(0!==e.value.length&&!!t.parentId)}const Fo=new Set(["visible"]);class Uo{name="PropertyLink";constructor(t){if(!Fo.has(t))throw new TypeError(`The property "${t}" is not available to link.`);this.propertyName=t}validate(t,e,i,n){this.propertyName===i&&t.schedule(new Ho(e,i),gr.MEDIUM)}}const No=Object.freeze(new Uo("visible"));var Xo=No;class Ho{propName;originUnitId;constructor(t,e){if(!t||"string"!==typeof e||"number"!==typeof t.id)throw new TypeError("Invalid arguments.");if(!Fo.has(e))throw new TypeError(`The property "${e}" is not available to link.`);const{linkName:i}=Vo(t);this.originUnitId=t.id,this.propName=e,Object.defineProperty(this,"identifier",{value:"SyncPropertyLink#"+i+"#"+this.propName,writable:!1})}execute({context:t,variables:e},i){const n=t.getPresetData(zo),s=t.find(this.originUnitId),r=Vo(s),a=s.get(this.propName),o=n.get(r.linkName);o.membersIds.forEach((e=>{if(s.id===e)return;const i=t.find(e),n=Vo(i),o=n.linkGroup===r.linkGroup,l=!!o&&a;(a||o)&&i.set(this.propName,l)}))}}function Vo(t){const e=ua.getMetadataOf(t,zo.name);if("string"!==typeof e.linkName)throw new TypeError(`Invalid metadata for piston unit: ${t.id}`);return e}const Go="invisible-"+Xr(),Yo="visible-"+Xr();var zo=Object.freeze({name:"PropertyLink",data(){return new Map},checkIfItMatches(t){return Bo(t)},performSetup(t,e){const i=t.tags.find((t=>t.name===qo.VISIBILITYLINK)),n=t.tags.find((t=>t.name===qo.VISIBILITYGROUP));if(!i)return;const s=Wo(i),r=Wo(n),a=t.base.visible?Yo:Go;this.performSetupForUnits(t,e,s,r||a)},performSetupForUnits(t,e,i,n=void 0){const s=e.getPresetData(this),r=$o(s,i);r.membersIds.push(t.id);const a=ua.getMetadataOf(t,this.name);a.linkName=r.linkName,a.linkGroup=n||"unnamed",t.attachRule(Xo),t.attachProperty(ja),Fo.forEach((i=>{e.schedule(new Ho(t,i),gr.MEDIUM)}))}});const Wo=t=>t&&t.value&&t.value.join("_"),$o=(t,e)=>e&&"string"===typeof e?(t.has(e)||t.set(e,Object.freeze({linkName:e,membersIds:[]})),t.get(e)):null,qo=Object.freeze({VISIBILITYLINK:"visibility-link",VISIBILITYGROUP:"visibility-group"});function Qo(t){if(0===t.base.children.length)return!1;if(!t.parentId)return!1;const e=t.base.type;if(e&&"dynamic"!==e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===kl.DYNAMIC));return!!i}class Jo{name="active_color";type=String;get(t){const e=ua.getMetadataOf(t);return e.activeColor}set(t,e){const i=ua.getMetadataOf(t);i.activeColor=e}}const Ko=Object.freeze(new Jo);var Zo=Ko;class tl{name="active_colors";type=Array;get(t){return t.children.map((t=>Zo.get(t))).filter((t=>"string"===typeof t))}set(t,e){return!1}}const el=Object.freeze(new tl);var il=el;const nl=Object.freeze([]);class sl{name="available_colors";type=Array;get(t){const e=ua.getMetadataOf(t);return e.paletteColors||nl}set(t,e){return!1}}const rl=Object.freeze(new sl);var al=rl,ol=/^#+([a-fA-F0-9]{8}|[a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i;class ll{name="DynamicPalette";validate(t,e,i,n){if("active_color"!==i)return;if(!ol.test(n))throw new Error("Palette id "+e.id+" color "+n+" is invalid #RGBA.");const s=t.find(e.parentId);if(!s)throw new Error("Dynamic unit with id "+e.parentId+" not found");const r=e.get("available_colors");if(!r.includes(n))throw new mr("Color "+n+" not available in palette item.")}}const hl=Object.freeze(new ll);var cl=hl;class ul{name="Dynamic";validate(t,e,i,n){if("active_colors"!==i)return;if(n.some((t=>!ol.test(t))))throw new Error("DynamicRule: item with id "+e.id+" has invalid rgba colors");const s=t.find(e.parentId);if(!s)throw new Error("DynamicRule: Unable to find parent unit with id "+e.parentId);const r=ua.getMetadataOf(e,"Dynamic");n.forEach(((e,i)=>{if(i>=r.paletteItemIds.length)return;const s=t.find(r.paletteItemIds[i]);if(!s)return;const a=s.get("available_colors");if(!a.includes(e))throw new Error("Color "+n+" not available in palette item.");s.set("active_color",e)}))}}const dl=Object.freeze(new ul);var fl=dl;function pl(t){if(0!==t.base.children.length)return!1;const e=t.base.type;if(e&&"palette"!==e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===kl.LOCALPALETTE));return!!i}class ml{name="visible";type=Boolean;get(t){return t.visible}set(t,e){if(e=!1,t.visible===e)return!1;t.visible=e}}const gl=Object.freeze(new ml);var vl=gl;function _l(t){const e=[];t.mainUnit.base.children.forEach((i=>{const n=t.find(i.id);if(n.tags.find((t=>t.name===kl.LOCALPALETTE)))return e.push(n);n.tags.find((t=>t.name===kl.LOCALPALETTES))&&i.children.forEach((i=>e.push(t.find(i.id))))}));const i=e.map((t=>{if(!pl(t))return null;const e=t.tags.find((t=>t.name===kl.COLORS));if(!e||0===e.value.length)return null;const i=t.tags.find((t=>t.name===kl.LOCALPALETTE));return i&&0!==i.value.length?(t.attachProperty(vl),t.set("visible",!1),Object.freeze({slug:i.value[0],type:"palette",values:e.value})):null}));return i.filter((t=>null!==t))}const bl=br("DynamicPreset","DEBUG");var yl=Object.freeze({name:"Dynamic",data(){return{palettes:new Map,gradients:new Map}},checkIfItMatches(t){return Qo(t)},performSetup(t,e){const i=e.getPresetData(this);0===i.palettes.size&&Cl(e,i);const n=ua.getMetadataOf(t,"Dynamic");n.paletteItemIds=[],t.attachProperty(il),t.attachRule(fl),t.base.children.forEach((t=>{const i=e.find(t.id);wl(i),Il(i)&&(El(i,e),n.paletteItemIds.push(t.id))}))}});function wl(t){const e=t.tags.find((t=>t.name===kl.REMOVABLE||t.name===qo.VISIBILITYLINK));e||t.get("visible")||t.set("visible",!0)}function El(t,e){t.attachProperty(Zo),t.attachProperty(al),t.attachRule(cl);const i=Al(e,t),n=ua.getMetadataOf(t);if(n.paletteColors=i,0===i.length)return;const s=t.tags.find((t=>t.name===kl.DEFAULTCOLOR)),r=s?s.value[0]:null,a=i.includes(r)?r:i[0];t.set("active_color",a)}function Cl(t,{palettes:e}){const i=[...Sl,..._l(t),...t.manifest.palettes||[]];i.forEach((t=>{if("palette"!==t.type)return;if(e.has(t.slug))return void bl(`Palette "${t.slug}" already exists.`);let i=t.values||[];"string"===typeof i&&(i=i.split("\n").map((t=>t.trim()))),i=i.filter((t=>ol.test(t))).map((t=>t.toLowerCase())),i=[...new Set(i)],0!==i.length?e.set(t.slug,i):bl(`Palette "${t.slug}" is empty.`)}))}const Tl=[{slug:"barbiecore",type:"palette",values:["#ffa7ef","#fa64de","#e025b7","#ac008b","#ffe5e7","#ffadb3","#ff6974","#ffb9d8","#ff7eb7","#ff388f","#efcb65","#9586e0","#a22fba","#93e086","#ffffff","#9fd0e6"]},{slug:"cottagecore",type:"palette",values:["#a6734c","#3c6b46","#e6dfd3","#884138","#7a232c","#e4f1f2","#d8c98d","#98b182","#cf7955","#515c38","#e098b6","#5c483d","#ecae8a","#c07073","#ecae8a","#c07073","#f2b04e"]},{slug:"darkmori",type:"palette",values:["#2d2829","#302c2a","#514545","#85807c","#562625","#30323f","#212d28","#1f1f1f","#272727","#303030","#17221f","#283331","#242527","#333639","#484d53"]},{slug:"goth",type:"palette",values:["#131313","#303030","#595959","#b4b4b4","#e0e0e0","#ffffff","#03197d","#2f005f","#5f0027","#9a1005","#5c0a80","#0e1c13","#131225","#1d122a","#121925"]},{slug:"scene",type:"palette",values:["#101010","#1c1c1c","#b7b7b7","#e6e6e6","#ff5ee7","#36d5b8","#e3bf46","#07334b","#097473","#45040c","#ba1127","#e96e20","#6e45e0","#9815cc"]},{slug:"basic",type:"palette",values:["#b41114","#db6d36","#f1d065","#6fa755","#55a791","#5495bb","#9456b0","#db83aa","#050404","#837e7e","#ffffff","#7d4430","#bda082"]},{slug:"skintones",type:"palette",values:["#f5e4de","#e8bda8","#c7967b","#a36848","#78482b","#533121"]}],xl=Tl.find((t=>"basic"===t.slug));Tl.push(Object.assign({},xl,{slug:"default"}));var Sl=Object.freeze(Tl);function Il(t){if(0!==t.base.children.length)return!1;if(!t.parentId)return!1;const e=t.base.type;if(e&&"image-dynamic"!==e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===kl.PALETTE));return!!i}const Ll=Object.freeze([]);function Ol(t,e){const{palettes:i}=t.getPresetData(yl),n=e||"default",s=i.get(n);return s||(i.get("default")||Ll)}function Al(t,e){const i=e.tags.find((t=>t.name===kl.PALETTE)),n=(i.value.length>0?i.value[0]:null)||"default";return Ol(t,n)}const kl=Object.freeze({DYNAMIC:"dynamic",PALETTE:"palette",LOCALPALETTE:"local-palette",LOCALPALETTES:"local-palettes",REMOVABLE:"removable",COLORS:"colors",DEFAULTCOLOR:"default-color"});function Rl(t){if(!t.parentId)return!1;const e=0===t.base.children.length;if(!e)return!1;const i=t.tags.find((t=>t.name===Gl.VISIBLEWHENCOLORIN));return!!i&&0!==i.value.length}class Pl{name="active_color";type=String;get(t){return null}set(t,e){return!1}}const Dl=Object.freeze(new Pl);var Ml=Dl;class jl{name="available_colors";type=Array;get(t){return[]}set(t,e){return!1}}const Bl=Object.freeze(new jl);var Fl=Bl;class Ul{name="VisibleWhenSetActiveColor";validate(t,e,i,n){if("active_color"!==i)return;const{visibleWhenColors:s}=ua.getMetadataOf(e),r=s.includes(n);e.set("visible",r)}}const Nl=Object.freeze(new Ul);var Xl=Nl,Hl=Object.freeze({name:"VisibleWhen",dependencies:["Dynamic","ColorGlobal"],checkIfItMatches(t){return Rl(t)},performSetup(t,e){t.attachRule(Xl),"object"!==typeof t.properties[Ml.name]&&t.attachProperty(Ml),"object"!==typeof t.properties[Fl.name]&&t.attachProperty(Fl);const i=Vl(e,t),n=ua.getMetadataOf(t);n.visibleWhenColors=i}});function Vl(t,e){const i=e.tags.find((t=>t.name===Gl.VISIBLEWHENCOLORIN)),n=(i.value.length>0?i.value[0]:null)||"default";return Ol(t,n)}const Gl=Object.freeze({VISIBLEWHENCOLORIN:"visible-when-color-in"}),Yl="color-link-"+Xr();var zl=Object.freeze({name:"ColorGlobal",data(){return new Map},checkIfItMatches(t){return eo(t)||io(t)},performSetup(t,e){return eo(t)?this.performSetupColorGlobalTaggedUnit(t,e):io(t)?this.performSetupColorLinkTaggedUnit(t,e):void 0},performSetupColorLinkTaggedUnit(t,e){const i=wo(t),n=ao(t),s=Il(t),r=Rl(t);if(!(i||s||n||r))return;e.schedule(new jo(t.id),gr.HIGH);const a=Kl(t),o=Yl;if(n)return t.base.children.forEach((t=>{const i=e.find(t.id);Ql(e,i,o,a)}));Ql(e,t,o,a)},performSetupColorGlobalTaggedUnit(t,e){const i=t.tags.find((t=>t.name===no.COLORGLOBAL)),n=i.value.join("_")||Xr(t.id);e.schedule(new jo(t.id),gr.HIGH),t.base.children.forEach((t=>{const i=e.find(t.id);if(!io(i))return Qo(i)?Wl(e,i,n):ao(i)?$l(e,i,n):wo(i)?ql(e,i,n):void 0}))}});function Wl(t,e,i){const n=e.base.children.map((e=>t.find(e.id))).filter((t=>Il(t)));n.forEach(((e,n,s)=>{const r=(s.length-n).toString();Ql(t,e,i,r)}))}function $l(t,e,i){e.base.children.forEach((e=>{const n=t.find(e.id);Ql(t,n,i)}))}function ql(t,e,i){return Ql(t,e,i)}function Ql(t,e,i,n="1"){const{scopeName:s,membersIds:r}=Jl(t,i,n),a=ua.getMetadataOf(e,"ColorGlobal");a.scopeName=s,r.add(e.id),e.attachRule(to),t.schedule(new Ja(e.id),gr.HIGH)}function Jl(t,e,i="1"){const n=t.getPresetData("ColorGlobal");if(i=i||"1",e=`${e}@${i}`,n.has(e))return n.get(e);const s=Object.freeze({scopeName:e,availableColors:new Set,membersIds:new Set});return n.set(e,s),s}function Kl(t,e="1"){const i=t.tags.find((t=>t.name===no.COLORLINK));return void 0===i||0===i.value.length?e:i.value[0].toString()}class Zl{name="forceActiveColor";invoke(t,e,i){if(!ol.test(i))throw new TypeError("Color "+i+" is invalid #RGBA.");this.updateColorGlobalPreset(t,e,i),this.updateAvailableColors(t,e,i),e.set("active_color",i)}updateAvailableColors(t,e,i){const n=e.get("available_colors");if(!n)return;if(n.includes(i))return;n.push(i);const s=new pa((()=>{const t=n.indexOf(i);-1!==t&&n.splice(t,1)}));t.schedule(s,gr.LOW)}updateColorGlobalPreset(t,e,i){const n=t.getPresetData(zl),{scopeName:s}=ua.getMetadataOf(e,zl.name);if(!s||!n.has(s))return;const{availableColors:r}=n.get(s);if(r.has(i))return;r.add(i);const a=new pa((()=>{r.delete(i)}));t.schedule(a,gr.LOW)}}const th=Object.freeze(new Zl);var eh=th,ih=Object.freeze({name:"GrandePalette",dependencies:["Dynamic","ColorGlobal"],checkIfItMatches(t){return Il(t)},performSetup(t,e){t.attachAction(eh)}});function nh(t){const e=t.tags.find((t=>t.name===rh.USEICON));return!!e&&(1===e.value.length&&"none"===e.value[0])}function sh(t){const e=t.tags.find((t=>t.name===rh.USEICON));return!!e&&1===e.value.length}const rh=Object.freeze({ICONSET:"icon-set",USEICON:"use-icon"});function ah(t){if(0===t.base.children.length)return!1;if(t.parentId)return!1;const e=t.tags.find((t=>t.name===rh.ICONSET));if(!e)return!1;if(1!==e.value.length)return!1;const i=e.value[0];return"string"===typeof i&&0!==i.length}class oh{name="icon";type=String;get(t){const e=ua.getMetadataOf(t);return e.icon?e.icon:t.image||null}set(t,e){const i=ua.getMetadataOf(t);return i.icon=e,!1}}const lh=Object.freeze(new oh);var hh=lh;class ch{pistonUnitId;constructor(t){if("object"===typeof t&&t.id&&(t=t.id),!t)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),Object.defineProperty(this,"identifier",{value:"SyncIcon#"+this.pistonUnitId.toString(),writable:!1})}execute({context:t,variables:e},i){const n=t.find(this.pistonUnitId);if(!n)return;const s=ua.getMetadataOf(n,uh.name);if("string"!==typeof s.name)return;const r=t.getPresetData(uh);if(!Array.isArray(r[s.name]))return;const a=so.test(n.base.name),o=0===n.base.children.length;if(a&&o){const t=n.base.name;s.index=r[s.name].findIndex((e=>e.name===t))}const l=r[s.name][s.index];"object"===typeof l&&n.set("icon",l.image)}}var uh=Object.freeze({name:"IconSet",data(){return Object.create(null)},checkIfItMatches(t){return ah(t)||sh(t)},performSetup(t,e){if(sh(t))return dh(t,e);fh(t,e)}});function dh(t,e){const i=t.tags.find((t=>t.name===rh.USEICON)),n=i.value[0];if("none"===n)return;if(ao(t)||Ga(t))return t.base.children.forEach((t=>{const n=e.find(t);n.tags.push(i),dh(n,e),n.tags.pop()}));const s=e.find(t.parentId);if(!s)return;const r=ua.getMetadataOf(t,"IconSet");r.name=n,r.index=s.base.children.indexOf(t.base),t.attachProperty(hh),e.schedule(new ch(t),gr.MEDIUM)}function fh(t,e){const i=t.tags.find((t=>t.name===rh.ICONSET)),n=i.value[0],s=e.getPresetData("IconSet");s[n]=t.base.children,ph(t),t.base.children.forEach((t=>{const i=e.find(t.id);i&&ph(i)}))}function ph(t){t.attachProperty(vl),t.get("visible")&&t.set("visible",!1)}const mh=Object.freeze({RANDOM:"random",RANDOMCHILD:"random-c",RANDOMMAX:"random-max",RANDOMMIN:"random-min"});class gh{name="randomize";invoke(t,e,i){const n=t.getPresetData(kh),{dice:s}=n,r=1/(e.base.children.length+1);let a=e.base.children.length,o=0,l=0;const h=this.getTag(e,mh.RANDOMMAX);if(h){const t=parseInt(h.value[0]);a=t>a||t<o?a:t}const c=this.getTag(e,mh.RANDOMMIN);if(c){const t=parseInt(c.value[0]);o=t>a||t<o?o:t}const u=!!this.getTag(e,Ya.OPTIONAL),d=!!this.getTag(e,Ya.FIXED),f=!!this.getTag(e,Ya.MIXED),p=u||d||f;u&&(o=o>0?1:0,a=1);const m=this.getTag(e,Mo.COLORPIKER),g=!p&&!!m;if(g&&"hidden"===m.value[0])return;(d||g)&&(o=1,a=1);const v=s.roll(),_=o>0||v<=this.getChanceToBeVisible(e);_||(a=0,o=0);const b=e.base.children.map((e=>{const i=t.find(e.id);return{pistonUnit:i,individualChance:this.getChanceToBeVisible(i,r)}})),y=b.length;let w=0,E=y;while(l<o&&E-- >0){const t=s.roll();0===w&&b.forEach((({individualChance:t})=>{w+=t}));const e=t*w;let i=0;const n=b.find((({individualChance:t})=>(i+=t,e<=i)));n.pistonUnit.set("visible",!0),n.pistonUnit.invoke(this.name),w-=n.individualChance,b.splice(b.indexOf(n),1),l++}return b.forEach((t=>{if(a<=l)return t.pistonUnit.set("visible",!1);const e=s.roll(),i=e<=t.individualChance;if(!i)return t.pistonUnit.set("visible",!1);t.pistonUnit.set("visible",!0),t.pistonUnit.invoke(this.name),l++})),l}getTag(t,e){return t.tags.find((t=>t.name===e))}getChanceToBeVisible(t,e=.5){const i=this.getTag(t,mh.RANDOM);return i?parseFloat(i.value[0]):e}}const vh=Object.freeze(new gh);var _h=vh;class bh{name="randomize";invoke(t,e,i){const n=[];return e.base.children.forEach((e=>{const s=t.find(e);s&&Ga(s)&&t.schedule(new pa((()=>{s.invoke(this.name,i).then((t=>n.push(t)))})),gr.LOW)})),n}}const yh=Object.freeze(new bh);var wh=yh;class Eh{name="randomize";invoke(t,e,i){const n=t.getPresetData(kh),{dice:s}=n,r=Al(t,e),a=s.roll(),o=Math.floor(r.length*a*.9998);return e.set("active_color",r[o]),r.length}}const Ch=Object.freeze(new Eh);var Th=Ch;class xh{name="randomize";invoke(t,e,i){return e.base.children.forEach((e=>{const n=t.find(e);n&&n.invoke(this.name,i)})),e.base.children.length}}const Sh=Object.freeze(new xh);var Ih=Sh;function Lh(t,e=0){t^=3735928559,e=e?3084996962^e:3084996962;let[i,n,s,r]=[2654435769,608135816,e,t];return function(){i>>>=0,n>>>=0,s>>>=0,r>>>=0;let t=i+n|0;return i=n^n>>>9,n=s+(s<<3)|0,s=s<<21|s>>>11,r=r+1|0,t=t+r|0,s=s+t|0,(t>>>0)/4294967296}}const Oh=()=>Math.floor(parseInt((new Date).toJSON().split("T")[0].replace(/[-]/g,""))+4261412864*Math.random()),Ah=Rh(0);var kh=Object.freeze({name:"Randomizer",data(){const t=Ah.seed?Ah.seed:Oh();return{dice:Rh(t)}},checkIfItMatches(t){if(t.base.type===Ra.MAIN)return!0;const e=nh(t);if(e)return!1;const i=ao(t);if(i)return!0;const n=Ga(t);if(n)return!0;const s=Il(t);if(s)return!0;const r=Qo(t);return!!r},performSetup(t,e){if(t.base.type===Ra.MAIN)return void t.attachAction(wh);if(Il(t))return void t.attachAction(Th);if(Qo(t))return void t.attachAction(Ih);t.attachAction(_h);const i=Ga(t);if(!i)return;const n=t.tags.find((t=>t.name===mh.RANDOMCHILD));n&&t.base.children.forEach((t=>{const i=e.find(t.id),s=-1!==i.tags.findIndex((t=>t.name===mh.RANDOM));if(n&&!s){const t=$r.create(mh.RANDOM+":"+n.value[0]);i.tags.push(t)}}))}});function Rh(t){return Object.seal({seed:t,roll:Lh(t)})}function Ph(t){const e=-1!==t.tags.findIndex((t=>t.name===Dh.REF)),i=-1!==t.tags.findIndex((t=>t.name===Dh.MIRROR));if(!e&&!i)return!1;if(!t.parentId&&e)return!1;if(wo(t))return!0;if(ao(t))return!0;if(Qo(t))return!0;const n=t.base.type;return!(!n||"image"!==n)}const Dh=Object.freeze({REF:"ref",MIRROR:"mirror"});class Mh{name="x";type=Number;get(t){return t.x}set(t,e){if(t.x===e)return!1;t.x=Number.parseFloat(e)}}const jh=Object.freeze(new Mh);var Bh=jh;class Fh{name="y";type=Number;get(t){return t.y}set(t,e){if(t.y===e)return!1;t.y=Number.parseFloat(e)}}const Uh=Object.freeze(new Fh);var Nh=Uh;class Xh{propName;propValue;refUnitId;constructor(t,e,i){if("string"!==typeof e||"number"!==typeof t.id)throw new TypeError("invalid params");this.refUnitId=t.id,this.propName=e,this.propValue=i,"x"!==e&&"y"!==e||(this.propValue=i-t.get(e)),Object.defineProperty(this,"identifier",{value:"SyncMirrors#"+this.refUnitId+"-"+this.propName,writable:!1})}execute({context:t,variables:e},i){const n=t.getPresetData(zh),s=t.find(this.refUnitId),r=ua.getMetadataOf(s);"number"!==typeof r.scopeIndex||n.length<=r.scopeIndex||n[r.scopeIndex].mirrors.forEach((e=>{const i=t.find(e);this.propagateChangesToMirrorUnit(s,i,this.propName,this.propValue)}))}propagateChangesToMirrorUnit(t,e,i,n){"x"!==i&&"y"!==i||(n=e.get(i)+n),e.set(i,n)}}const Hh=new Set(["visible","x","y","active_color"]);class Vh{name="Ref";validate(t,e,i,n){Hh.has(i)&&t.schedule(new Xh(e,i,n),gr.MEDIUM)}}const Gh=Object.freeze(new Vh);var Yh=Gh,zh=Object.freeze({name:"RefMirror",data(){return[]},checkIfItMatches(t){return Ph(t)},performSetup(t,e){const i=Qo(t),n=t.tags.find((t=>t.name===Dh.REF));if(n){const s=Wh(n);if(this.performSetupForRefUnits(t,e,s),!i)return;return t.base.children.forEach(((t,i)=>{const s=e.find(t.id),r=Wh(n,i.toString());this.performSetupForRefUnits(s,e,r)}))}const s=t.tags.find((t=>t.name===Dh.MIRROR));if(s){const n=Wh(s);if(this.performSetupForMirrorUnits(t,e,n),!i)return;return t.base.children.forEach(((t,i)=>{const n=e.find(t.id),r=Wh(s,i.toString());this.performSetupForMirrorUnits(n,e,r)}))}},performSetupForRefUnits(t,e,i){const n=e.getPresetData(this),s=$h(n,i);if(-1===s)return;const r=ua.getMetadataOf(t);r.scopeIndex=s,t.attachProperty(ja),t.attachProperty(Bh),t.attachProperty(Nh),t.attachRule(Yh),Hh.forEach((i=>{e.schedule(new Xh(t,i,t.get(i)),gr.MEDIUM)}))},performSetupForMirrorUnits(t,e,i){const n=e.getPresetData(this),s=$h(n,i);if(-1===s)return;const r=ua.getMetadataOf(t);r.scopeIndex=s,t.attachProperty(ja),t.attachProperty(Bh),t.attachProperty(Nh),n[s].mirrors.push(t.id)}});const Wh=(t,e=null)=>{const i=t.value.join("_");return e?`${i}@${e}`:i},$h=(t,e)=>{if(!e||"string"!==typeof e)return-1;const i=t.findIndex((t=>t.scopeName===e));return-1!==i?i:(t.push({scopeName:e,mirrors:[]}),t.length-1)};class qh{name="visible";type=Boolean;get(t){return t.visible}set(t,e){if(e=!0,t.visible===e)return!1;t.visible=!!e}}const Qh=Object.freeze(new qh);var Jh=Qh,Kh=Object.freeze({name:"RootItemsPreset",checkIfItMatches(t){return t.base.type!==Ra.MAIN&&(!t.parentId&&!Ph(t))},performSetup(t,e){t.attachProperty(Jh),t.get("visible")||t.set("visible",!0)}}),Zh=Object.freeze({name:"SimpleLayer",checkIfItMatches(t){if(t.parentId)return!1;const e=t.base.type;if(e&&"simple-layer"!==e)return!1;const i=0===t.base.children.length;if(i)return!1;const n=0!==t.tags.length;return!n},performSetup(t,e){}});function tc(t){if(0===t.base.children.length)return!1;if(t.parentId)return!1;const e=t.tags.length>1;if(e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===ic.STAMPS));return!!i}function ec(t){if(0!==t.base.children.length)return!1;if(null===t.parentId)return!1;const e=t.tags.length>1;if(e)return!1;const i=-1!==t.tags.findIndex((t=>t.name===ic.STAMP_ITEM)),n="number"===typeof t.base.source_id;return!(!i||!n)}const ic=Object.freeze({STAMPS:"stamps",STAMPS_SLOT:"stamp-slot",STAMP_ITEM:"stamp-item"}),nc=br("CreateNode","error");class sc{pistonUnitId;childIndex=-1;dataJsonObjectSerialized;createdAt=performance.now();constructor(t,e=0){if("object"!==typeof t)throw new TypeError("Invalid unitJsonBaseObject param");if("object"===typeof t.children&&t.children.length>0)throw new TypeError("dataJsonObject.children need to be a empty array");t.id||(t.id=la.generate()),this.pistonUnitId=t.id,this.dataJsonObjectSerialized=qr.that(t)}commit(t){if(t.find(this.pistonUnitId))return 1;const e=this.dataJsonObjectSerialized.clone();t.createUnits(e);const i=t.find(e);if(!i)return nc("Created piston unit not found. Unknown error."),2;const n=ac(t,i);if(!n)return nc("parentId not found. Item cant bem added"),3;const s=n.findIndex((t=>t.id===i.id));-1===s&&(-1===this.childIndex?this.childIndex=n.push(i.base):n.splice(this.childIndex,0,i.base)),rc(t,i,jr.CREATED)}revert(t){const e=t.find(this.pistonUnitId);if(!e)return 1;if(e.base.children.length>0)return nc("Cant revert nodes without empty children"),2;if(t.deleteUnit(e),t.find(this.pistonUnitId))return nc("Deleted piston unit found. Unknown error."),3;const i=ac(t,e);if(!i)return nc("parentId not found. Item cant bem added"),3;this.childIndex=i.findIndex((t=>t.id===e.id)),-1!==this.childIndex&&i.splice(this.childIndex,1),rc(t,e,jr.DESTROYED)}}const rc=(t,e,i)=>{t.schedule(new Qr(e,i),gr.LOW);const n=t.find(e.parentId);n&&t.schedule(new Qr(n,jr.CHILDREN_LENGTH_CHANGE),gr.LOW)},ac=(t,e)=>{if(null===e.parentId)return t.base;const i=t.find(e.parentId);return i?i.base.children:null};class oc{dataJsonNodeObject;constructor(t){if("object"!==typeof t)throw new TypeError("Invalid dataJsonObject param");this.dataJsonNodeObject=t}execute({context:t},e){Ur(this.dataJsonNodeObject,(e=>{const i=Object.assign({},e,{children:[]}),n=new sc(i);return t.history.pushAndCommitState(n)}))}}var lc=Object.freeze({name:"Image",checkIfItMatches(t){return!1},performSetup(t,e){}});const hc=Object.freeze({IMAGE:"image"});class cc{name="stamp-it";invoke(t,e,i){if("object"!==typeof i)throw new Error("Invalid payload object");const n=t.find(i.id);if(!n)throw new Error("Stamp source not found");if(n.base.type!==hc.IMAGE&&n.base.type!==Mo.COLORPIKER)throw new Error("Only stamp image item can be stamped");const s=i.sortId||la.generate();if(t.find(s))throw new Error("Stamp id item already found");la.updateLastGeneratedId(s);const r=Object.assign({},n.base,{id:s,type:ic.STAMP_ITEM,parent_id:e.id,source_id:n.id,visible:!0,x:i.x||0,y:i.y||0,scale_x:i.scaleX||1,scale_y:i.scaleY||1,rotation:i.rotation||0,children:[],tags:[ic.STAMP_ITEM]});return t.schedule(new oc(r)),r.id}}const uc=Object.freeze(new cc);var dc=uc;const fc=br("CreateNode","error");class pc{pistonUnitId;childIndex=-1;dataJsonObjectSerialized;createdAt=performance.now();constructor(t,e=0){if("object"!==typeof t)throw new TypeError("Invalid unitJsonBaseObject param");if("object"===typeof t.children&&t.children.length>0)throw new TypeError("dataJsonObject.children need to be a empty array");if(!t.id)throw new TypeError("dataJsonObject.id cant be null");this.pistonUnitId=t.id,this.dataJsonObjectSerialized=qr.that(t)}commit(t){const e=t.find(this.pistonUnitId);if(!e)return 1;if(e.base.children.length>0)return fc("Cant revert nodes without empty children"),2;if(t.deleteUnit(e),t.find(this.pistonUnitId))return fc("Deleted piston unit found. Unknown error."),3;const i=ac(t,e);if(!i)return fc("parentId not found. Item cant bem added"),3;this.childIndex=i.findIndex((t=>t.id===e.id)),-1!==this.childIndex&&i.splice(this.childIndex,1),rc(t,e,jr.DESTROYED)}revert(t){if(t.find(this.pistonUnitId))return 1;const e=this.dataJsonObjectSerialized.clone();t.createUnits(e);const i=t.find(e);if(!i)return fc("Created piston unit not found. Unknown error."),2;const n=ac(t,i);if(!n)return fc("parentId not found. Item cant bem added"),3;const s=n.findIndex((t=>t.id===i.id));-1===s&&(-1===this.childIndex?this.childIndex=n.push(i.base):n.splice(this.childIndex,0,i.base)),rc(t,i,jr.CREATED)}}class mc{pistonUnitId;attemptCount;constructor(t,e=0){if("object"===typeof t&&t.id&&(t=t.id),!t)throw new Error("Incorrect input params");this.pistonUnitId=parseInt(t),this.attemptCount=parseInt(e)||0}execute({context:t},e){const i=t.find(this.pistonUnitId);if(!i)return;const n=0===i.base.children.length;if(!n&&0===this.attemptCount)return void this.recursiveDeleteUnit(t,i,1);if(!n)return;const s=new pc(i.base);return t.history.pushAndCommitState(s)}recursiveDeleteUnit(t,e,i=0){"object"===typeof e&&(e.base.children.forEach((({id:e})=>{const i=t.find(e);"object"===typeof i&&this.recursiveDeleteUnit(t,i)})),t.schedule(new mc(e.id,i)))}}class gc{name="remove-stamp";invoke(t,e,i){if("object"!==typeof i)throw new Error("Invalid payload object");const n=t.find(i.id);if(!n)throw new Error("Stamp item not found");if(!ec(n))throw new Error("Only stamp item can be removed");if(n.parentId!==e.id)throw new Error("Invalid stamp item id");return t.schedule(new mc(n)),n.id}}const vc=Object.freeze(new gc);var _c=vc;class bc{name="scale_x";type=Number;get(t){return t[this.name]}set(t,e){if(t[this.name]===e)return!1;t[this.name]=Number.parseFloat(e)}}const yc=Object.freeze(new bc);var wc=yc;class Ec{name="scale_y";type=Number;get(t){return t[this.name]}set(t,e){if(t[this.name]===e)return!1;t[this.name]=Number.parseFloat(e)}}const Cc=Object.freeze(new Ec);var Tc=Cc;class xc{name="rotation";type=Number;get(t){return t[this.name]}set(t,e){if(t[this.name]===e)return!1;t[this.name]=Number.parseFloat(e)}}const Sc=Object.freeze(new xc);var Ic=Sc,Lc=Object.freeze({name:"Stamps",data(){return{availableSlots:[]}},checkIfItMatches(t){const e=ec(t);if(e)return!0;const i=tc(t);return!!i},performSetup(t,e){const{availableSlots:i}=e.getPresetData(this);if(0===i.length){const t=this.createStampSlot(e);i.push(t)}if(ec(t))return this.setupStampItem(t,e);tc(t)&&(this.keepInvisible(t),t.base.children.forEach((t=>{const i=e.find(t.id);i&&this.keepInvisible(i)})))},keepInvisible(t,e){t.attachProperty(vl),t.get("visible")&&t.set("visible",!1)},setupStampItem(t,e){t.attachProperty(Bh),t.attachProperty(Nh),t.attachProperty(wc),t.attachProperty(Tc),t.attachProperty(Ic)},createStampSlot(t){const e={id:null,parent_id:null,sort_id:0,type:ic.STAMPS_SLOT,tags:[ic.STAMPS_SLOT],x:0,y:0,children:[],visible:!0};t.base.push(e),t.createUnits(e);const i=t.find(e);if(!i)throw new Error("StampsPreset: slot unit not found or not created");return i.attachProperty(Jh),i.attachAction(dc),i.attachAction(_c),i}});function Oc(t){const e=t.tags.find((t=>t.name===Ac.MOVE));return!!e&&(!(e.value.length<4||e.value.length>5)&&-1===e.value.findIndex((t=>isNaN(parseInt(t)))))}const Ac=Object.freeze({MOVE:"move"});class kc{name="initialX";type=Number;initialValueOfProperty="x";get(t){return ua.getMetadataOf(t,Gc.name)[this.name]}set(t,e){return!1}setupMetadata(t){const e=ua.getMetadataOf(t,Gc.name);Object.hasOwnProperty.call(e,this.name)||Object.defineProperty(e,this.name,{value:t[this.initialValueOfProperty],writable:!1})}}const Rc=Object.freeze(new kc);var Pc=Rc;class Dc{name="initialY";type=Number;initialValueOfProperty="y";get(t){return ua.getMetadataOf(t,Gc.name)[this.name]}set(t,e){return!1}setupMetadata(t){const e=ua.getMetadataOf(t,Gc.name);Object.hasOwnProperty.call(e,this.name)||Object.defineProperty(e,this.name,{value:t[this.initialValueOfProperty],writable:!1})}}const Mc=Object.freeze(new Dc);var jc=Mc;const Bc=new TypeError("Position x or y out of bounds.");class Fc{name="LimitOfMovePosition";validate(t,e,i,n){if("x"!==i&&"y"!==i)return;const s=ua.getMetadataOf(e,Gc.name);return"x"===i?this.validateLeftAndRight(s.bounds,n):"y"===i?this.validateUpAndDown(s.bounds,n):void 0}validateLeftAndRight(t,e){if(e<t.left||e>t.right)throw Bc}validateUpAndDown(t,e){if(e<t.down||e>t.up)throw Bc}setupMetadata(t){const e=ua.getMetadataOf(t,Gc.name);if(Object.hasOwnProperty.call(e,"bounds"))return;const i=t.tags.find((t=>t.name===Ac.MOVE));if(!i)return;const[n,s,r,a,o=1]=i.value.map((t=>Math.abs(parseInt(t)||0)));Object.defineProperty(e,"bounds",{value:Object.freeze({up:t.base.y+n,down:t.base.y-r,right:t.base.x+s,left:t.base.x-a,step:o}),writable:!1})}}const Uc=Object.freeze(new Fc);var Nc=Uc;class Xc{name="move";invoke(t,e,i){const n=i,s=ua.getMetadataOf(e,Gc.name);if(!Object.hasOwnProperty.call(s,"bounds"))return;const{step:r}=s.bounds;r&&("up"!==n?"right"!==n?"down"!==n?"left"!==n?(e.set("x",e.get("initialX")),e.set("y",e.get("initialY"))):e.set("x",e.base.x-r):e.set("y",e.base.y+r):e.set("x",e.base.x+r):e.set("y",e.base.y-r))}}const Hc=Object.freeze(new Xc);var Vc=Hc,Gc=Object.freeze({name:"Transform",checkIfItMatches(t){if(!Oc(t))return!1;const e=t.base.type;return!(!e||"image"!==e)||(!!ao(t)||(!!wo(t)||!!Qo(t)))},performSetup(t,e){t.attachAction("move",Vc),t.attachProperty(Bh),t.attachProperty(Nh),t.attachProperty(Pc),t.attachProperty(jc),Pc.setupMetadata(t.base),jc.setupMetadata(t.base),t.attachRule(Nc),Nc.setupMetadata(t)}});i(3269);const Yc=2,zc=4,Wc=6;class $c{type=null;data=null;typeCode=null;parent=null;constructor(t){"number"===typeof t&&(this.typeCode=t?parseInt(t):null),"object"===typeof t&&t&&(this.type=t,this.typeCode=parseInt(this.type.code),this.data=this.type.createDataInstance());let e=null;Object.defineProperty(this,"parent",{get:()=>e,set:t=>{if("object"!==typeof t||!t)throw new TypeError("Invalid DataSet object");e=t,this.typeCode&&!this.data&&qc(this,this.typeCode)},configurable:!1,enumerable:!1}),Object.seal(this)}get byteLength(){if(!this.data)throw new TypeError("item not read yet");return this.headerLength+this.data.byteLength}get headerLength(){if(!this.data)throw new TypeError("item not read yet");return this.data.byteLength<254?Yc:this.data.byteLength<=65535?zc:Wc}read(t,e=0){e=parseInt(e||0);let i=new DataView(t,e,Yc);const n=i.getUint8(0),s=i.getUint8(1);let r;switch(s){case 255:i=new DataView(t,e,zc),r=i.getUint16(2);break;case 254:i=new DataView(t,e,Wc),r=i.getUint32(2);break;default:r=s}qc(this,n);const a=new DataView(t,e+i.byteLength,r);this.data.unserialize(a)}write(t,e=0){if(!this.data)throw new TypeError("The item has empty data to write");e=parseInt(e||0);const i=new DataView(t,e,this.headerLength),n=this.data.byteLength;switch(i.setUint8(0,this.typeCode),this.headerLength){case zc:i.setUint8(1,255),i.setUint16(2,n);break;case Wc:i.setUint8(1,254),i.setUint32(2,n);break;default:i.setUint8(1,n)}const s=new DataView(t,e+this.headerLength,n);this.data.serialize(s)}static createInstance(t,e=null){if("object"!==typeof t||!t||!t.code)throw new TypeError("The item has empty data to write");const i=new $c(t);if("object"===typeof e&&e)for(const n in i.data)Object.hasOwnProperty.call(i.data,n)&&"undefined"!==typeof e[n]&&(i.data[n]=e[n]);return i}}function qc(t,e){if(!t.parent)throw new TypeError("Item must belong to a DataSet before can setup `data` property");if(!t.parent.availableTypes.has(e))throw new TypeError("Invalid typeCode from current array buffer");t.typeCode=parseInt(e),t.type=t.parent.availableTypes.get(t.typeCode),t.data=t.type.createDataInstance()}const Qc=Symbol("@class");class Jc{name=null;code=null;constructor(t,e,i){if("function"!==typeof i)throw new TypeError("Invalid objectDataClass param");if(!t||!e)throw new TypeError("Invalid params");this.code=parseInt(t)||null,this.name=e||null,Object.defineProperty(this,Qc,{value:i,enumerable:!1}),Object.freeze(this)}createDataInstance(){const t=this[Qc];return t?Object.seal(new t):null}}const Kc=function(){const t=[];for(const e in this)"number"===typeof this[e].code&&t.push(this[e]);return t},Zc=function(){const t=new Map;for(const e in this)"number"===typeof this[e].code&&t.set(this[e].code,this[e]);return t},tu=t=>new Promise(((e,i)=>{if(!("XMLHttpRequest"in window))return i(new Error("XMLHttpRequest not supported!"));const n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{const t=new Uint8Array(n.response||n.mozResponseArrayBuffer);return e(t.buffer)},n.onerror=i,n.send(null)})),eu=t=>new Promise(((e,i)=>{const n=new FileReader;return n.onload=t=>e(t.target.result),n.onerror=i,n.readAsArrayBuffer(t)}));function iu(t,e,i,n=255){const s=(t,e=2)=>t.toString(16).padStart(e,"0").toLowerCase(),r=s(t),a=s(e),o=s(i),l=s(n),h=`#${r}${a}${o}`,c=255!==n?`${h}${l}`:h;return c}function nu(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i,i=t.trim().toLowerCase(),n=e.exec(i);if(!n)return null;const[,s,r,a,o]=n,l={r:parseInt(s,16),g:parseInt(r,16),b:parseInt(a,16),a:o?parseInt(o,16):255};return l}const su=4;class ru{values=[];get[Symbol.iterator](){return this.values[Symbol.iterator]()}get size(){return this.values.length}get byteLength(){return this.values.length*su}add(t){if(null===nu(t))throw new TypeError('ColorsDict only accepts strings like "#RRGGBB" or "#RRGGBBAA".');t=t.toLowerCase();const e=this.values.indexOf(t);return-1!==e?e:this.values.push(t)-1}clear(){return this.values.length=0,this}get(t){return this.values[t]}serialize(t){const e=this.size;for(let i=0;i<e;i++){const e=nu(this.get(i));if(null===e)throw new TypeError(`Invalid color format: ${this.get(i)} at index ${i}`);t.setUint8(su*i,e.r),t.setUint8(su*i+1,e.g),t.setUint8(su*i+2,e.b),t.setUint8(su*i+3,e.a)}}unserialize(t){const e=t.byteLength/su;for(let i=0;i<e;i++){const e=t.getUint8(su*i),n=t.getUint8(su*i+1),s=t.getUint8(su*i+2),r=t.getUint8(su*i+3);this.add(iu(e,n,s,r))}}}const au=Object.freeze({COLORS:new Jc(16,"colors",ru),of:ou,toArray:Kc,toMap:Zc});function ou(t){if(!t.dictionaries)throw new Error("File does not have dictionaries");0===t.dictionaries.length&&au.toArray().forEach((e=>{const i=$c.createInstance(e);t.dictionaries.push(i)}));const e=Object.create(null);return t.dictionaries.forEach((t=>{e[t.type.name]=t.data})),Object.freeze(e),e}var lu=au;class hu{static COMPRESS_FACTOR=.01;static DECOMPRESS_FACTOR=1/hu.COMPRESS_FACTOR;static compress(t){const e=Math.ceil(t*hu.COMPRESS_FACTOR);return e}static decompress(t){const e=Math.floor(t*hu.DECOMPRESS_FACTOR);return e}}var cu=hu;class uu{deltaTime=0;id=0;deltaColorRGB=[0,0,0];undoColor(t){return[(256-this.deltaColorRGB[0]+t[0])%256,(256-this.deltaColorRGB[1]+t[1])%256,(256-this.deltaColorRGB[2]+t[2])%256]}updateDeltaColor(t,e){this.deltaColorRGB=[(256-t[0]+e[0])%256,(256-t[1]+e[1])%256,(256-t[2]+e[2])%256]}redoColor(t){return[(this.deltaColorRGB[0]+t[0])%256,(this.deltaColorRGB[1]+t[1])%256,(this.deltaColorRGB[2]+t[2])%256]}get byteLength(){return 10}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setUint8(7,this.deltaColorRGB[0]),t.setUint8(8,this.deltaColorRGB[1]),t.setUint8(9,this.deltaColorRGB[2])}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.deltaColorRGB=[t.getUint8(7),t.getUint8(8),t.getUint8(9)]}}var du=uu;class fu{deltaTime=0;id=0;colorIndex=0;get byteLength(){return 9}serialize(t){if(this.colorIndex<0)throw new TypeError("Invalid activeColorIndex");t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setUint16(7,this.colorIndex)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.colorIndex=t.getUint16(7)}}var pu=fu;class mu{deltaTime=0;id=0;get byteLength(){return 7}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2)}}class gu{deltaTime=0;id=0;deltaX=0;deltaY=0;deltaAngle=0;deltaScaleX=0;deltaScaleY=0;get byteLength(){let t=11;return 0!==this.deltaAngle&&(t+=4),0===this.deltaScaleX&&0===this.deltaScaleY||(t+=8),t}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setInt16(7,this.deltaX),t.setInt16(9,this.deltaY);let e=11;0!==this.deltaAngle&&(t.setFloat32(e,this.deltaAngle),e+=4),0===this.deltaScaleX&&0===this.deltaScaleY||(t.setFloat32(e,this.deltaScaleX),t.setFloat32(e+4,this.deltaScaleY))}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.deltaX=t.getInt16(7),this.deltaY=t.getInt16(9);const e=t.byteLength;let i=11;15!==e&&23!==e||(this.deltaAngle=parseFloat(t.getFloat32(i).toFixed(4)),i+=4),19!==e&&23!==e||(this.deltaScaleX=parseFloat(t.getFloat32(i).toFixed(4)),this.deltaScaleY=parseFloat(t.getFloat32(i+4).toFixed(4)))}}class vu{deltaTime=0;id=0;deltaX=0;deltaY=0;get byteLength(){return 11}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setInt16(7,this.deltaX),t.setInt16(9,this.deltaY)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.deltaX=t.getInt16(7),this.deltaY=t.getInt16(9)}}class _u{deltaTime=0;id=0;deltaAngle=0;get byteLength(){return 11}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setFloat32(7,this.deltaAngle)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.deltaAngle=parseFloat(t.getFloat32(7).toFixed(4))}}class bu{deltaTime=0;id=0;deltaScaleX=0;deltaScaleY=0;get byteLength(){return 15}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setFloat32(7,this.deltaScaleX),t.setFloat32(11,this.deltaScaleY)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.deltaScaleX=parseFloat(t.getFloat32(7).toFixed(4)),this.deltaScaleY=parseFloat(t.getFloat32(11).toFixed(4))}}class yu{deltaTime=0;id=0;flipX=0;flipY=0;get byteLength(){return 8}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id);let e=0;this.flipX&&(e+=1),this.flipY&&(e+=2),t.setUint8(7,e)}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2);const e=t.getUint8(7);this.flipX=1&e?1:0,this.flipY=2&e?1:0}}class wu{deltaTime=0;id=0;sortId=0;x=0;y=0;scaleX=1;scaleY=1;rotation=0;constructor(t={}){this.deltaTime=0,this.id=t.id||0,this.sortId=t.sortId||0,this.x=t.x||0,this.y=t.y||0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.rotation=t.rotation||0}get byteLength(){const t=!(1===this.scaleX&&1===this.scaleY&&!this.rotation);let e=16;return t&&(e=28),e}serialize(t){t.setUint16(0,cu.compress(this.deltaTime)),t.setUint40(2,this.id),t.setUint40(7,this.sortId),t.setInt16(12,this.x||0),t.setInt16(14,this.y||0),28===this.byteLength&&(t.setFloat32(16,this.scaleX||1),t.setFloat32(20,this.scaleY||1),t.setFloat32(24,this.rotation||0))}unserialize(t){this.deltaTime=cu.decompress(t.getUint16(0)),this.id=t.getUint40(2),this.sortId=t.getUint40(7),this.x=t.getInt16(12),this.y=t.getInt16(14),28===t.byteLength&&(this.scaleX=parseFloat(t.getFloat32(16).toFixed(4)),this.scaleY=parseFloat(t.getFloat32(20).toFixed(4)),this.rotation=parseFloat(t.getFloat32(24).toFixed(4)))}}const Eu=Object.freeze({INPUT_COMMAND:new Jc(223,"input-command",mu),STAMP_ADDED:new Jc(234,"stamp-added",wu),STAMP_SCALED:new Jc(235,"stamp-scaled",bu),STAMP_SCALE_FLIPPED:new Jc(233,"stamp-scale-flipped",yu),STAMP_ROTATED:new Jc(236,"stamp-rotated",_u),STAMP_MOVED:new Jc(237,"stamp-moved",vu),STAMP_COLOR_CHANGED:new Jc(238,"stamp-color-changed",du),STAMP_DYNAMIC_COLOR_CHANGED:new Jc(231,"stamp-dynamic-color-changed",pu),STAMP_REMOVED:new Jc(250,"stamp-removed",wu),STAMP_PINCH:new Jc(232,"stamp-pinch",gu),ITEM_SCALED:new Jc(251,"item-scaled",bu),ITEM_ROTATED:new Jc(252,"item-rotated",_u),ITEM_MOVED:new Jc(253,"item-moved",vu),ITEM_COLOR_CHANGED:new Jc(254,"item-color-changed",du),ITEM_DYNAMIC_COLOR_CHANGED:new Jc(247,"item-dynamic-color-changed",pu),ITEM_SHOW:new Jc(239,"item-show",mu),ITEM_HIDE:new Jc(255,"item-hide",mu),toArray:Kc,toMap:Zc});var Cu=Eu;class Tu{id=0;activeColorRGB=[0,0,0];offsetX=0;offsetY=0;get activeColorHex(){return"#"+this.activeColorRGB.map((t=>t.toString(16))).map((t=>1===t.length?"0"+t:t)).join("")}get byteLength(){let t=8;return(this.offsetX||this.offsetY)&&(t=12),t}serialize(t){t.setUint40(0,this.id),t.setUint8(5,this.activeColorRGB[0]),t.setUint8(6,this.activeColorRGB[1]),t.setUint8(7,this.activeColorRGB[2]),(this.offsetX||this.offsetY)&&(t.setInt16(8,this.offsetX||0),t.setInt16(10,this.offsetY||0))}unserialize(t){this.id=t.getUint40(0),this.activeColorRGB=[t.getUint8(5),t.getUint8(6),t.getUint8(7)],12===t.byteLength&&(this.offsetX=t.getInt16(8),this.offsetY=t.getInt16(10))}}class xu{id=0;activeColorIndex=0;get byteLength(){return 7}serialize(t){if(this.activeColorIndex<0)throw new TypeError("Invalid activeColorIndex");t.setUint40(0,this.id),t.setUint16(5,this.activeColorIndex)}unserialize(t){this.id=t.getUint40(0),this.activeColorIndex=t.getUint16(5)}}const Su=5,Iu=Su+4;class Lu{id=0;offsetX=0;offsetY=0;get isExtendedBytes(){return!(!this.offsetX&&!this.offsetY)}get byteLength(){return this.isExtendedBytes?Iu:Su}serialize(t){t.setUint40(0,this.id),this.isExtendedBytes&&(t.setInt16(5,this.offsetX),t.setInt16(7,this.offsetY))}unserialize(t){this.id=t.getUint40(0),t.byteLength===Iu&&(this.offsetX=t.getInt16(5),this.offsetY=t.getInt16(7))}}class Ou{id=0;sortId=0;x=0;y=0;scaleX=1;scaleY=1;rotation=0;constructor(t={}){this.id=t.id||0,this.sortId=t.sortId||0,this.x=t.x||0,this.y=t.y||0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.rotation=t.rotation||0}get byteLength(){let t=14;return 1===this.scaleX&&1===this.scaleY&&0!==this.rotation&&(t=18),1===this.scaleX&&1===this.scaleY||0!==this.rotation||(t=22),1===this.scaleX&&1===this.scaleY||0===this.rotation||(t=26),t}serialize(t){t.setUint40(0,this.id),t.setUint40(5,this.sortId),t.setInt16(10,this.x||0),t.setInt16(12,this.y||0),1===this.scaleX&&1===this.scaleY&&0!==this.rotation&&t.setFloat32(14,this.rotation),1===this.scaleX&&1===this.scaleY||0!==this.rotation||(t.setFloat32(14,this.scaleX),t.setFloat32(18,this.scaleY)),1===this.scaleX&&1===this.scaleY||0===this.rotation||(t.setFloat32(14,this.scaleX),t.setFloat32(18,this.scaleY),t.setFloat32(22,this.rotation))}unserialize(t){this.id=t.getUint40(0),this.sortId=t.getUint40(5),this.x=t.getInt16(10),this.y=t.getInt16(12),18===t.byteLength&&(this.rotation=parseFloat(t.getFloat32(14).toFixed(4))),22===t.byteLength&&(this.scaleX=parseFloat(t.getFloat32(14).toFixed(4)),this.scaleY=parseFloat(t.getFloat32(18).toFixed(4))),26===t.byteLength&&(this.scaleX=parseFloat(t.getFloat32(14).toFixed(4)),this.scaleY=parseFloat(t.getFloat32(18).toFixed(4)),this.rotation=parseFloat(t.getFloat32(22).toFixed(4)))}}class Au{seed=0;get byteLength(){return 5}serialize(t){t.setUint40(0,this.seed)}unserialize(t){this.seed=t.getUint40(0)}}const ku=Object.freeze({SIMPLE_LAYER:new Jc(1,"SimpleLayer",Lu),IMAGE:new Jc(2,"Image",Lu),COLOR_PICKER:new Jc(3,"ColorPicker",Tu),STAMP_LAYER:new Jc(4,"Stamp",Ou),COLOR_DYNAMIC_LAYER:new Jc(7,"ColorDynamicLayer",xu),SEED:new Jc(16,"SeedEntry",Au),toArray:Kc,toMap:Zc});var Ru=ku;const Pu=new Uint8Array([77,69,73,75,69,82]);class Du{version=1;split=0;gameId=0;releaseId=0;onUnserialize=[];onSerialize=[];get byteLength(){return 18}serialize(t){if(this.byteLength>t.byteLength)throw new RangeError("header is outside the bounds of the dataBytes");Pu.forEach(((e,i)=>t.setUint8(i,e))),t.setUint8(6,this.version),t.setUint8(7,this.split),t.setUint40(8,this.gameId),t.setUint40(13,this.releaseId),this.onSerialize.forEach((t=>{if("function"===typeof t)return t()}))}unserialize(t){if(this.byteLength>t.byteLength)throw new RangeError("header is outside the bounds of the dataBytes");const e=new Uint8Array(t.buffer,t.byteOffset,6);if(e.join("")!==Pu.join(""))throw new TypeError("Invalid header file signature.");this.version=t.getUint8(6),this.split=t.getUint8(7),this.gameId=t.getUint40(8),this.releaseId=t.getUint40(13),this.onUnserialize.forEach((t=>{if("function"===typeof t)return t()}))}}class Mu{header=new Du;contents=[];constructor(){Object.seal(this)}get length(){return this.contents.length}get byteLength(){return this.header.byteLength+this.contents.map((t=>t.byteLength)).reduce(((t,e)=>t+e),0)}read(t,e=0){if(!(t instanceof ArrayBuffer))throw new TypeError("buffer not found");if(e+this.header.byteLength>t.byteLength)throw new RangeError("offset is outside the bounds of the DataSet");e=parseInt(e||0);const i=new DataView(t,e,this.header.byteLength);this.header.unserialize(i),e+=this.header.byteLength;const n=t.byteLength-e;if(n<=0)return;let s=0;const r=this.contents.length;for(let a=0;a<r;a++){if(n-s<=0)break;const i=this.contents[a];i.read(t,e+s),s+=this.contents[a].byteLength}}write(t,e=0){if(!(t instanceof ArrayBuffer))throw new TypeError("buffer not found");e=parseInt(e||0);const i=new DataView(t,e,this.header.byteLength);this.header.serialize(i),e+=this.header.byteLength;let n=0;const s=this.contents.length;for(let r=0;r<s;r++){const i=this.contents[r];i.write(t,e+n),n+=i.byteLength}}toArrayBuffer(){if(!this.header.gameId||!this.header.releaseId)throw new Error("GameID or ReleaseId not found");const t=new ArrayBuffer(this.byteLength);return this.write(t),t}async toBlob(){const t=this.toArrayBuffer(),e=new Blob([new Uint8Array(t)],{type:"application/octet-binary"});return e}async toBlobURL(){const t=await this.toBlob();return(window.URL||window.webkitURL).createObjectURL(t)}static async parseFromDroppedFile(t){const e=await eu(t);return this.parseFromArrayBuffer(e)}static async parseFromURL(t){const e=await tu(t);return this.parseFromArrayBuffer(e)}}const ju=4,Bu=2147483647;class Fu{entries=[];availableTypes=new Map;maxLength=Bu;constructor(t,e=Bu){e>0&&e<=Bu&&(this.maxLength=parseInt(e)),this.availableTypes=t||new Map,Object.seal(this)}get length(){return this.entries.length}get byteLength(){return ju+this.entries.map((t=>t.byteLength)).reduce(((t,e)=>t+e),0)}read(t,e=0){e=parseInt(e||0);const i=new DataView(t,e,ju),n=i.getUint32(0);if(e+=ju,0===n)return;if(e+n>t.byteLength)throw new RangeError("offset is outside the bounds of the DataSet");let s=0,r=this.maxLength;this.clear();while(--r>0){if(n-s<=0)break;const i=new $c;this.push(i),i.read(t,e+s),s+=i.byteLength}}write(t,e=0){e=parseInt(e||0);const i=new DataView(t,e,ju);e+=ju;let n=0;const s=this.entries.length;for(let r=0;r<s;r++){const i=this.entries[r];i.write(t,e+n),n+=i.byteLength}i.setUint32(0,n)}push(t){if(!(t instanceof $c))throw new TypeError("invalid item type");if(t.typeCode&&!this.availableTypes.has(t.typeCode))throw new TypeError("Invalid dataSet entry typeCode.");return t.parent=this,this.entries.push(t)}clear(){this.entries.length>0&&(this.entries.length=0)}iterator(){let t=0;return{next:()=>t++<=this.entries.length?this.entries[t]:null}}forEach(t){return this.entries.forEach(t)}}const Uu=Ru.toMap(),Nu=Cu.toMap(),Xu=lu.toMap();class Hu extends Mu{constructor(t=null){super(),t=Object.assign({version:3,split:1,gameId:0,releaseId:0},t||{});const e=()=>{1===this.header.version&&4===this.contents.length&&this.contents.shift()};this.header.split=t.split,this.header.version=t.version,this.header.gameId=t.gameId,this.header.releaseId=t.releaseId,this.header.onUnserialize.push(e),this.contents=[new Fu(Xu,16777215),new Fu(Uu,16777215),new Fu(Uu,477218588),new Fu(Nu,477218588)],e(),Object.freeze(this)}get dictionaries(){if(1!==this.header.version)return this.contents[0]}get initialState(){return 1===this.header.version?this.contents[0]:this.contents[1]}get initialStateStamps(){return 1===this.header.version?this.contents[1]:this.contents[2]}get historyEvents(){return 1===this.header.version?this.contents[2]:this.contents[3]}setInitialState(t){if(!(t instanceof Mu))throw new TypeError("Invalid saveFile object.");if(t.contents.length<2)throw new TypeError("Invalid saveFile contents.");if(this.header.version!==t.header.version)throw new TypeError("Invalid saveFile version.");this.contents[0]=t.contents[0],this.contents[1]=t.contents[1],1!==this.header.version&&(this.contents[2]=t.contents[2])}static async parseFromArrayBuffer(t){const e=new Hu;return e.read(t),e}}var Vu=Hu;const Gu=Ru.toMap(),Yu=lu.toMap();class zu extends Mu{constructor(t=null){super(),t=Object.assign({version:3,split:0,gameId:0,releaseId:0},t||{});const e=()=>{1===this.header.version&&3===this.contents.length&&this.contents.shift()};this.header.split=t.split,this.header.version=t.version,this.header.gameId=t.gameId,this.header.releaseId=t.releaseId,this.header.onUnserialize.push(e),this.contents=[new Fu(Yu,16777215),new Fu(Gu,16777215),new Fu(Gu,477218588)],e(),Object.freeze(this)}get dictionaries(){if(1!==this.header.version)return this.contents[0]}get finalState(){return 1===this.header.version?this.contents[0]:this.contents[1]}get finalStateStamps(){return 1===this.header.version?this.contents[1]:this.contents[2]}static async parseFromArrayBuffer(t){const e=new zu;return e.read(t),e}}var Wu=zu;class $u{execute(t,e){t.context.pistonUnits.forEach((t=>{t.set("visible",!1)}))}}var qu=$u;class Qu{constructor(t){this.saveFile=t}execute(t,e){this.saveFile.finalState.forEach((e=>{const i=t.context.find(e.data.id);if(!i)return;if(e.type!==Ru.SIMPLE_LAYER&&e.type!==Ru.IMAGE)return;this.makeParentsVisible(t.context,i),i.set("visible",!0);const n=e.data.offsetX,s=e.data.offsetY;(n>0||s>0)&&(i.set("x",i.get("x")+n),i.set("y",i.get("y")+s))}))}makeParentsVisible(t,e){const i=e.parentId;if(!i)return;const n=t.find(i);n&&(n.set("visible",!0),this.makeParentsVisible(t,n))}}var Ju=Qu;class Ku{constructor(){this.mappedIDs=Object.create(null)}mapPistonId(t,e){let i=this.mappedIDs[t];if(i)return i;const n=la.isValid(t),s=e&&!la.isValid(t);return n||s?(i=la.generate(),this.mappedIDs[t]=i,i):t}}var Zu=Ku;class td{constructor(t){this.saveFile=t,this.localIdMapper=new Zu}execute(t,e){const{context:i}=t;this.saveFile.finalStateStamps.forEach((e=>{const n=t.context.find(e.data.id);if(!n)return;if(e.type!==Ru.STAMP_LAYER)return;const{availableSlots:s}=i.getPresetData(Lc);if(!s)throw new Error("No available slots");const r=s[0],a=this.localIdMapper.mapPistonId(e.data.sortId,!0);r.invoke("stamp-it",{id:e.data.id,sortId:a,x:e.data.x,y:e.data.y,scaleX:e.data.scaleX,scaleY:e.data.scaleY,rotation:e.data.rotation})}))}}var ed=td;class id{execute(t,e){const{context:i}=t,{availableSlots:n}=i.getPresetData(Lc);n.forEach((t=>{t.base.children.forEach((t=>{const e=i.find(t.id);e&&i.schedule(new mc(e))}))}))}}var nd=id;class sd{constructor(t){this.saveFile=t}execute(t,e){const{context:i}=t;if(!this.saveFile)throw new Error("SaveFile is not defined");const n=this.saveFile.finalState;n.forEach((t=>{if(!t)return;const e=t.data.id;if(!e)return;if(t.type!==Ru.COLOR_DYNAMIC_LAYER)return;const n=i.find(e);if(!n)return;const{colors:s}=lu.of(this.saveFile),r=t.data.activeColorIndex,a=s.get(r);if(!a)throw new Error("Color not found");n.invoke("forceActiveColor",a)}))}}var rd=sd;class ad{async execute(t,e){const{context:i}=t;i.mainUnit.invoke("saveSnap").then((t=>{const e=i.getPresetData(zd);e.initialStateSaveFile=t}))}}var od=ad;class ld{execute(t,e){const{context:i}=t,{history:n}=i;n.clear(),n.pushState(new ma("snap-loaded"))}}var hd=ld;class cd{name="loadSnap";async invoke(t,e,i){if(!i)throw new Error("No save file provided");let n=i;if(i instanceof ArrayBuffer&&(n=await Wu.parseFromArrayBuffer(i)),!(n instanceof Wu))throw new Error("Invalid save file provided");if(t.manifest.game_id!==n.header.gameId||t.manifest.release_id!==n.header.releaseId)throw new Error("The save file belongs to another game or has an old release version");t.schedule(new nd,gr.LOW),t.schedule(new qu,gr.LOW),t.schedule(new Ju(n),gr.LOW),t.schedule(new ed(n),gr.LOW),t.schedule(new rd(n),gr.LOW),t.schedule(new od,gr.LOW),t.schedule(new hd,gr.LOW)}}const ud=Object.freeze(new cd);var dd=ud;class fd{constructor(t){this.saveFile=t}execute(t,e){const{context:i}=t,n=i.mainUnit;this.checkChildren(i,n)}checkChildren(t,e){const i=e.base.children;if(!i)return;let n=!1;return i.forEach((e=>{if("object"!==typeof e)throw new Error("Child must be an object");if(!e.id)throw new Error("Child must have a `id` property");const i=t.find(e.id),s=this.checkNode(t,i);s&&(n=!0)})),n}checkNode(t,e){if(!this.validate(e))return;let i=this.checkChildren(t,e);return i=this.saveEntry(e,i),i}validate(t){return t instanceof ua&&(!la.isValid(t.id)&&!!t.get("visible"))}saveEntry(t,e){const i=t.get("x"),n=t.get("y"),s=t.get("initialX"),r=t.get("initialY"),a=i-s||0,o=n-r||0,l=0!==a,h=0!==o;if(e&&!l&&!h)return e;const c=$c.createInstance(Ru.SIMPLE_LAYER,{id:t.id,offsetX:a,offsetY:o});return this.saveFile.finalState.push(c),!0}}var pd=fd;class md{constructor(t){this.saveFile=t}execute(t,e){const{context:i}=t,{availableSlots:n}=i.getPresetData(Lc);if(!n)throw new Error("No available slots");const s=n[0];if(!s)return;const r=s.base.children;r.forEach((t=>{if(!t.visible)return;const e=$c.createInstance(Ru.STAMP_LAYER,{id:t.source_id,sortId:t.id,x:t.x,y:t.y,scaleX:t.scale_x,scaleY:t.scale_y,rotation:t.rotation});this.saveFile.finalStateStamps.push(e)}))}}var gd=md;class vd{constructor(t){this.saveFile=t}execute(t,e){const{context:i}=t;if(!this.saveFile)throw new Error("SaveFile is not defined");const n=this.saveFile.finalState;n.forEach((t=>{if(!t)return;const e=t.data.id;if(!e)return;const s=i.find(e);if(!s)return;if(!Il(s))return;const r=s.get("active_color");if(!r)return;const{colors:a}=lu.of(this.saveFile),o=$c.createInstance(Ru.COLOR_DYNAMIC_LAYER,{id:s.id,activeColorIndex:a.add(r)});n.push(o)}))}}var _d=vd;class bd{name="saveSnap";async invoke(t,e,i){const n=new Wu;return n.header.gameId=t.manifest.game_id,n.header.releaseId=t.manifest.release_id,t.schedule(new pd(n),gr.LOW),t.schedule(new gd(n),gr.LOW),t.schedule(new _d(n),gr.LOW),n}}const yd=Object.freeze(new bd);var wd=yd;class Ed{constructor(t){this.replayFile=t}execute(t,e){const i=this.replayFile.historyEvents,n=i.entries,s=this.compressEntries(n);i.entries=s}compressEntries(t){const e=this.findDuplicateIndexes(t);if(!e.length)return t;const i=this.filterDuplicatedEntries(t,e);return i}findDuplicateIndexes(t){const e=new Map,i=[];return t.forEach(((t,n)=>{if(t.type!==Cu.ITEM_SHOW&&t.type!==Cu.ITEM_HIDE)return;t.data.deltaTime>0&&e.clear();const s=t.data.id,r=s,a=e.get(r);void 0!==a&&i.push(a),e.set(r,n)})),e.clear(),i}filterDuplicatedEntries(t,e){const i=t.filter(((t,i,n)=>{const s=e.indexOf(i),r=-1!==s;if(!r)return!0;e.splice(s,1);const a=t.data.deltaTime,o=a>0;if(!o)return!1;const l=n[i+1],h=l.data.deltaTime>0;return!!l&&(h||(l.data.deltaTime+=a),!1)}));return i}}var Cd=Ed;class Td{constructor(t){this.replayFile=t}execute(t,e){const i=this.replayFile.historyEvents,n=i.entries,s=this.compressEntries(n);i.entries=s}compressEntries(t){const e=this.getPinchEntriesMap(t),i=e.indexesToRemove.length>0,n=e.pinchEventMap.size>0;return i||n?(this.mapPinchEventsIntoEntries(t,e.pinchEventMap),this.filterFromRemovedEntries(t,e.indexesToRemove),t):t}mapPinchEventsIntoEntries(t,e){e.forEach(((e,i)=>{t[i]=e}))}filterFromRemovedEntries(t,e){let i=0;e.forEach((e=>{const n=e+i--,s=t[n];t.splice(n,1);const r=s.data.deltaTime>0;if(!r)return;const a=t[n];if(!a)return;const o=a.data.deltaTime>0;o||(a.data.deltaTime=s.data.deltaTime)}))}getPinchEntriesMap(t){const e={pinchEventMap:new Map,indexesToRemove:[]},i=new Map;return t.forEach(((t,n,s)=>{if(!this.isValid(t))return;const r=t.data.id,a=r,o=i.get(a);if(o){const e=this.updateOccurrence(o,t,n);i.set(a,e)}else{const e=this.createOccurrence(t,n);i.set(a,e)}const l=s[n+1];l&&0===l.data.deltaTime||(this.updatePinchEntriesMap(e,i),i.clear())})),e}updatePinchEntriesMap(t,e){e.forEach((e=>{if(0===e.indexesToRemove.length)return;const i=e.indexToAddPinchEvent,n=e.pinchEvent;t.pinchEventMap.set(i,n),t.indexesToRemove.push(...e.indexesToRemove)}))}isValid(t){if(!la.isValid(t.data.id))return!1;const e=[Cu.STAMP_MOVED,Cu.STAMP_ROTATED,Cu.STAMP_SCALED];return!!e.includes(t.type)}createOccurrence(t,e){const i=this.createPinchEvent(t),n={pinchEvent:i,indexToAddPinchEvent:e,indexesToRemove:[]};return n}updateOccurrence(t,e,i){const n=t.pinchEvent,[s,r]=this.getPropAndValueToUpdate(e),a=n.data[s];return n.data[s]=a+r,t.indexesToRemove.push(t.indexToAddPinchEvent),t.indexToAddPinchEvent=i,t}createPinchEvent(t){const e=$c.createInstance(Cu.STAMP_PINCH,{id:t.data.id,deltaTime:t.data.deltaTime}),[i,n]=this.getPropAndValueToUpdate(t);return e.data[i]=n,e}getPropAndValueToUpdate(t){const e=t.type,i=t.data;if(e===Cu.STAMP_MOVED){if(0!==i.deltaX)return["deltaX",i.deltaX];if(0!==i.deltaY)return["deltaY",i.deltaY]}if(e===Cu.STAMP_ROTATED)return["deltaAngle",i.deltaAngle];if(e===Cu.STAMP_SCALED){if(0!==i.deltaScaleX)return["deltaScaleX",i.deltaScaleX];if(0!==i.deltaScaleY)return["deltaScaleY",i.deltaScaleY]}}}var xd=Td;class Sd{constructor(t){this.replayFile=t}execute(t,e){const{context:i}=t,n=i.getPresetData(zd),s=n.initialStateSaveFile;let r;this.replayFile.setInitialState(s);let a=0,o=!1;i.history.changes.forEach(((t,e,i)=>{const n=t instanceof ma;if(e>0&&(r=i[e-1]),!o&&n&&(o=!0),!o)return;if(n)return;const s=Id(t,r,a),l=Ld(this.replayFile,t,s,la.isValid(t.pistonUnitId));if(!l)throw new Error("Unknown entry type");this.replayFile.historyEvents.push(l),a=t.createdAt})),i.schedule(new Cd(this.replayFile),gr.LOW),i.schedule(new xd(this.replayFile),gr.LOW)}}const Id=(t,e,i)=>{const n=e instanceof ma;let s=t.createdAt-i;if(s<0)throw new Error("Negative deltaTime");return e&&!n&&(s=0),s},Ld=(t,e,i,n)=>{const s=e instanceof Kr,r=e instanceof sc,a=e instanceof pc;return r||a?Od(e,i,n,r):s?"rotation"===e.propName?Ad(e,i,n):"scale_x"===e.propName||"scale_y"===e.propName?kd(e,i,n):"x"===e.propName||"y"===e.propName?Rd(e,i,n):"visible"===e.propName?Pd(e,i,n):"active_color"===e.propName?Dd(t,e,i,n):void 0:void 0},Od=(t,e,i,n)=>{if(!i)return;const s=t.dataJsonObjectSerialized.toObject(),r=n?Cu.STAMP_ADDED:Cu.STAMP_REMOVED,a=$c.createInstance(r,{deltaTime:e,id:s.source_id,sortId:s.id,x:s.x,y:s.y,rotation:s.rotation,scaleX:s.scale_x,scaleY:s.scale_y});return a},Ad=(t,e,i)=>{const n=i?Cu.STAMP_ROTATED:Cu.ITEM_ROTATED,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e,deltaAngle:t.newValue-t.currentValue});return s},kd=(t,e,i)=>{if("scale_x"===t.propName){const n=i?Cu.STAMP_SCALED:Cu.ITEM_SCALED,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e,deltaScaleX:t.newValue-t.currentValue});return s}if("scale_y"===t.propName){const n=i?Cu.STAMP_SCALED:Cu.ITEM_SCALED,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e,deltaScaleY:t.newValue-t.currentValue});return s}},Rd=(t,e,i)=>{if("x"===t.propName){const n=i?Cu.STAMP_MOVED:Cu.ITEM_MOVED,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e,deltaX:t.newValue-t.currentValue});return s}if("y"===t.propName){const n=i?Cu.STAMP_MOVED:Cu.ITEM_MOVED,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e,deltaY:t.newValue-t.currentValue});return s}},Pd=(t,e,i)=>{const n=t.newValue?Cu.ITEM_SHOW:Cu.ITEM_HIDE,s=$c.createInstance(n,{id:t.pistonUnitId,deltaTime:e});return s},Dd=(t,e,i,n)=>{if(n)return;const s=Cu.ITEM_DYNAMIC_COLOR_CHANGED,{colors:r}=lu.of(t),a=r.add(e.newValue),o=$c.createInstance(s,{id:e.pistonUnitId,deltaTime:i,colorIndex:a});return o};var Md=Sd;class jd{name="saveReplay";invoke(t,e,i){const n=new Vu;return n.header.gameId=t.manifest.game_id,n.header.releaseId=t.manifest.release_id,t.schedule(new Md(n),gr.LOW),n}}const Bd=Object.freeze(new jd);var Fd=Bd;class Ud{execute(t,e){const{context:i}=t,n=i.history,s=this.searchEmptyCheckpoints(n);this.clearAllEmptyCheckpoints(n,s)}searchEmptyCheckpoints(t){const e=[];return t.changes.forEach(((t,i,n)=>{const s=t instanceof ma;if(!s)return;if("loaded"===t.name)return;const r=n[i+1];if(!r)return void e.push(i);const a=r instanceof ma;a&&e.push(i)})),e}clearAllEmptyCheckpoints(t,e){let i=0;e.forEach((e=>{const n=e+i;t.changes.splice(n,1),i--}))}}var Nd=Ud;class Xd{constructor(t){this.replayFile=t,this.setOfTempMemories=new Set,this.localIdMapper=new Zu}execute(t,e){const{context:i,variables:n}=t,s=i.history,r=s.changes.pointer,a=s.timer.startTimeInMs;try{this.replayFile.historyEvents.entries.forEach((e=>{s.timer.startTimeInMs+=e.data.deltaTime;const i=[],n=this.createCheckpoint(s,e);i.push(n);const r=this.createStateChanges(t,e);i.push(...r),i.forEach((t=>{if(!t)return;const e=t instanceof Kr;if(e){const e=t.currentValue,i=t.newValue;if(i===e)return}s.pushState(t),t.createdAt=s.timer.startTimeInMs}))})),i.schedule(new Nd,gr.LOW)}catch(yr){throw s.timer.startTimeInMs=a,yr}finally{this.clearTempMemory(n)}s.changes.pointer=r}getPistonUnitId(t){let e=t.data.id;const i=!!t.data.sortId;return i&&(e=t.data.sortId),e=this.localIdMapper.mapPistonId(e,i),e}createCheckpoint(t,e){if(e.data.deltaTime<=0)return;const i=new ma("load-replay-step");return i}createStateChanges(t,e){const{context:i,variables:n}=t,s=this.getPistonUnitId(e),r=this.getTempMemory(s,n);this.setOfTempMemories.add(s);const a=la.isValid(s),o=this.getPistonUnit(i,s,a);if(e.type===Cu.ITEM_SHOW||e.type===Cu.ITEM_HIDE)return[this.createVisibleChange(s,e)];if(e.type===Cu.ITEM_ROTATED||e.type===Cu.STAMP_ROTATED)return[this.createRotationChange(s,o,e,a,r)];if(e.type===Cu.ITEM_SCALED||e.type===Cu.STAMP_SCALED)return this.createScaleChanges(s,o,e,a,r);if(e.type===Cu.ITEM_MOVED||e.type===Cu.STAMP_MOVED)return this.createMoveChanges(s,o,e,a,r);if(e.type===Cu.STAMP_PINCH)return this.createPinchChanges(s,o,e,a,r);if(e.type===Cu.STAMP_SCALE_FLIPPED)return this.createStampFlippedChanges(s,o,e,a,r);if(e.type===Cu.STAMP_ADDED||e.type===Cu.STAMP_REMOVED){if(!a)throw new Error("Id should be stamp");return[this.createStampChange(i,s,e,r)]}return e.type===Cu.ITEM_DYNAMIC_COLOR_CHANGED?[this.createDynamicColorChange(s,o,e,a,r)]:void 0}getPistonUnit(t,e,i){let n=null;if(!i&&(n=t.find(e),!n))throw new Error(`Cannot find piston unit with id ${e}`);return n}getTempMemory(t,e){if(!t)throw new Error("piston unit ID is required");let i=e.get(`temp-memory-${t}`);return i||(i={},e.set(`temp-memory-${t}`,i)),i}clearTempMemory(t){this.setOfTempMemories.forEach((e=>{t.delete(`temp-memory-${e}`)})),this.setOfTempMemories.clear()}createVisibleChange(t,e){if(e.type===Cu.ITEM_SHOW){const e=!0,i=!1;return new Kr(t,"visible",e,i)}if(e.type===Cu.ITEM_HIDE){const e=!1,i=!0;return new Kr(t,"visible",e,i)}}createRotationChange(t,e,i,n,s){if(!s.rotation){let t=0;e&&(t=e.get("rotation")),n&&(t=s.stamp.rotation),s.rotation=t}const r=s.rotation+i.data.deltaAngle,a=s.rotation;return s.rotation=r,new Kr(t,"rotation",r,a)}createScaleChanges(t,e,i,n,s){const r=[];if(0!==i.data.deltaScaleX){if(!s.scaleX){let t=1;e&&(t=e.get("scale_x")),n&&(t=s.stamp.scale_x),s.scaleX=t}const a=s.scaleX+i.data.deltaScaleX,o=s.scaleX;s.scaleX=a,r.push(new Kr(t,"scale_x",a,o))}if(0!==i.data.deltaScaleY){if(!s.scaleY){let t=1;e&&(t=e.get("scale_y")),n&&(t=s.stamp.scale_y),s.scaleY=t}const a=s.scaleY+i.data.deltaScaleY,o=s.scaleY;s.scaleY=a,r.push(new Kr(t,"scale_y",a,o))}return r}createMoveChanges(t,e,i,n,s){const r=[];if(0!==i.data.deltaX){if(!s.x){let t=0;e&&(t=e.get("x")),n&&(t=s.stamp.x),s.x=t}const a=s.x+i.data.deltaX,o=s.x;s.x=a,r.push(new Kr(t,"x",a,o))}if(0!==i.data.deltaY){if(!s.y){let t=0;e&&(t=e.get("y")),n&&(t=s.stamp.y),s.y=t}const a=s.y+i.data.deltaY,o=s.y;s.y=a,r.push(new Kr(t,"y",a,o))}return r}createPinchChanges(t,e,i,n,s){const r=[],a=this.createMoveChanges(t,e,i,n,s),o=[this.createRotationChange(t,e,i,n,s)],l=this.createScaleChanges(t,e,i,n,s);return r.push(...a,...o,...l),r}createStampFlippedChanges(t,e,i,n,s){const r=[];if(i.data.flipX){if(!s.scaleX){let t=1;e&&(t=e.get("scale_x")),n&&(t=s.stamp.scale_x),s.scaleX=t}const i=-1*s.scaleX,a=s.scaleX;s.scaleX=i,r.push(new Kr(t,"scale_x",i,a))}if(i.data.flipY){if(!s.scaleY){let t=1;e&&(t=e.get("scale_y")),n&&(t=s.stamp.scale_y),s.scaleY=t}const i=-1*s.scaleY,a=s.scaleY;s.scaleY=i,r.push(new Kr(t,"scale_y",i,a))}return r}createStampChange(t,e,i,n){const s=this.getSlotId(t),r=i.data.id,a=this.getBaseStamp(t,r),o={...a,id:e,type:ic.STAMP_ITEM,parent_id:s,source_id:r,visible:!0,x:i.data.x,y:i.data.y,scale_x:i.data.scaleX,scale_y:i.data.scaleY,rotation:i.data.rotation,tags:[ic.STAMP_ITEM]};if(n.stamp=o,i.type===Cu.STAMP_ADDED){const t=new sc(o);return t}if(i.type===Cu.STAMP_REMOVED){const t=new pc(o);return t}}createDynamicColorChange(t,e,i,n,s){if(n)return;const{colors:r}=lu.of(this.replayFile),a=i.data.colorIndex,o=r.get(a),l=o;let h=s.activeColor;return h||(h=e.get("active_color")),s.activeColor=l,new Kr(t,"active_color",l,h)}getSlotId(t){const{availableSlots:e}=t.getPresetData(Lc),i=e[0];if(!i)throw new Error("No slot found");return i.id}getBaseStamp(t,e){const i=t.find(e);if(!i)throw new Error(`Could not find source piston unit with id: ${e}`);const n=i.base;if(!n)throw new Error(`Could not find base stamp from piston unit: ${e}`);return n}}var Hd=Xd;class Vd{name="loadReplay";async invoke(t,e,i){if(!i)throw new Error("No replay file provided");let n=i;if(i instanceof ArrayBuffer&&(n=await Vu.parseFromArrayBuffer(i)),!(n instanceof Vu))throw new Error("Invalid replay file provided");const s=new Wu({version:n.header.version,gameId:t.manifest.game_id,releaseId:t.manifest.release_id});for(let r=0;r<s.contents.length;r++)s.contents[r].entries=n.contents[r].entries;t.schedule(new na(t.mainUnit.id,"loadSnap",s,(()=>{t.schedule(new Hd(n),gr.LOW)})),gr.LOW)}}const Gd=Object.freeze(new Vd);var Yd=Gd,zd=Object.freeze({name:"Snaps",data(){return{initialStateSaveFile:null}},checkIfItMatches(t){return t.base.type===Ra.MAIN},performSetup(t,e){t.attachAction(dd),t.attachAction(wd),t.attachAction(Fd),t.attachAction(Yd),e.schedule(new od,gr.LOW)}}),Wd=[Ba,Va,kh,Kh,zh,zo,Zh,Qa,lc,zl,Do,ko,yl,uh,Lc,Gc,zd,ih,Hl];class $d{checkpointName;constructor(t=null){this.checkpointName=t||""}execute({context:t}){const e=t.history,i=e.changes,n=new ma(this.checkpointName);let s=null;i.length>0&&(s=i[i.length-1]),s&&s instanceof ma&&s.name===n.name||e.pushState(n)}}const qd=Symbol("@context");class Qd{base;manifest;history;options;constructor(t=null){if(t&&("undefined"===typeof t.game_id||"undefined"===typeof t.release_id||"undefined"===typeof t.canvas_height||"undefined"===typeof t.canvas_width))throw new TypeError("Piston manifest not found or invalid");this.manifest=Object.assign({},t||{})}async load(t,e=null){if(!Array.isArray(t)&&!Array.isArray(t.children))throw new TypeError("jsonObject need to be a array object");Object.prototype.hasOwnProperty.call(this,qd)&&Jd(this).dispose(),e=Object.assign({only:[],disabled:[],include:[],keepDataJsonObject:!0,readonlyProperties:!0},e||{});const i=[...Wd,...e.include];e.only.length>0&&(e.disabled=i.filter((t=>-1===e.only.indexOf(t.name))).map((t=>t.name)));const n=(t,s=new WeakSet)=>{t.dependencies&&!s.has(t)&&-1===e.disabled.indexOf(t.name)&&(s.add(t),t.dependencies.forEach((r=>{const a=e.disabled.indexOf(r);if(-1===a||r===t.name)return;e.disabled.splice(a,1);const o=i.find((t=>t.name===r));if(!o)throw new ReferenceError(`Preset "${r}" not found.`);n(o,s)})))};i.forEach((t=>n(t))),Array.isArray(t)&&this.manifest.game_id&&(t=Object.assign({},this.manifest,{children:t})),e.keepDataJsonObject&&Object.isExtensible(t)||(t=JSON.parse(JSON.stringify(t)));const s=new Ra(t);return i.forEach((t=>{-1===e.disabled.indexOf(t.name)&&s.loadPresetSetup(t)})),Object.defineProperty(this,qd,{value:s,writable:!1,configurable:!0}),Object.defineProperty(this,"base",{value:e.readonlyProperties?Yr(s.base):s.base,enumerable:!0,configurable:!0,writable:!1}),Object.defineProperty(this,"manifest",{value:e.readonlyProperties?Yr(s.manifest):s.manifest,enumerable:!0,configurable:!0,writable:!1}),Object.defineProperty(this,"history",{value:Kd(s.history,e),enumerable:!0,configurable:!0,writable:!1}),Object.defineProperty(this,"options",{value:e.readonlyProperties?Yr(e):e,enumerable:!0,configurable:!0,writable:!1}),Object.seal(this),new Promise(((t,e)=>{s.jobQueue.lazyEnqueue(new pa((()=>{s.history.pushState(new ma("loaded")),Dr((()=>t()))}))),s.jobQueue.next(s)}))}get isIdle(){return Jd(this).jobQueue.isIdle}get mainUnitId(){return Jd(this).mainUnit.id}static getMetadataOf(t){return ua.getMetadataOf(t)}static getUUIDOf(t){return ua.getUUIDOf(t)}static watch(t,e){const i=Br.getObserverOf(t);return e?i.register(e):null}has(t){return!!Jd(this).find(t)}get(t){const e=Jd(this).find(t);if(e)return this.options.readonlyProperties?Yr(e.base):e.base}async historyBack(){if(!this.history)throw new Error("Piston context not loaded yet.");return this.history.back()}async historyForward(){if(!this.history)throw new Error("Piston context not loaded yet.");return this.history.forward()}invoke(t,e,i=null,n=null){return n=Object.assign({checkpoint:!0},n||{}),new Promise(((s,r)=>{const a=Jd(this),o=a.find(t);if(!o)return r(new Error("PistonUnit not found"));let l=null;const h=[];h.push(new $d("invoke")),h.push(new na(o.id,e,i,(t=>{l=t}))),h.push(new pa((()=>{Dr((()=>{if(l instanceof Error)return r(l);s(l)}))}))),n.checkpoint||h.shift();while(h.length>0)a.jobQueue.lazyEnqueue(h.shift());a.jobQueue.next(a)}))}set(t,e={},i=null){return i=Object.assign({checkpoint:!0},i||{}),new Promise(((n,s)=>{const r=Jd(this),a=r.find(t);if(!a)return s(new Error("PistonUnit not found"));const o=[new $d("set")];for(const t in e)Object.hasOwnProperty.call(e,t)&&o.push(new Zr(a.id,t,e[t]));1!==o.length&&i.checkpoint||o.shift(),o.push(new pa((()=>{Dr((()=>{n()}))})));while(o.length>0)r.jobQueue.lazyEnqueue(o.shift());r.jobQueue.next(r)}))}}function Jd(t){if(!t[qd])throw new Error("Piston context not loaded yet.");return t[qd]}function Kd(t,e){const i=e.readonlyProperties?Yr(t.changes):t.changes;return Object.freeze({changes:i,get length(){return t.length},go:(...e)=>t.go.apply(t,e),back:(...e)=>t.back.apply(t,e),forward:(...e)=>t.forward.apply(t,e),rewind:(...e)=>t.rewind.apply(t,e),getCheckpointsIndexes:(...e)=>t.getCheckpointsIndexes.apply(t,e),forwardToLastCheckpoint:(...e)=>t.forwardToLastCheckpoint.apply(t,e)})}new Map(Object.entries({pass:"pass-through",norm:"normal",diss:"dissolve",dark:"darken",mul:"multiply",idiv:"color-burn",lbrn:"linear-burn",dkCl:"darker-color",lite:"lighten",scrn:"screen","div ":"color-dodge",lddg:"linear-dodge",lgCl:"lighter-color",over:"overlay",sLit:"soft-light",hLit:"hard-light",vLit:"vivid-light",lLit:"linear-light",pLit:"pin light",hMix:"hard mix",diff:"difference",smud:"exclusion",fsub:"subtract",fdiv:"divide","hue ":"hue","sat ":"saturation",colr:"color","lum ":"luminosity"}));const Zd=new Map(Object.entries({"pass-through":Object.freeze({label:"Pass Through",compositeOperation:"source-over"}),normal:Object.freeze({label:"Normal",compositeOperation:"source-over"}),multiply:Object.freeze({label:"Multiply",compositeOperation:"multiply"}),screen:Object.freeze({label:"Screen",compositeOperation:"screen"}),overlay:Object.freeze({label:"Overlay",compositeOperation:"overlay"})}));function tf(t){const e=Zd.get(t);return e?e.compositeOperation:"source-over"}var ef=i(4474);const nf=function(t,e){this.createjs=this.createjs||{},
/*!
* EaselJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/
this.createjs=this.createjs||{},af.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},af.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},af.indexOf=function(t,e){for(var i=0,n=t.length;i<n;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){function t(){throw"UID cannot be instantiated"}t._nextID=0,t.get=function(){return t._nextID++},af.UID=t}(),this.createjs=this.createjs||{},af.deprecate=function(t,e){return function(){var i="Deprecated property or method '"+e+"'. See docs for info.";return console&&(console.warn?console.warn(i):console.log(i)),t&&t.apply(this,arguments)}},this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},af.Event=t}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,a=s.length;r<a;r++)if(s[r]==e){1==a?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!e&&(!n||!n[t]))return!0;t=new af.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(l){}if(t.bubbles&&this.parent){var s=this,r=[s];while(s.parent)r.push(s=s.parent);var a,o=r.length;for(a=o-1;a>=0&&!t.propagationStopped;a--)r[a]._dispatchEvent(t,1+(0==a));for(a=1;a<o&&!t.propagationStopped;a++)r[a]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){var e=this;while(e){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n,s=e<=2?this._captureListeners:this._listeners;if(t&&s&&(n=s[t.type])&&(i=n.length)){try{t.currentTarget=this}catch(o){}try{t.eventPhase=0|e}catch(o){}t.removed=!1,n=n.slice();for(var r=0;r<i&&!t.immediatePropagationStopped;r++){var a=n[r];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},af.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function e(){throw"Ticker cannot be instantiated."}e.RAF_SYNCHED="synched",e.RAF="raf",e.TIMEOUT="timeout",e.timingMode=null,e.maxDelta=0,e.paused=!1,e.removeEventListener=null,e.removeAllEventListeners=null,e.dispatchEvent=null,e.hasEventListener=null,e._listeners=null,af.EventDispatcher.initialize(e),e._addEventListener=e.addEventListener,e.addEventListener=function(){return!e._inited&&e.init(),e._addEventListener.apply(e,arguments)},e._inited=!1,e._startTime=0,e._pausedTime=0,e._ticks=0,e._pausedTicks=0,e._interval=50,e._lastTime=0,e._times=null,e._tickTimes=null,e._timerId=null,e._raf=!0,e._setInterval=function(t){e._interval=t,e._inited&&e._setupTick()},e.setInterval=af.deprecate(e._setInterval,"Ticker.setInterval"),e._getInterval=function(){return e._interval},e.getInterval=af.deprecate(e._getInterval,"Ticker.getInterval"),e._setFPS=function(t){e._setInterval(1e3/t)},e.setFPS=af.deprecate(e._setFPS,"Ticker.setFPS"),e._getFPS=function(){return 1e3/e._interval},e.getFPS=af.deprecate(e._getFPS,"Ticker.getFPS");try{Object.defineProperties(e,{interval:{get:e._getInterval,set:e._setInterval},framerate:{get:e._getFPS,set:e._setFPS}})}catch(s){console.log(s)}e.init=function(){e._inited||(e._inited=!0,e._times=[],e._tickTimes=[],e._startTime=e._getTime(),e._times.push(e._lastTime=0),e.interval=e._interval)},e.reset=function(){if(e._raf){var i=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame;i&&i(e._timerId)}else clearTimeout(e._timerId);e.removeAllEventListeners("tick"),e._timerId=e._times=e._tickTimes=null,e._startTime=e._lastTime=e._ticks=e._pausedTime=0,e._inited=!1},e.getMeasuredTickTime=function(t){var i=0,n=e._tickTimes;if(!n||n.length<1)return-1;t=Math.min(n.length,t||0|e._getFPS());for(var s=0;s<t;s++)i+=n[s];return i/t},e.getMeasuredFPS=function(t){var i=e._times;return!i||i.length<2?-1:(t=Math.min(i.length-1,t||0|e._getFPS()),1e3/((i[0]-i[t])/t))},e.getTime=function(t){return e._startTime?e._getTime()-(t?e._pausedTime:0):-1},e.getEventTime=function(t){return e._startTime?(e._lastTime||e._startTime)-(t?e._pausedTime:0):-1},e.getTicks=function(t){return e._ticks-(t?e._pausedTicks:0)},e._handleSynch=function(){e._timerId=null,e._setupTick(),e._getTime()-e._lastTime>=.97*(e._interval-1)&&e._tick()},e._handleRAF=function(){e._timerId=null,e._setupTick(),e._tick()},e._handleTimeout=function(){e._timerId=null,e._setupTick(),e._tick()},e._setupTick=function(){if(null==e._timerId){var i=e.timingMode;if(i==e.RAF_SYNCHED||i==e.RAF){var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame;if(n)return e._timerId=n(i==e.RAF?e._handleRAF:e._handleSynch),void(e._raf=!0)}e._raf=!1,e._timerId=setTimeout(e._handleTimeout,e._interval)}},e._tick=function(){var t=e.paused,i=e._getTime(),n=i-e._lastTime;if(e._lastTime=i,e._ticks++,t&&(e._pausedTicks++,e._pausedTime+=n),e.hasEventListener("tick")){var s=new af.Event("tick"),r=e.maxDelta;s.delta=r&&n>r?r:n,s.paused=t,s.time=i,s.runTime=i-e._pausedTime,e.dispatchEvent(s)}e._tickTimes.unshift(e._getTime()-i);while(e._tickTimes.length>100)e._tickTimes.pop();e._times.unshift(i);while(e._times.length>100)e._times.pop()};var i=t,n=i.performance.now||i.performance.mozNow||i.performance.msNow||i.performance.oNow||i.performance.webkitNow;e._getTime=function(){return(n&&n.call(i.performance)||(new Date).getTime())-e._startTime},af.Ticker=e}(),this.createjs=this.createjs||{},function(){function t(t){this.readyState=t.readyState,this._video=t,this._canvas=null,this._lastTime=-1,this.readyState<2&&t.addEventListener("canplaythrough",this._videoReady.bind(this))}var i=t.prototype;i.getImage=function(){if(!(this.readyState<2)){var t=this._canvas,i=this._video;if(t||(t=this._canvas=af.createCanvas?af.createCanvas():e.createElement("canvas"),t.width=i.videoWidth,t.height=i.videoHeight),i.readyState>=2&&i.currentTime!==this._lastTime){var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.drawImage(i,0,0,t.width,t.height),this._lastTime=i.currentTime}return t}},i._videoReady=function(){this.readyState=2},af.VideoBuffer=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,s,r,a,o,l,h,c){this.Event_constructor(t,e,i),this.stageX=n,this.stageY=s,this.rawX=null==l?n:l,this.rawY=null==h?s:h,this.nativeEvent=r,this.pointerID=a,this.primary=!!o,this.relatedTarget=c}var e=af.extend(t,af.Event);e._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},e._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},e._get_isTouch=function(){return-1!==this.pointerID};try{Object.defineProperties(e,{localX:{get:e._get_localX},localY:{get:e._get_localY},isTouch:{get:e._get_isTouch}})}catch(i){}e.clone=function(){return new t(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},e.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"},af.MouseEvent=af.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,s,r){this.setValues(t,e,i,n,s,r)}var e=t.prototype;t.DEG_TO_RAD=Math.PI/180,t.identity=null,e.setValues=function(t,e,i,n,s,r){return this.a=null==t?1:t,this.b=e||0,this.c=i||0,this.d=null==n?1:n,this.tx=s||0,this.ty=r||0,this},e.append=function(t,e,i,n,s,r){var a=this.a,o=this.b,l=this.c,h=this.d;return 1==t&&0==e&&0==i&&1==n||(this.a=a*t+l*e,this.b=o*t+h*e,this.c=a*i+l*n,this.d=o*i+h*n),this.tx=a*s+l*r+this.tx,this.ty=o*s+h*r+this.ty,this},e.prepend=function(t,e,i,n,s,r){var a=this.a,o=this.c,l=this.tx;return this.a=t*a+i*this.b,this.b=e*a+n*this.b,this.c=t*o+i*this.d,this.d=e*o+n*this.d,this.tx=t*l+i*this.ty+s,this.ty=e*l+n*this.ty+r,this},e.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.appendTransform=function(e,i,n,s,r,a,o,l,h){if(r%360)var c=r*t.DEG_TO_RAD,u=Math.cos(c),d=Math.sin(c);else u=1,d=0;return a||o?(a*=t.DEG_TO_RAD,o*=t.DEG_TO_RAD,this.append(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),e,i),this.append(u*n,d*n,-d*s,u*s,0,0)):this.append(u*n,d*n,-d*s,u*s,e,i),(l||h)&&(this.tx-=l*this.a+h*this.c,this.ty-=l*this.b+h*this.d),this},e.prependTransform=function(e,i,n,s,r,a,o,l,h){if(r%360)var c=r*t.DEG_TO_RAD,u=Math.cos(c),d=Math.sin(c);else u=1,d=0;return(l||h)&&(this.tx-=l,this.ty-=h),a||o?(a*=t.DEG_TO_RAD,o*=t.DEG_TO_RAD,this.prepend(u*n,d*n,-d*s,u*s,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),e,i)):this.prepend(u*n,d*n,-d*s,u*s,e,i),this},e.rotate=function(e){e*=t.DEG_TO_RAD;var i=Math.cos(e),n=Math.sin(e),s=this.a,r=this.b;return this.a=s*i+this.c*n,this.b=r*i+this.d*n,this.c=-s*n+this.c*i,this.d=-r*n+this.d*i,this},e.skew=function(e,i){return e*=t.DEG_TO_RAD,i*=t.DEG_TO_RAD,this.append(Math.cos(i),Math.sin(i),-Math.sin(e),Math.cos(e),0,0),this},e.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},e.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},e.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},e.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(t*this.ty-e*s)/r,this},e.isIdentity=function(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d},e.equals=function(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d},e.transformPoint=function(t,e,i){return i=i||{},i.x=t*this.a+e*this.c+this.tx,i.y=t*this.b+e*this.d+this.ty,i},e.decompose=function(e){null==e&&(e={}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var i=Math.atan2(-this.c,this.d),n=Math.atan2(this.b,this.a),s=Math.abs(1-i/n);return s<1e-5?(e.rotation=n/t.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=i/t.DEG_TO_RAD,e.skewY=n/t.DEG_TO_RAD),e},e.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},e.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)},e.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},t.identity=new t,af.Matrix2D=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,s){this.setValues(t,e,i,n,s)}var e=t.prototype;e.setValues=function(t,e,i,n,s){return this.visible=null==t||!!t,this.alpha=null==e?1:e,this.shadow=i,this.compositeOperation=n,this.matrix=s||this.matrix&&this.matrix.identity()||new af.Matrix2D,this},e.append=function(t,e,i,n,s){return this.alpha*=e,this.shadow=i||this.shadow,this.compositeOperation=n||this.compositeOperation,this.visible=this.visible&&t,s&&this.matrix.appendMatrix(s),this},e.prepend=function(t,e,i,n,s){return this.alpha*=e,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||n,this.visible=this.visible&&t,s&&this.matrix.prependMatrix(s),this},e.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},e.clone=function(){return new t(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},af.DisplayProps=t}(),this.createjs=this.createjs||{},function(){function t(t,e){this.setValues(t,e)}var e=t.prototype;e.setValues=function(t,e){return this.x=t||0,this.y=e||0,this},e.copy=function(t){return this.x=t.x,this.y=t.y,this},e.clone=function(){return new t(this.x,this.y)},e.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},af.Point=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.setValues(t,e,i,n)}var e=t.prototype;e.setValues=function(t,e,i,n){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0,this},e.extend=function(t,e,i,n){return i=i||0,n=n||0,t+i>this.x+this.width&&(this.width=t+i-this.x),e+n>this.y+this.height&&(this.height=e+n-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),e<this.y&&(this.height+=this.y-e,this.y=e),this},e.pad=function(t,e,i,n){return this.x-=e,this.y-=t,this.width+=e+n,this.height+=t+i,this},e.copy=function(t){return this.setValues(t.x,t.y,t.width,t.height)},e.contains=function(t,e,i,n){return i=i||0,n=n||0,t>=this.x&&t+i<=this.x+this.width&&e>=this.y&&e+n<=this.y+this.height},e.union=function(t){return this.clone().extend(t.x,t.y,t.width,t.height)},e.intersection=function(e){var i=e.x,n=e.y,s=i+e.width,r=n+e.height;return this.x>i&&(i=this.x),this.y>n&&(n=this.y),this.x+this.width<s&&(s=this.x+this.width),this.y+this.height<r&&(r=this.y+this.height),s<=i||r<=n?null:new t(i,n,s-i,r-n)},e.intersects=function(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height},e.isEmpty=function(){return this.width<=0||this.height<=0},e.clone=function(){return new t(this.x,this.y,this.width,this.height)},e.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"},af.Rectangle=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,s,r,a){t.addEventListener&&(this.target=t,this.overLabel=null==i?"over":i,this.outLabel=null==e?"out":e,this.downLabel=null==n?"down":n,this.play=s,this._isPressed=!1,this._isOver=!1,this._enabled=!1,t.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),r&&(a&&(r.actionsEnabled=!1,r.gotoAndStop&&r.gotoAndStop(a)),t.hitArea=r))}var e=t.prototype;e._setEnabled=function(t){if(t!=this._enabled){var e=this.target;this._enabled=t,t?(e.cursor="pointer",e.addEventListener("rollover",this),e.addEventListener("rollout",this),e.addEventListener("mousedown",this),e.addEventListener("pressup",this),e._reset&&(e.__reset=e._reset,e._reset=this._reset)):(e.cursor=null,e.removeEventListener("rollover",this),e.removeEventListener("rollout",this),e.removeEventListener("mousedown",this),e.removeEventListener("pressup",this),e.__reset&&(e._reset=e.__reset,delete e.__reset))}},e.setEnabled=af.deprecate(e._setEnabled,"ButtonHelper.setEnabled"),e._getEnabled=function(){return this._enabled},e.getEnabled=af.deprecate(e._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(e,{enabled:{get:e._getEnabled,set:e._setEnabled}})}catch(i){}e.toString=function(){return"[ButtonHelper]"},e.handleEvent=function(t){var e,i=this.target,n=t.type;"mousedown"==n?(this._isPressed=!0,e=this.downLabel):"pressup"==n?(this._isPressed=!1,e=this._isOver?this.overLabel:this.outLabel):"rollover"==n?(this._isOver=!0,e=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,e=this._isPressed?this.overLabel:this.outLabel),this.play?i.gotoAndPlay&&i.gotoAndPlay(e):i.gotoAndStop&&i.gotoAndStop(e)},e._reset=function(){var t=this.paused;this.__reset(),this.paused=t},af.ButtonHelper=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.color=t||"black",this.offsetX=e||0,this.offsetY=i||0,this.blur=n||0}var e=t.prototype;t.identity=new t("transparent",0,0,0),e.toString=function(){return"[Shadow]"},e.clone=function(){return new t(this.color,this.offsetX,this.offsetY,this.blur)},af.Shadow=t}(),this.createjs=this.createjs||{},function(){function t(t){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(t)}var i=af.extend(t,af.EventDispatcher);i._getAnimations=function(){return this._animations.slice()},i.getAnimations=af.deprecate(i._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(i,{animations:{get:i._getAnimations}})}catch(n){}i.getNumFrames=function(t){if(null==t)return this._frames?this._frames.length:this._numFrames||0;var e=this._data[t];return null==e?0:e.frames.length},i.getAnimation=function(t){return this._data[t]},i.getFrame=function(t){var e;return this._frames&&(e=this._frames[t])?e:null},i.getFrameBounds=function(t,e){var i=this.getFrame(t);return i?(e||new af.Rectangle).setValues(-i.regX,-i.regY,i.rect.width,i.rect.height):null},i.toString=function(){return"[SpriteSheet]"},i.clone=function(){throw"SpriteSheet cannot be cloned."},i._parseData=function(t){var i,n,s,r;if(null!=t){if(this.framerate=t.framerate||0,t.images&&(n=t.images.length)>0)for(r=this._images=[],i=0;i<n;i++){var a=t.images[i];if("string"==typeof a){var o=a;a=e.createElement("img"),a.src=o}r.push(a),a.getContext||a.naturalWidth||(this._loadCount++,this.complete=!1,function(t,e){a.onload=function(){t._handleImageLoad(e)}}(this,o),function(t,e){a.onerror=function(){t._handleImageError(e)}}(this,o))}if(null==t.frames);else if(Array.isArray(t.frames))for(this._frames=[],r=t.frames,i=0,n=r.length;i<n;i++){var l=r[i];this._frames.push({image:this._images[l[4]?l[4]:0],rect:new af.Rectangle(l[0],l[1],l[2],l[3]),regX:l[5]||0,regY:l[6]||0})}else s=t.frames,this._frameWidth=s.width,this._frameHeight=s.height,this._regX=s.regX||0,this._regY=s.regY||0,this._spacing=s.spacing||0,this._margin=s.margin||0,this._numFrames=s.count,0==this._loadCount&&this._calculateFrames();var h;if(this._animations=[],null!=(s=t.animations))for(h in this._data={},s){var c={name:h},u=s[h];if("number"==typeof u)r=c.frames=[u];else if(Array.isArray(u))if(1==u.length)c.frames=[u[0]];else for(c.speed=u[3],c.next=u[2],r=c.frames=[],i=u[0];i<=u[1];i++)r.push(i);else{c.speed=u.speed,c.next=u.next;var d=u.frames;r=c.frames="number"==typeof d?[d]:d.slice(0)}!0!==c.next&&void 0!==c.next||(c.next=h),(!1===c.next||r.length<2&&c.next==h)&&(c.next=null),c.speed||(c.speed=1),this._animations.push(h),this._data[h]=c}}},i._handleImageLoad=function(t){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},i._handleImageError=function(t){var e=new af.Event("error");e.src=t,this.dispatchEvent(e),0==--this._loadCount&&this.dispatchEvent("complete")},i._calculateFrames=function(){if(!this._frames&&0!=this._frameWidth){this._frames=[];var t=this._numFrames||1e5,e=0,i=this._frameWidth,n=this._frameHeight,s=this._spacing,r=this._margin;t:for(var a=0,o=this._images;a<o.length;a++){var l=o[a],h=l.width||l.naturalWidth,c=l.height||l.naturalHeight,u=r;while(u<=c-r-n){var d=r;while(d<=h-r-i){if(e>=t)break t;e++,this._frames.push({image:l,rect:new af.Rectangle(d,u,i,n),regX:this._regX,regY:this._regY}),d+=i+s}u+=n+s}}this._numFrames=e}},af.SpriteSheet=af.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}var i=t.prototype,n=t;t.getRGB=function(t,e,i,n){return null!=t&&null==i&&(n=e,i=255&t,e=t>>8&255,t=t>>16&255),null==n?"rgb("+t+","+e+","+i+")":"rgba("+t+","+e+","+i+","+n+")"},t.getHSL=function(t,e,i,n){return null==n?"hsl("+t%360+","+e+"%,"+i+"%)":"hsla("+t%360+","+e+"%,"+i+"%,"+n+")"},t.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},t.STROKE_CAPS_MAP=["butt","round","square"],t.STROKE_JOINTS_MAP=["miter","round","bevel"];var s=af.createCanvas?af.createCanvas():e.createElement("canvas");s.getContext&&(t._ctx=s.getContext("2d"),s.width=s.height=1),i._getInstructions=function(){return this._updateInstructions(),this._instructions},i.getInstructions=af.deprecate(i._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(i,{instructions:{get:i._getInstructions}})}catch(r){}i.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},i.draw=function(t,e){this._updateInstructions();for(var i=this._instructions,n=this._storeIndex,s=i.length;n<s;n++)i[n].exec(t,e)},i.drawAsPath=function(t){this._updateInstructions();for(var e,i=this._instructions,n=this._storeIndex,s=i.length;n<s;n++)!1!==(e=i[n]).path&&e.exec(t)},i.moveTo=function(t,e){return this.append(new n.MoveTo(t,e),!0)},i.lineTo=function(t,e){return this.append(new n.LineTo(t,e))},i.arcTo=function(t,e,i,s,r){return this.append(new n.ArcTo(t,e,i,s,r))},i.arc=function(t,e,i,s,r,a){return this.append(new n.Arc(t,e,i,s,r,a))},i.quadraticCurveTo=function(t,e,i,s){return this.append(new n.QuadraticCurveTo(t,e,i,s))},i.bezierCurveTo=function(t,e,i,s,r,a){return this.append(new n.BezierCurveTo(t,e,i,s,r,a))},i.rect=function(t,e,i,s){return this.append(new n.Rect(t,e,i,s))},i.closePath=function(){return this._activeInstructions.length?this.append(new n.ClosePath):this},i.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},i.beginFill=function(t){return this._setFill(t?new n.Fill(t):null)},i.beginLinearGradientFill=function(t,e,i,s,r,a){return this._setFill((new n.Fill).linearGradient(t,e,i,s,r,a))},i.beginRadialGradientFill=function(t,e,i,s,r,a,o,l){return this._setFill((new n.Fill).radialGradient(t,e,i,s,r,a,o,l))},i.beginBitmapFill=function(t,e,i){return this._setFill(new n.Fill(null,i).bitmap(t,e))},i.endFill=function(){return this.beginFill()},i.setStrokeStyle=function(t,e,i,s,r){return this._updateInstructions(!0),this._strokeStyle=this.command=new n.StrokeStyle(t,e,i,s,r),this._stroke&&(this._stroke.ignoreScale=r),this._strokeIgnoreScale=r,this},i.setStrokeDash=function(t,e){return this._updateInstructions(!0),this._strokeDash=this.command=new n.StrokeDash(t,e),this},i.beginStroke=function(t){return this._setStroke(t?new n.Stroke(t):null)},i.beginLinearGradientStroke=function(t,e,i,s,r,a){return this._setStroke((new n.Stroke).linearGradient(t,e,i,s,r,a))},i.beginRadialGradientStroke=function(t,e,i,s,r,a,o,l){return this._setStroke((new n.Stroke).radialGradient(t,e,i,s,r,a,o,l))},i.beginBitmapStroke=function(t,e){return this._setStroke((new n.Stroke).bitmap(t,e))},i.endStroke=function(){return this.beginStroke()},i.curveTo=i.quadraticCurveTo,i.drawRect=i.rect,i.drawRoundRect=function(t,e,i,n,s){return this.drawRoundRectComplex(t,e,i,n,s,s,s,s)},i.drawRoundRectComplex=function(t,e,i,s,r,a,o,l){return this.append(new n.RoundRect(t,e,i,s,r,a,o,l))},i.drawCircle=function(t,e,i){return this.append(new n.Circle(t,e,i))},i.drawEllipse=function(t,e,i,s){return this.append(new n.Ellipse(t,e,i,s))},i.drawPolyStar=function(t,e,i,s,r,a){return this.append(new n.PolyStar(t,e,i,s,r,a))},i.append=function(t,e){return this._activeInstructions.push(t),this.command=t,e||(this._dirty=!0),this},i.decodePath=function(e){var i=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],n=[2,2,4,6,0],s=0,r=e.length,a=[],o=0,l=0,h=t.BASE_64;while(s<r){var c=e.charAt(s),u=h[c],d=u>>3,f=i[d];if(!f||3&u)throw"bad path data (@"+s+"): "+c;var p=n[d];d||(o=l=0),a.length=0,s++;for(var m=2+(u>>2&1),g=0;g<p;g++){var v=h[e.charAt(s)],_=v>>5?-1:1;v=(31&v)<<6|h[e.charAt(s+1)],3==m&&(v=v<<6|h[e.charAt(s+2)]),v=_*v/10,g%2?o=v+=o:l=v+=l,a[g]=v,s+=m}f.apply(this,a)}return this},i.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},i.unstore=function(){return this._storeIndex=0,this},i.clone=function(){var e=new t;return e.command=this.command,e._stroke=this._stroke,e._strokeStyle=this._strokeStyle,e._strokeDash=this._strokeDash,e._strokeIgnoreScale=this._strokeIgnoreScale,e._fill=this._fill,e._instructions=this._instructions.slice(),e._commitIndex=this._commitIndex,e._activeInstructions=this._activeInstructions.slice(),e._dirty=this._dirty,e._storeIndex=this._storeIndex,e},i.toString=function(){return"[Graphics]"},i.mt=i.moveTo,i.lt=i.lineTo,i.at=i.arcTo,i.bt=i.bezierCurveTo,i.qt=i.quadraticCurveTo,i.a=i.arc,i.r=i.rect,i.cp=i.closePath,i.c=i.clear,i.f=i.beginFill,i.lf=i.beginLinearGradientFill,i.rf=i.beginRadialGradientFill,i.bf=i.beginBitmapFill,i.ef=i.endFill,i.ss=i.setStrokeStyle,i.sd=i.setStrokeDash,i.s=i.beginStroke,i.ls=i.beginLinearGradientStroke,i.rs=i.beginRadialGradientStroke,i.bs=i.beginBitmapStroke,i.es=i.endStroke,i.dr=i.drawRect,i.rr=i.drawRoundRect,i.rc=i.drawRoundRectComplex,i.dc=i.drawCircle,i.de=i.drawEllipse,i.dp=i.drawPolyStar,i.p=i.decodePath,i._updateInstructions=function(e){var i=this._instructions,n=this._activeInstructions,s=this._commitIndex;if(this._dirty&&n.length){i.length=s,i.push(t.beginCmd);var r=n.length,a=i.length;i.length=a+r;for(var o=0;o<r;o++)i[o+a]=n[o];this._fill&&i.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&i.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&i.push(this._strokeStyle),e&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),i.push(this._stroke)),this._dirty=!1}e&&(n.length=0,this._commitIndex=i.length)},i._setFill=function(t){return this._updateInstructions(!0),this.command=this._fill=t,this},i._setStroke=function(t){return this._updateInstructions(!0),(this.command=this._stroke=t)&&(t.ignoreScale=this._strokeIgnoreScale),this},(n.LineTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.lineTo(this.x,this.y)},(n.MoveTo=function(t,e){this.x=t,this.y=e}).prototype.exec=function(t){t.moveTo(this.x,this.y)},(n.ArcTo=function(t,e,i,n,s){this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.radius=s}).prototype.exec=function(t){t.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(n.Arc=function(t,e,i,n,s,r){this.x=t,this.y=e,this.radius=i,this.startAngle=n,this.endAngle=s,this.anticlockwise=!!r}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(n.QuadraticCurveTo=function(t,e,i,n){this.cpx=t,this.cpy=e,this.x=i,this.y=n}).prototype.exec=function(t){t.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(n.BezierCurveTo=function(t,e,i,n,s,r){this.cp1x=t,this.cp1y=e,this.cp2x=i,this.cp2y=n,this.x=s,this.y=r}).prototype.exec=function(t){t.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(n.Rect=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){t.rect(this.x,this.y,this.w,this.h)},(n.ClosePath=function(){}).prototype.exec=function(t){t.closePath()},(n.BeginPath=function(){}).prototype.exec=function(t){t.beginPath()},i=(n.Fill=function(t,e){this.style=t,this.matrix=e}).prototype,i.exec=function(t){if(this.style){t.fillStyle=this.style;var e=this.matrix;e&&(t.save(),t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)),t.fill(),e&&t.restore()}},i.linearGradient=function(e,i,n,s,r,a){for(var o=this.style=t._ctx.createLinearGradient(n,s,r,a),l=0,h=e.length;l<h;l++)o.addColorStop(i[l],e[l]);return o.props={colors:e,ratios:i,x0:n,y0:s,x1:r,y1:a,type:"linear"},this},i.radialGradient=function(e,i,n,s,r,a,o,l){for(var h=this.style=t._ctx.createRadialGradient(n,s,r,a,o,l),c=0,u=e.length;c<u;c++)h.addColorStop(i[c],e[c]);return h.props={colors:e,ratios:i,x0:n,y0:s,r0:r,x1:a,y1:o,r1:l,type:"radial"},this},i.bitmap=function(e,i){if(e.naturalWidth||e.getContext||e.readyState>=2){var n=this.style=t._ctx.createPattern(e,i||"");n.props={image:e,repetition:i,type:"bitmap"}}return this},i.path=!1,i=(n.Stroke=function(t,e){this.style=t,this.ignoreScale=e}).prototype,i.exec=function(t){this.style&&(t.strokeStyle=this.style,this.ignoreScale&&(t.save(),t.setTransform(1,0,0,1,0,0)),t.stroke(),this.ignoreScale&&t.restore())},i.linearGradient=n.Fill.prototype.linearGradient,i.radialGradient=n.Fill.prototype.radialGradient,i.bitmap=n.Fill.prototype.bitmap,i.path=!1,i=(n.StrokeStyle=function(t,e,i,n,s){this.width=t,this.caps=e,this.joints=i,this.miterLimit=n,this.ignoreScale=s}).prototype,i.exec=function(e){e.lineWidth=null==this.width?"1":this.width,e.lineCap=null==this.caps?"butt":isNaN(this.caps)?this.caps:t.STROKE_CAPS_MAP[this.caps],e.lineJoin=null==this.joints?"miter":isNaN(this.joints)?this.joints:t.STROKE_JOINTS_MAP[this.joints],e.miterLimit=null==this.miterLimit?"10":this.miterLimit,e.ignoreScale=null!=this.ignoreScale&&this.ignoreScale},i.path=!1,(n.StrokeDash=function(t,e){this.segments=t,this.offset=e||0}).prototype.exec=function(t){t.setLineDash&&(t.setLineDash(this.segments||n.StrokeDash.EMPTY_SEGMENTS),t.lineDashOffset=this.offset||0)},n.StrokeDash.EMPTY_SEGMENTS=[],(n.RoundRect=function(t,e,i,n,s,r,a,o){this.x=t,this.y=e,this.w=i,this.h=n,this.radiusTL=s,this.radiusTR=r,this.radiusBR=a,this.radiusBL=o}).prototype.exec=function(t){var e=(l<h?l:h)/2,i=0,n=0,s=0,r=0,a=this.x,o=this.y,l=this.w,h=this.h,c=this.radiusTL,u=this.radiusTR,d=this.radiusBR,f=this.radiusBL;c<0&&(c*=i=-1),c>e&&(c=e),u<0&&(u*=n=-1),u>e&&(u=e),d<0&&(d*=s=-1),d>e&&(d=e),f<0&&(f*=r=-1),f>e&&(f=e),t.moveTo(a+l-u,o),t.arcTo(a+l+u*n,o-u*n,a+l,o+u,u),t.lineTo(a+l,o+h-d),t.arcTo(a+l+d*s,o+h+d*s,a+l-d,o+h,d),t.lineTo(a+f,o+h),t.arcTo(a-f*r,o+h+f*r,a,o+h-f,f),t.lineTo(a,o+c),t.arcTo(a-c*i,o-c*i,a+c,o,c),t.closePath()},(n.Circle=function(t,e,i){this.x=t,this.y=e,this.radius=i}).prototype.exec=function(t){t.arc(this.x,this.y,this.radius,0,2*Math.PI)},(n.Ellipse=function(t,e,i,n){this.x=t,this.y=e,this.w=i,this.h=n}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.w,s=this.h,r=.5522848,a=n/2*r,o=s/2*r,l=e+n,h=i+s,c=e+n/2,u=i+s/2;t.moveTo(e,u),t.bezierCurveTo(e,u-o,c-a,i,c,i),t.bezierCurveTo(c+a,i,l,u-o,l,u),t.bezierCurveTo(l,u+o,c+a,h,c,h),t.bezierCurveTo(c-a,h,e,u+o,e,u)},(n.PolyStar=function(t,e,i,n,s,r){this.x=t,this.y=e,this.radius=i,this.sides=n,this.pointSize=s,this.angle=r}).prototype.exec=function(t){var e=this.x,i=this.y,n=this.radius,s=(this.angle||0)/180*Math.PI,r=this.sides,a=1-(this.pointSize||0),o=Math.PI/r;t.moveTo(e+Math.cos(s)*n,i+Math.sin(s)*n);for(var l=0;l<r;l++)s+=o,1!=a&&t.lineTo(e+Math.cos(s)*n*a,i+Math.sin(s)*n*a),s+=o,t.lineTo(e+Math.cos(s)*n,i+Math.sin(s)*n);t.closePath()},t.beginCmd=new n.BeginPath,af.Graphics=t}(),this.createjs=this.createjs||{},function(){function t(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=af.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new af.DisplayProps,this._rectangle=new af.Rectangle,this._bounds=null,this._webGLRenderStyle=t._StageGL_NONE}var i=af.extend(t,af.EventDispatcher);t._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],t.suppressCrossDomainErrors=!1,t._snapToPixelEnabled=!1,t._StageGL_NONE=0,t._StageGL_SPRITE=1,t._StageGL_BITMAP=2;var n=af.createCanvas?af.createCanvas():e.createElement("canvas");n.getContext&&(t._hitTestCanvas=n,t._hitTestContext=n.getContext("2d"),n.width=n.height=1),i._getStage=function(){var t=this,e=af["Stage"];while(t.parent)t=t.parent;return t instanceof e?t:null},i.getStage=af.deprecate(i._getStage,"DisplayObject.getStage");try{Object.defineProperties(i,{stage:{get:i._getStage},cacheID:{get:function(){return this.bitmapCache&&this.bitmapCache.cacheID},set:function(t){this.bitmapCache&&(this.bitmapCache.cacheID=t)}},scale:{get:function(){return this.scaleX},set:function(t){this.scaleX=this.scaleY=t}}})}catch(s){}i.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},i.draw=function(t,e){var i=this.bitmapCache;return!(!i||e)&&i.draw(t)},i.updateContext=function(e){var i=this,n=i.mask,s=i._props.matrix;n&&n.graphics&&!n.graphics.isEmpty()&&(n.getMatrix(s),e.transform(s.a,s.b,s.c,s.d,s.tx,s.ty),n.graphics.drawAsPath(e),e.clip(),s.invert(),e.transform(s.a,s.b,s.c,s.d,s.tx,s.ty)),this.getMatrix(s);var r=s.tx,a=s.ty;t._snapToPixelEnabled&&i.snapToPixel&&(r=r+(r<0?-.5:.5)|0,a=a+(a<0?-.5:.5)|0),e.transform(s.a,s.b,s.c,s.d,r,a),e.globalAlpha*=i.alpha,i.compositeOperation&&(e.globalCompositeOperation=i.compositeOperation),i.shadow&&this._applyShadow(e,i.shadow)},i.cache=function(t,e,i,n,s,r){this.bitmapCache||(this.bitmapCache=new af.BitmapCache),this.bitmapCache.define(this,t,e,i,n,s,r)},i.updateCache=function(t){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(t)},i.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},i.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getDataURL():null},i.localToGlobal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(t,e,i||new af.Point)},i.globalToLocal=function(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(t,e,i||new af.Point)},i.localToLocal=function(t,e,i,n){return n=this.localToGlobal(t,e,n),i.globalToLocal(n.x,n.y,n)},i.setTransform=function(t,e,i,n,s,r,a,o,l){return this.x=t||0,this.y=e||0,this.scaleX=null==i?1:i,this.scaleY=null==n?1:n,this.rotation=s||0,this.skewX=r||0,this.skewY=a||0,this.regX=o||0,this.regY=l||0,this},i.getMatrix=function(t){var e=this,i=t&&t.identity()||new af.Matrix2D;return e.transformMatrix?i.copy(e.transformMatrix):i.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY)},i.getConcatenatedMatrix=function(t){var e=this,i=this.getMatrix(t);while(e=e.parent)i.prependMatrix(e.getMatrix(e._props.matrix));return i},i.getConcatenatedDisplayProps=function(t){t=t?t.identity():new af.DisplayProps;var e=this,i=e.getMatrix(t.matrix);do{t.prepend(e.visible,e.alpha,e.shadow,e.compositeOperation),e!=this&&i.prependMatrix(e.getMatrix(e._props.matrix))}while(e=e.parent);return t},i.hitTest=function(e,i){var n=t._hitTestContext;n.setTransform(1,0,0,1,-e,-i),this.draw(n);var s=this._testHit(n);return n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,2,2),s},i.set=function(t){for(var e in t)this[e]=t[e];return this},i.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var t=this.cacheCanvas;if(t){var e=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,t.width/e,t.height/e)}return null},i.getTransformedBounds=function(){return this._getBounds()},i.setBounds=function(t,e,i,n){this._bounds=null!=t?(this._bounds||new af.Rectangle).setValues(t,e,i,n):t},i.clone=function(){return this._cloneProps(new t)},i.toString=function(){return"[DisplayObject (name="+this.name+")]"},i._updateState=null,i._cloneProps=function(t){return t.alpha=this.alpha,t.mouseEnabled=this.mouseEnabled,t.tickEnabled=this.tickEnabled,t.name=this.name,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.shadow=this.shadow,t.skewX=this.skewX,t.skewY=this.skewY,t.visible=this.visible,t.x=this.x,t.y=this.y,t.compositeOperation=this.compositeOperation,t.snapToPixel=this.snapToPixel,t.filters=null==this.filters?null:this.filters.slice(0),t.mask=this.mask,t.hitArea=this.hitArea,t.cursor=this.cursor,t._bounds=this._bounds,t},i._applyShadow=function(t,e){e=e||Shadow.identity,t.shadowColor=e.color,t.shadowOffsetX=e.offsetX,t.shadowOffsetY=e.offsetY,t.shadowBlur=e.blur},i._tick=function(t){var e=this._listeners;e&&e["tick"]&&(t.target=null,t.propagationStopped=t.immediatePropagationStopped=!1,this.dispatchEvent(t))},i._testHit=function(e){try{var i=e.getImageData(0,0,1,1).data[3]>1}catch(s){if(!t.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return i},i._getBounds=function(t,e){return this._transformBounds(this.getBounds(),t,e)},i._transformBounds=function(t,e,i){if(!t)return t;var n=t.x,s=t.y,r=t.width,a=t.height,o=this._props.matrix;o=i?o.identity():this.getMatrix(o),(n||s)&&o.appendTransform(0,0,1,1,0,0,0,-n,-s),e&&o.prependMatrix(e);var l=r*o.a,h=r*o.b,c=a*o.c,u=a*o.d,d=o.tx,f=o.ty,p=d,m=d,g=f,v=f;return(n=l+d)<p?p=n:n>m&&(m=n),(n=l+c+d)<p?p=n:n>m&&(m=n),(n=c+d)<p?p=n:n>m&&(m=n),(s=h+f)<g?g=s:s>v&&(v=s),(s=h+u+f)<g?g=s:s>v&&(v=s),(s=u+f)<g?g=s:s>v&&(v=s),t.setValues(p,g,m-p,v-g)},i._hasMouseEventListener=function(){for(var e=t._MOUSE_EVENTS,i=0,n=e.length;i<n;i++)if(this.hasEventListener(e[i]))return!0;return!!this.cursor},af.DisplayObject=af.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}var e=af.extend(t,af.DisplayObject);e._getNumChildren=function(){return this.children.length},e.getNumChildren=af.deprecate(e._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(e,{numChildren:{get:e._getNumChildren}})}catch(i){}e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;for(var i=this.children.slice(),n=0,s=i.length;n<s;n++){var r=i[n];r.isVisible()&&(t.save(),r.updateContext(t),r.draw(t),t.restore())}return!0},e.addChild=function(t){if(null==t)return t;var e=arguments.length;if(e>1){for(var i=0;i<e;i++)this.addChild(arguments[i]);return arguments[e-1]}var n=t.parent,s=n===this;return n&&n._removeChildAt(af.indexOf(n.children,t),s),t.parent=this,this.children.push(t),s||t.dispatchEvent("added"),t},e.addChildAt=function(t,e){var i=arguments.length,n=arguments[i-1];if(n<0||n>this.children.length)return arguments[i-2];if(i>2){for(var s=0;s<i-1;s++)this.addChildAt(arguments[s],n+s);return arguments[i-2]}var r=t.parent,a=r===this;return r&&r._removeChildAt(af.indexOf(r.children,t),a),t.parent=this,this.children.splice(e,0,t),a||t.dispatchEvent("added"),t},e.removeChild=function(t){var e=arguments.length;if(e>1){for(var i=!0,n=0;n<e;n++)i=i&&this.removeChild(arguments[n]);return i}return this._removeChildAt(af.indexOf(this.children,t))},e.removeChildAt=function(t){var e=arguments.length;if(e>1){for(var i=[],n=0;n<e;n++)i[n]=arguments[n];i.sort((function(t,e){return e-t}));var s=!0;for(n=0;n<e;n++)s=s&&this._removeChildAt(i[n]);return s}return this._removeChildAt(t)},e.removeAllChildren=function(){var t=this.children;while(t.length)this._removeChildAt(0)},e.getChildAt=function(t){return this.children[t]},e.getChildByName=function(t){for(var e=this.children,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},e.sortChildren=function(t){this.children.sort(t)},e.getChildIndex=function(t){return af.indexOf(this.children,t)},e.swapChildrenAt=function(t,e){var i=this.children,n=i[t],s=i[e];n&&s&&(i[t]=s,i[e]=n)},e.swapChildren=function(t,e){for(var i,n,s=this.children,r=0,a=s.length;r<a;r++)if(s[r]==t&&(i=r),s[r]==e&&(n=r),null!=i&&null!=n)break;r!=a&&(s[i]=e,s[n]=t)},e.setChildIndex=function(t,e){var i=this.children,n=i.length;if(!(t.parent!=this||e<0||e>=n)){for(var s=0;s<n;s++)if(i[s]==t)break;s!=n&&s!=e&&(i.splice(s,1),i.splice(e,0,t))}},e.contains=function(t){while(t){if(t==this)return!0;t=t.parent}return!1},e.hitTest=function(t,e){return null!=this.getObjectUnderPoint(t,e)},e.getObjectsUnderPoint=function(t,e,i){var n=[],s=this.localToGlobal(t,e);return this._getObjectsUnderPoint(s.x,s.y,n,i>0,1==i),n},e.getObjectUnderPoint=function(t,e,i){var n=this.localToGlobal(t,e);return this._getObjectsUnderPoint(n.x,n.y,null,i>0,1==i)},e.getBounds=function(){return this._getBounds(null,!0)},e.getTransformedBounds=function(){return this._getBounds()},e.clone=function(e){var i=this._cloneProps(new t);return e&&this._cloneChildren(i),i},e.toString=function(){return"[Container (name="+this.name+")]"},e._tick=function(t){if(this.tickChildren)for(var e=this.children.length-1;e>=0;e--){var i=this.children[e];i.tickEnabled&&i._tick&&i._tick(t)}this.DisplayObject__tick(t)},e._cloneChildren=function(t){t.children.length&&t.removeAllChildren();for(var e=t.children,i=0,n=this.children.length;i<n;i++){var s=this.children[i].clone(!0);s.parent=t,e.push(s)}},e._removeChildAt=function(t,e){if(t<0||t>this.children.length-1)return!1;var i=this.children[t];return i&&(i.parent=null),this.children.splice(t,1),e||i.dispatchEvent("removed"),!0},e._getObjectsUnderPoint=function(e,i,n,s,r,a){if(a=a||0,!a&&!this._testMask(this,e,i))return null;var o,l=af.DisplayObject._hitTestContext;r=r||s&&this._hasMouseEventListener();for(var h=this.children,c=h.length,u=c-1;u>=0;u--){var d=h[u],f=d.hitArea;if(d.visible&&(f||d.isVisible())&&(!s||d.mouseEnabled)&&(f||this._testMask(d,e,i)))if(!f&&d instanceof t){var p=d._getObjectsUnderPoint(e,i,n,s,r,a+1);if(!n&&p)return s&&!this.mouseChildren?this:p}else{if(s&&!r&&!d._hasMouseEventListener())continue;var m=d.getConcatenatedDisplayProps(d._props);if(o=m.matrix,f&&(o.appendMatrix(f.getMatrix(f._props.matrix)),m.alpha=f.alpha),l.globalAlpha=m.alpha,l.setTransform(o.a,o.b,o.c,o.d,o.tx-e,o.ty-i),(f||d).draw(l),!this._testHit(l))continue;if(l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,2,2),!n)return s&&!this.mouseChildren?this:d;n.push(d)}}return null},e._testMask=function(t,e,i){var n=t.mask;if(!n||!n.graphics||n.graphics.isEmpty())return!0;var s=this._props.matrix,r=t.parent;s=r?r.getConcatenatedMatrix(s):s.identity(),s=n.getMatrix(n._props.matrix).prependMatrix(s);var a=af.DisplayObject._hitTestContext;return a.setTransform(s.a,s.b,s.c,s.d,s.tx-e,s.ty-i),n.graphics.drawAsPath(a),a.fillStyle="#000",a.fill(),!!this._testHit(a)&&(a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,2,2),!0)},e._getBounds=function(t,e){var i=this.DisplayObject_getBounds();if(i)return this._transformBounds(i,t,e);var n=this._props.matrix;n=e?n.identity():this.getMatrix(n),t&&n.prependMatrix(t);for(var s=this.children.length,r=null,a=0;a<s;a++){var o=this.children[a];o.visible&&(i=o._getBounds(n))&&(r?r.extend(i.x,i.y,i.width,i.height):r=i.clone())}return r},af.Container=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function i(t){this.Container_constructor(),this.autoClear=!0,this.canvas="string"==typeof t?e.getElementById(t):t,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}var n=af.extend(i,af.Container);n._get_nextStage=function(){return this._nextStage},n._set_nextStage=function(t){this._nextStage&&(this._nextStage._prevStage=null),t&&(t._prevStage=this),this._nextStage=t};try{Object.defineProperties(n,{nextStage:{get:n._get_nextStage,set:n._set_nextStage}})}catch(s){}n.update=function(t){if(this.canvas&&(this.tickOnUpdate&&this.tick(t),!1!==this.dispatchEvent("drawstart",!1,!0))){af.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;var e=this.drawRect,i=this.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0),this.autoClear&&(e?i.clearRect(e.x,e.y,e.width,e.height):i.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),i.save(),this.drawRect&&(i.beginPath(),i.rect(e.x,e.y,e.width,e.height),i.clip()),this.updateContext(i),this.draw(i,!1),i.restore(),this.dispatchEvent("drawend")}},n.tick=function(t){if(this.tickEnabled&&!1!==this.dispatchEvent("tickstart",!1,!0)){var e=new af.Event("tick");if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);this._tick(e),this.dispatchEvent("tickend")}},n.handleEvent=function(t){"tick"==t.type&&this.update(t)},n.clear=function(){if(this.canvas){var t=this.canvas.getContext("2d");t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}},n.toDataURL=function(t,e){var i,n=this.canvas.getContext("2d"),s=this.canvas.width,r=this.canvas.height;if(t){i=n.getImageData(0,0,s,r);var a=n.globalCompositeOperation;n.globalCompositeOperation="destination-over",n.fillStyle=t,n.fillRect(0,0,s,r)}var o=this.canvas.toDataURL(e||"image/png");return t&&(n.putImageData(i,0,0),n.globalCompositeOperation=a),o},n.enableMouseOver=function(t){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0==t&&this._testMouseOver(!0)),null==t)t=20;else if(t<=0)return;var e=this;this._mouseOverIntervalID=setInterval((function(){e._testMouseOver()}),1e3/Math.min(50,t))},n.enableDOMEvents=function(i){null==i&&(i=!0);var n,s,r=this._eventListeners;if(!i&&r){for(n in r)s=r[n],s.t.removeEventListener(n,s.f,!1);this._eventListeners=null}else if(i&&!r&&this.canvas){var a=t.addEventListener?t:e,o=this;for(n in r=this._eventListeners={},r["mouseup"]={t:a,f:function(t){o._handleMouseUp(t)}},r["mousemove"]={t:a,f:function(t){o._handleMouseMove(t)}},r["dblclick"]={t:this.canvas,f:function(t){o._handleDoubleClick(t)}},r["mousedown"]={t:this.canvas,f:function(t){o._handleMouseDown(t)}},r)s=r[n],s.t.addEventListener(n,s.f,!1)}},n.clone=function(){throw"Stage cannot be cloned."},n.toString=function(){return"[Stage (name="+this.name+")]"},n._getElementRect=function(i){var n;try{n=i.getBoundingClientRect()}catch(u){n={top:i.offsetTop,left:i.offsetLeft,width:i.offsetWidth,height:i.offsetHeight}}var s=(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||e.body.clientLeft||0),r=(t.pageYOffset||e.scrollTop||0)-(e.clientTop||e.body.clientTop||0),a=t.getComputedStyle?getComputedStyle(i,null):i.currentStyle,o=parseInt(a.paddingLeft)+parseInt(a.borderLeftWidth),l=parseInt(a.paddingTop)+parseInt(a.borderTopWidth),h=parseInt(a.paddingRight)+parseInt(a.borderRightWidth),c=parseInt(a.paddingBottom)+parseInt(a.borderBottomWidth);return{left:n.left+s+o,right:n.right+s-h,top:n.top+r+l,bottom:n.bottom+r-c}},n._getPointerData=function(t){var e=this._pointerData[t];return e||(e=this._pointerData[t]={x:0,y:0}),e},n._handleMouseMove=function(e){e||(e=t.event),this._handlePointerMove(-1,e,e.pageX,e.pageY)},n._handlePointerMove=function(t,e,i,n,s){if((!this._prevStage||void 0!==s)&&this.canvas){var r=this._nextStage,a=this._getPointerData(t),o=a.inBounds;this._updatePointerPosition(t,e,i,n),(o||a.inBounds||this.mouseMoveOutside)&&(-1===t&&a.inBounds==!o&&this._dispatchMouseEvent(this,o?"mouseleave":"mouseenter",!1,t,a,e),this._dispatchMouseEvent(this,"stagemousemove",!1,t,a,e),this._dispatchMouseEvent(a.target,"pressmove",!0,t,a,e)),r&&r._handlePointerMove(t,e,i,n,null)}},n._updatePointerPosition=function(t,e,i,n){var s=this._getElementRect(this.canvas);i-=s.left,n-=s.top;var r=this.canvas.width,a=this.canvas.height;i/=(s.right-s.left)/r,n/=(s.bottom-s.top)/a;var o=this._getPointerData(t);(o.inBounds=i>=0&&n>=0&&i<=r-1&&n<=a-1)?(o.x=i,o.y=n):this.mouseMoveOutside&&(o.x=i<0?0:i>r-1?r-1:i,o.y=n<0?0:n>a-1?a-1:n),o.posEvtObj=e,o.rawX=i,o.rawY=n,t!==this._primaryPointerID&&-1!==t||(this.mouseX=o.x,this.mouseY=o.y,this.mouseInBounds=o.inBounds)},n._handleMouseUp=function(t){this._handlePointerUp(-1,t,!1)},n._handlePointerUp=function(t,e,i,n){var s=this._nextStage,r=this._getPointerData(t);if(!this._prevStage||void 0!==n){var a=null,o=r.target;n||!o&&!s||(a=this._getObjectsUnderPoint(r.x,r.y,null,!0)),r.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,t,r,e,a),r.down=!1),a==o&&this._dispatchMouseEvent(o,"click",!0,t,r,e),this._dispatchMouseEvent(o,"pressup",!0,t,r,e),i?(t==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[t]):r.target=null,s&&s._handlePointerUp(t,e,i,n||a&&this)}},n._handleMouseDown=function(t){this._handlePointerDown(-1,t,t.pageX,t.pageY)},n._handlePointerDown=function(t,e,i,n,s){this.preventSelection&&e.preventDefault(),null!=this._primaryPointerID&&-1!==t||(this._primaryPointerID=t),null!=n&&this._updatePointerPosition(t,e,i,n);var r=null,a=this._nextStage,o=this._getPointerData(t);s||(r=o.target=this._getObjectsUnderPoint(o.x,o.y,null,!0)),o.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,t,o,e,r),o.down=!0),this._dispatchMouseEvent(r,"mousedown",!0,t,o,e),a&&a._handlePointerDown(t,e,i,n,s||r&&this)},n._testMouseOver=function(t,e,i){if(!this._prevStage||void 0!==e){var n=this._nextStage;if(this._mouseOverIntervalID){var s=this._getPointerData(-1);if(s&&(t||this.mouseX!=this._mouseOverX||this.mouseY!=this._mouseOverY||!this.mouseInBounds)){var r,a,o,l=s.posEvtObj,h=i||l&&l.target==this.canvas,c=null,u=-1,d="";!e&&(t||this.mouseInBounds&&h)&&(c=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);var f=this._mouseOverTarget||[],p=f[f.length-1],m=this._mouseOverTarget=[];r=c;while(r)m.unshift(r),d||(d=r.cursor),r=r.parent;for(this.canvas.style.cursor=d,!e&&i&&(i.canvas.style.cursor=d),a=0,o=m.length;a<o;a++){if(m[a]!=f[a])break;u=a}for(p!=c&&this._dispatchMouseEvent(p,"mouseout",!0,-1,s,l,c),a=f.length-1;a>u;a--)this._dispatchMouseEvent(f[a],"rollout",!1,-1,s,l,c);for(a=m.length-1;a>u;a--)this._dispatchMouseEvent(m[a],"rollover",!1,-1,s,l,p);p!=c&&this._dispatchMouseEvent(c,"mouseover",!0,-1,s,l,p),n&&n._testMouseOver(t,e||c&&this,i||h&&this)}}else n&&n._testMouseOver(t,e,i)}},n._handleDoubleClick=function(t,e){var i=null,n=this._nextStage,s=this._getPointerData(-1);e||(i=this._getObjectsUnderPoint(s.x,s.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,s,t)),n&&n._handleDoubleClick(t,e||i&&this)},n._dispatchMouseEvent=function(t,e,i,n,s,r,a){if(t&&(i||t.hasEventListener(e))){var o=new af.MouseEvent(e,i,!1,s.x,s.y,r,n,n===this._primaryPointerID||-1===n,s.rawX,s.rawY,a);t.dispatchEvent(o)}},af.Stage=af.promote(i,"Container")}(),this.createjs=this.createjs||{},function(){function t(e,i){if(this.Stage_constructor(e),void 0!==i){if("object"!==typeof i)throw"Invalid options object";var n=i.premultiply,s=i.transparent,r=i.antialias,a=i.preserveBuffer,o=i.autoPurge}this.vocalDebug=!1,this._preserveBuffer=a||!1,this._antialias=r||!1,this._transparent=s||!1,this._premultiply=n||!1,this._autoPurge=void 0,this.autoPurge=o,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=t.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new af.Container,this._initializeWebGL()}var e=af.extend(t,af.Stage);t.buildUVRects=function(t,e,i){if(!t||!t._frames)return null;void 0===e&&(e=-1),void 0===i&&(i=!1);for(var n=-1!=e&&i?e:0,s=-1!=e&&i?e+1:t._frames.length,r=n;r<s;r++){var a=t._frames[r];if(!(a.uvRect||a.image.width<=0||a.image.height<=0)){var o=a.rect;a.uvRect={t:o.y/a.image.height,l:o.x/a.image.width,b:(o.y+o.height)/a.image.height,r:(o.x+o.width)/a.image.width}}}return t._frames[-1!=e?e:0].uvRect||{t:0,l:0,b:1,r:1}},t.isWebGLActive=function(t){return t&&t instanceof WebGLRenderingContext&&"undefined"!==typeof WebGLRenderingContext},t.VERTEX_PROPERTY_COUNT=6,t.INDICIES_PER_CARD=6,t.DEFAULT_MAX_BATCH_SIZE=1e4,t.WEBGL_MAX_INDEX_NUM=Math.pow(2,16),t.UV_RECT={t:0,l:0,b:1,r:1};try{t.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),t.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),t.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch(i){}t.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;",t.REGULAR_VERTEX_HEADER=t.REGULAR_VARYING_HEADER+"attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;",t.REGULAR_FRAGMENT_HEADER=t.REGULAR_VARYING_HEADER+"uniform sampler2D uSampler[{{count}}];",t.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",t.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",t.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",t.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",t.PARTICLE_VERTEX_BODY=t.REGULAR_VERTEX_BODY,t.PARTICLE_FRAGMENT_BODY=t.REGULAR_FRAGMENT_BODY,t.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;",t.COVER_VERTEX_HEADER=t.COVER_VARYING_HEADER+"attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;",t.COVER_FRAGMENT_HEADER=t.COVER_VARYING_HEADER+"uniform sampler2D uSampler;",t.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",t.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",e._get_isWebGL=function(){return!!this._webGLContext},e._set_autoPurge=function(t){t=isNaN(t)?1200:t,-1!=t&&(t=t<10?10:t),this._autoPurge=t},e._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(e,{isWebGL:{get:e._get_isWebGL},autoPurge:{get:e._get_autoPurge,set:e._set_autoPurge}})}catch(i){}e._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){var t={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},e=this._webGLContext=this._fetchWebGLContext(this.canvas,t);if(!e)return null;this.updateSimultaneousTextureCount(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(e),this._initTextures(e),e.disable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},e.update=function(t){if(this.canvas){if(this.tickOnUpdate&&this.tick(t),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext)this._batchDraw(this,this._webGLContext),-1==this._autoPurge||this._drawID%(this._autoPurge/2|0)||this.purgeTextures(this._autoPurge);else{var e=this.canvas.getContext("2d");e.save(),this.updateContext(e),this.draw(e,!1),e.restore()}this.dispatchEvent("drawend")}},e.clear=function(){if(this.canvas)if(t.isWebGLActive(this._webGLContext)){var e=this._webGLContext,i=this._clearColor,n=this._transparent?i.a:1;this._webGLContext.clearColor(i.r*n,i.g*n,i.b*n,n),e.clear(e.COLOR_BUFFER_BIT),this._webGLContext.clearColor(i.r,i.g,i.b,i.a)}else this.Stage_clear()},e.draw=function(e,i){if(e===this._webGLContext&&t.isWebGLActive(this._webGLContext)){var n=this._webGLContext;return this._batchDraw(this,n,i),!0}return this.Stage_draw(e,i)},e.cacheDraw=function(e,i,n){if(t.isWebGLActive(this._webGLContext)){var s=this._webGLContext;return this._cacheDraw(s,e,i,n),!0}return!1},e.protectTextureSlot=function(t,e){if(t>this._maxTextureSlots||t<0)throw"Slot outside of acceptable range";this._slotBlacklist[t]=!!e},e.getTargetRenderTexture=function(t,e,i){var n,s=!1,r=this._webGLContext;if(void 0!==t.__lastRT&&t.__lastRT===t.__rtA&&(s=!0),s?(void 0===t.__rtB?t.__rtB=this.getRenderBufferTexture(e,i):(e==t.__rtB._width&&i==t.__rtB._height||this.resizeTexture(t.__rtB,e,i),this.setTextureParams(r)),n=t.__rtB):(void 0===t.__rtA?t.__rtA=this.getRenderBufferTexture(e,i):(e==t.__rtA._width&&i==t.__rtA._height||this.resizeTexture(t.__rtA,e,i),this.setTextureParams(r)),n=t.__rtA),!n)throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return t.__lastRT=n,n},e.releaseTexture=function(t){var e,i;if(t){if(t.children)for(e=0,i=t.children.length;e<i;e++)this.releaseTexture(t.children[e]);t.cacheCanvas&&t.uncache();var n=void 0;if(void 0!==t._storeID){if(t===this._textureDictionary[t._storeID])return this._killTextureObject(t),void(t._storeID=void 0);n=t}else if(2===t._webGLRenderStyle)n=t.image;else if(1===t._webGLRenderStyle){for(e=0,i=t.spriteSheet._images.length;e<i;e++)this.releaseTexture(t.spriteSheet._images[e]);return}void 0!==n?(this._killTextureObject(this._textureDictionary[n._storeID]),n._storeID=void 0):this.vocalDebug&&console.log("No associated texture found on release")}},e.purgeTextures=function(t){void 0==t&&(t=100);for(var e=this._textureDictionary,i=e.length,n=0;n<i;n++){var s=e[n];s&&(s._drawID+t<=this._drawID&&this._killTextureObject(s))}},e.updateSimultaneousTextureCount=function(t){var e=this._webGLContext,n=!1;(t<1||isNaN(t))&&(t=1),this._batchTextureCount=t;while(!n)try{this._activeShader=this._fetchShaderProgram(e),n=!0}catch(i){if(1==this._batchTextureCount)throw"Cannot compile shader "+i;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&console.log("Reducing desired texture count due to errors: "+this._batchTextureCount)}},e.updateViewport=function(t,e){this._viewportWidth=0|t,this._viewportHeight=0|e;var i=this._webGLContext;i&&(i.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},e.getFilterShader=function(t){t||(t=this);var e=this._webGLContext,n=this._activeShader;if(t._builtShader)n=t._builtShader,t.shaderParamSetup&&(e.useProgram(n),t.shaderParamSetup(e,this,n));else try{n=this._fetchShaderProgram(e,"filter",t.VTX_SHADER_BODY,t.FRAG_SHADER_BODY,t.shaderParamSetup&&t.shaderParamSetup.bind(t)),t._builtShader=n,n._name=t.toString()}catch(i){console&&console.log("SHADER SWITCH FAILURE",i)}return n},e.getBaseTexture=function(t,e){var i=Math.ceil(t>0?t:1)||1,n=Math.ceil(e>0?e:1)||1,s=this._webGLContext,r=s.createTexture();return this.resizeTexture(r,i,n),this.setTextureParams(s,!1),r},e.resizeTexture=function(t,e,i){var n=this._webGLContext;n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,i,0,n.RGBA,n.UNSIGNED_BYTE,null),t.width=e,t.height=i},e.getRenderBufferTexture=function(t,e){var i=this._webGLContext,n=this.getBaseTexture(t,e);if(!n)return null;var s=i.createFramebuffer();return s?(n.width=t,n.height=e,i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0),s._renderTexture=n,n._frameBuffer=s,n._storeID=this._textureDictionary.length,this._textureDictionary[n._storeID]=n,i.bindFramebuffer(i.FRAMEBUFFER,null),n):null},e.setTextureParams=function(t,e){e&&this._antialias?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},e.setClearColor=function(t){var e,i,n,s,r;"string"==typeof t?0==t.indexOf("#")?(4==t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),e=Number("0x"+t.slice(1,3))/255,i=Number("0x"+t.slice(3,5))/255,n=Number("0x"+t.slice(5,7))/255,s=Number("0x"+t.slice(7,9))/255):0==t.indexOf("rgba(")&&(r=t.slice(5,-1).split(","),e=Number(r[0])/255,i=Number(r[1])/255,n=Number(r[2])/255,s=Number(r[3])):(e=((4278190080&t)>>>24)/255,i=((16711680&t)>>>16)/255,n=((65280&t)>>>8)/255,s=(255&t)/255),this._clearColor.r=e||0,this._clearColor.g=i||0,this._clearColor.b=n||0,this._clearColor.a=s||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},e.toString=function(){return"[StageGL (name="+this.name+")]"},e._fetchWebGLContext=function(t,e){var n;try{n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}catch(i){}if(n)n.viewportWidth=t.width,n.viewportHeight=t.height;else{var s="Could not initialize WebGL";console.error?console.error(s):console.log(s)}return n},e._fetchShaderProgram=function(e,i,n,s,r){var a,o;switch(e.useProgram(null),i){case"filter":o=t.COVER_VERTEX_HEADER+(n||t.COVER_VERTEX_BODY),a=t.COVER_FRAGMENT_HEADER+(s||t.COVER_FRAGMENT_BODY);break;case"particle":o=t.REGULAR_VERTEX_HEADER+t.PARTICLE_VERTEX_BODY,a=t.REGULAR_FRAGMENT_HEADER+t.PARTICLE_FRAGMENT_BODY;break;case"override":o=t.REGULAR_VERTEX_HEADER+(n||t.REGULAR_VERTEX_BODY),a=t.REGULAR_FRAGMENT_HEADER+(s||t.REGULAR_FRAGMENT_BODY);break;case"regular":default:o=t.REGULAR_VERTEX_HEADER+t.REGULAR_VERTEX_BODY,a=t.REGULAR_FRAGMENT_HEADER+t.REGULAR_FRAGMENT_BODY;break}var l=this._createShader(e,e.VERTEX_SHADER,o),h=this._createShader(e,e.FRAGMENT_SHADER,a),c=e.createProgram();if(e.attachShader(c,l),e.attachShader(c,h),e.linkProgram(c),c._type=i,!e.getProgramParameter(c,e.LINK_STATUS))throw e.useProgram(this._activeShader),e.getProgramInfoLog(c);switch(e.useProgram(c),i){case"filter":c.vertexPositionAttribute=e.getAttribLocation(c,"vertexPosition"),e.enableVertexAttribArray(c.vertexPositionAttribute),c.uvPositionAttribute=e.getAttribLocation(c,"uvPosition"),e.enableVertexAttribArray(c.uvPositionAttribute),c.samplerUniform=e.getUniformLocation(c,"uSampler"),e.uniform1i(c.samplerUniform,0),c.uprightUniform=e.getUniformLocation(c,"uUpright"),e.uniform1f(c.uprightUniform,0),r&&r(e,this,c);break;case"override":case"particle":case"regular":default:c.vertexPositionAttribute=e.getAttribLocation(c,"vertexPosition"),e.enableVertexAttribArray(c.vertexPositionAttribute),c.uvPositionAttribute=e.getAttribLocation(c,"uvPosition"),e.enableVertexAttribArray(c.uvPositionAttribute),c.textureIndexAttribute=e.getAttribLocation(c,"textureIndex"),e.enableVertexAttribArray(c.textureIndexAttribute),c.alphaAttribute=e.getAttribLocation(c,"objectAlpha"),e.enableVertexAttribArray(c.alphaAttribute);for(var u=[],d=0;d<this._batchTextureCount;d++)u[d]=d;c.samplerData=u,c.samplerUniform=e.getUniformLocation(c,"uSampler"),e.uniform1iv(c.samplerUniform,u),c.pMatrixUniform=e.getUniformLocation(c,"pMatrix");break}return e.useProgram(this._activeShader),c},e._createShader=function(e,i,n){n=n.replace(/{{count}}/g,this._batchTextureCount);for(var s="",r=1;r<this._batchTextureCount;r++)s+="} else if (indexPicker <= "+r+".5) { color = texture2D(uSampler["+r+"], vTextureCoord);";n=n.replace(/{{alternates}}/g,s),n=n.replace(/{{fragColor}}/g,this._premultiply?t.REGULAR_FRAG_COLOR_PREMULTIPLY:t.REGULAR_FRAG_COLOR_NORMAL);var a=e.createShader(i);if(e.shaderSource(a,n),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw e.getShaderInfoLog(a);return a},e._createBuffers=function(e){var i,n,s,r=this._maxCardsPerBatch*t.INDICIES_PER_CARD,a=this._vertexPositionBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),i=2;var o=this._vertices=new Float32Array(r*i);for(n=0,s=o.length;n<s;n+=i)o[n]=o[n+1]=0;e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),a.itemSize=i,a.numItems=r;var l=this._uvPositionBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),i=2;var h=this._uvs=new Float32Array(r*i);for(n=0,s=h.length;n<s;n+=i)h[n]=h[n+1]=0;e.bufferData(e.ARRAY_BUFFER,h,e.DYNAMIC_DRAW),l.itemSize=i,l.numItems=r;var c=this._textureIndexBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),i=1;var u=this._indices=new Float32Array(r*i);for(n=0,s=u.length;n<s;n++)u[n]=0;e.bufferData(e.ARRAY_BUFFER,u,e.DYNAMIC_DRAW),c.itemSize=i,c.numItems=r;var d=this._alphaBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),i=1;var f=this._alphas=new Float32Array(r*i);for(n=0,s=f.length;n<s;n++)f[n]=1;e.bufferData(e.ARRAY_BUFFER,f,e.DYNAMIC_DRAW),d.itemSize=i,d.numItems=r},e._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(var t=0;t<this._batchTextureCount;t++){var e=this.getBaseTexture();if(this._baseTextures[t]=this._batchTextures[t]=e,!e)throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},e._loadTextureImage=function(t,e){var i=e.src;i||(e._isCanvas=!0,i=e.src="canvas_"+this._lastTrackedCanvas++);var n=this._textureIDs[i];void 0===n&&(n=this._textureIDs[i]=this._textureDictionary.length),void 0===this._textureDictionary[n]&&(this._textureDictionary[n]=this.getBaseTexture());var s=this._textureDictionary[n];if(s)s._batchID=this._batchID,s._storeID=n,s._imageData=e,this._insertTextureInBatch(t,s),e._storeID=n,e.complete||e.naturalWidth||e._isCanvas?this._updateTextureImageData(t,e):e.addEventListener("load",this._updateTextureImageData.bind(this,t,e));else{var r="Problem creating desired texture, known causes include using too much VRAM by not releasing WebGL texture instances";console.error&&console.error(r)||console.log(r),s=this._baseTextures[0],s._batchID=this._batchID,s._storeID=-1,s._imageData=s,this._insertTextureInBatch(t,s)}return s},e._updateTextureImageData=function(t,e){var n=e.width&e.width-1||e.height&e.height-1,s=this._textureDictionary[e._storeID];t.activeTexture(t.TEXTURE0+s._activeIndex),t.bindTexture(t.TEXTURE_2D,s),s.isPOT=!n,this.setTextureParams(t,s.isPOT);try{t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}catch(i){var r="\nAn error has occurred. This is most likely due to security restrictions on WebGL images with local or cross-domain origins";console.error?(console.error(r),console.error(i)):console&&(console.log(r),console.log(i))}e._invalid=!1,s._w=e.width,s._h=e.height,this.vocalDebug&&(n&&console.warn("NPOT(Non Power of Two) Texture: "+e.src),(e.width>t.MAX_TEXTURE_SIZE||e.height>t.MAX_TEXTURE_SIZE)&&console&&console.error("Oversized Texture: "+e.width+"x"+e.height+" vs "+t.MAX_TEXTURE_SIZE+"max"))},e._insertTextureInBatch=function(t,e){if(this._batchTextures[e._activeIndex]!==e){var i=-1,n=(this._lastTextureInsert+1)%this._batchTextureCount,s=n;do{if(this._batchTextures[s]._batchID!=this._batchID&&!this._slotBlacklist[s]){i=s;break}s=(s+1)%this._batchTextureCount}while(s!==n);-1===i&&(this.batchReason="textureOverflow",this._drawBuffers(t),this.batchCardCount=0,i=n),this._batchTextures[i]=e,e._activeIndex=i;var r=e._imageData;r&&r._invalid&&void 0!==e._drawID?this._updateTextureImageData(t,r):(t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,e),this.setTextureParams(t)),this._lastTextureInsert=i}else{r=e._imageData;void 0!=e._storeID&&r&&r._invalid&&this._updateTextureImageData(t,r)}e._drawID=this._drawID,e._batchID=this._batchID},e._killTextureObject=function(t){if(t){var e=this._webGLContext;if(void 0!==t._storeID&&t._storeID>=0){for(var n in this._textureDictionary[t._storeID]=void 0,this._textureIDs)this._textureIDs[n]==t._storeID&&delete this._textureIDs[n];t._imageData&&(t._imageData._storeID=void 0),t._imageData=t._storeID=void 0}void 0!==t._activeIndex&&this._batchTextures[t._activeIndex]===t&&(this._batchTextures[t._activeIndex]=this._baseTextures[t._activeIndex]);try{t._frameBuffer&&e.deleteFramebuffer(t._frameBuffer),t._frameBuffer=void 0}catch(i){this.vocalDebug&&console.log(i)}try{e.deleteTexture(t)}catch(i){this.vocalDebug&&console.log(i)}}},e._backupBatchTextures=function(t,e){var i=this._webGLContext;this._backupTextures||(this._backupTextures=[]),void 0===e&&(e=this._backupTextures);for(var n=0;n<this._batchTextureCount;n++)i.activeTexture(i.TEXTURE0+n),t?this._batchTextures[n]=e[n]:(e[n]=this._batchTextures[n],this._batchTextures[n]=this._baseTextures[n]),i.bindTexture(i.TEXTURE_2D,this._batchTextures[n]),this.setTextureParams(i,this._batchTextures[n].isPOT);t&&e===this._backupTextures&&(this._backupTextures=[])},e._batchDraw=function(t,e,i){this._isDrawing>0&&this._drawBuffers(e),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(t,e,new af.Matrix2D,this.alpha,i),this.batchReason="drawFinish",this._drawBuffers(e),this._isDrawing--},e._cacheDraw=function(t,e,i,n){var s,r=this._activeShader,a=this._slotBlacklist,o=this._maxTextureSlots-1,l=this._viewportWidth,h=this._viewportHeight;this.protectTextureSlot(o,!0);var c=e.getMatrix();c=c.clone(),c.scale(1/n.scale,1/n.scale),c=c.invert(),c.translate(-n.offX/n.scale*e.scaleX,-n.offY/n.scale*e.scaleY);var u=this._cacheContainer;u.children=[e],u.transformMatrix=c,this._backupBatchTextures(!1),i&&i.length?this._drawFilters(e,i,n):this.isCacheControlled?(t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0)):(t.activeTexture(t.TEXTURE0+o),e.cacheCanvas=this.getTargetRenderTexture(e,n._drawWidth,n._drawHeight),s=e.cacheCanvas,t.bindFramebuffer(t.FRAMEBUFFER,s._frameBuffer),this.updateViewport(n._drawWidth,n._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,t.clear(t.COLOR_BUFFER_BIT),this._batchDraw(u,t,!0),t.bindFramebuffer(t.FRAMEBUFFER,null),this.updateViewport(l,h)),this._backupBatchTextures(!0),this.protectTextureSlot(o,!1),this._activeShader=r,this._slotBlacklist=a},e._drawFilters=function(t,e,i){var n,s=this._webGLContext,r=this._maxTextureSlots-1,a=this._viewportWidth,o=this._viewportHeight,l=this._cacheContainer,h=e.length;s.activeTexture(s.TEXTURE0+r),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),s.bindFramebuffer(s.FRAMEBUFFER,n._frameBuffer),this.updateViewport(i._drawWidth,i._drawHeight),s.clear(s.COLOR_BUFFER_BIT),this._batchDraw(l,s,!0),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,n),this.setTextureParams(s);var c=!1,u=0,d=e[u];do{this._activeShader=this.getFilterShader(d),this._activeShader&&(s.activeTexture(s.TEXTURE0+r),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),s.bindFramebuffer(s.FRAMEBUFFER,n._frameBuffer),s.viewport(0,0,i._drawWidth,i._drawHeight),s.clear(s.COLOR_BUFFER_BIT),this._drawCover(s,c),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,n),this.setTextureParams(s),(h>1||e[0]._multiPass)&&(c=!c),d=null!==d._multiPass?d._multiPass:e[++u])}while(d);this.isCacheControlled?(s.bindFramebuffer(s.FRAMEBUFFER,null),this.updateViewport(a,o),this._activeShader=this.getFilterShader(this),s.clear(s.COLOR_BUFFER_BIT),this._drawCover(s,c)):(c&&(s.activeTexture(s.TEXTURE0+r),n=this.getTargetRenderTexture(t,i._drawWidth,i._drawHeight),s.bindFramebuffer(s.FRAMEBUFFER,n._frameBuffer),this._activeShader=this.getFilterShader(this),s.viewport(0,0,i._drawWidth,i._drawHeight),s.clear(s.COLOR_BUFFER_BIT),this._drawCover(s,!c)),s.bindFramebuffer(s.FRAMEBUFFER,null),this.updateViewport(a,o),t.cacheCanvas=n)},e._appendToBatchGroup=function(e,i,n,s,r){e._glMtx||(e._glMtx=new af.Matrix2D);var a,o,l,h,c=e._glMtx;c.copy(n),e.transformMatrix?c.appendMatrix(e.transformMatrix):c.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY);for(var u=e.children.length,d=0;d<u;d++){var f=e.children[d];if(f.visible&&s)if(f.cacheCanvas&&!r||(f._updateState&&f._updateState(),!f.children)){this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(i),this.batchCardCount=0),f._glMtx||(f._glMtx=new af.Matrix2D);var p,m,g,v,_,b,y=f._glMtx;y.copy(c),f.transformMatrix?y.appendMatrix(f.transformMatrix):y.appendTransform(f.x,f.y,f.scaleX,f.scaleY,f.rotation,f.skewX,f.skewY,f.regX,f.regY);var w=f.cacheCanvas&&!r;if(2===f._webGLRenderStyle||w)g=!r&&f.cacheCanvas||f.image;else{if(1!==f._webGLRenderStyle)continue;if(v=f.spriteSheet.getFrame(f.currentFrame),null===v)continue;g=v.image}var E=this._uvs,C=this._vertices,T=this._indices,x=this._alphas;if(g){if(void 0===g._storeID)_=this._loadTextureImage(i,g),this._insertTextureInBatch(i,_);else{if(_=this._textureDictionary[g._storeID],!_){this.vocalDebug&&console.log("Texture should not be looked up while not being stored.");continue}_._batchID!==this._batchID&&this._insertTextureInBatch(i,_)}if(m=_._activeIndex,2===f._webGLRenderStyle||w)!w&&f.sourceRect?(f._uvRect||(f._uvRect={}),b=f.sourceRect,p=f._uvRect,p.t=b.y/g.height,p.l=b.x/g.width,p.b=(b.y+b.height)/g.height,p.r=(b.x+b.width)/g.width,a=0,o=0,l=b.width+a,h=b.height+o):(p=t.UV_RECT,w?(b=f.bitmapCache,a=b.x+b._filterOffX/b.scale,o=b.y+b._filterOffY/b.scale,l=b._drawWidth/b.scale+a,h=b._drawHeight/b.scale+o):(a=0,o=0,l=g.width+a,h=g.height+o));else if(1===f._webGLRenderStyle){var S=v.rect;p=v.uvRect,p||(p=t.buildUVRects(f.spriteSheet,f.currentFrame,!1)),a=-v.regX,o=-v.regY,l=S.width-v.regX,h=S.height-v.regY}var I=this.batchCardCount*t.INDICIES_PER_CARD,L=2*I;C[L]=a*y.a+o*y.c+y.tx,C[L+1]=a*y.b+o*y.d+y.ty,C[L+2]=a*y.a+h*y.c+y.tx,C[L+3]=a*y.b+h*y.d+y.ty,C[L+4]=l*y.a+o*y.c+y.tx,C[L+5]=l*y.b+o*y.d+y.ty,C[L+6]=C[L+2],C[L+7]=C[L+3],C[L+8]=C[L+4],C[L+9]=C[L+5],C[L+10]=l*y.a+h*y.c+y.tx,C[L+11]=l*y.b+h*y.d+y.ty,E[L]=p.l,E[L+1]=p.t,E[L+2]=p.l,E[L+3]=p.b,E[L+4]=p.r,E[L+5]=p.t,E[L+6]=p.l,E[L+7]=p.b,E[L+8]=p.r,E[L+9]=p.t,E[L+10]=p.r,E[L+11]=p.b,T[I]=T[I+1]=T[I+2]=T[I+3]=T[I+4]=T[I+5]=m,x[I]=x[I+1]=x[I+2]=x[I+3]=x[I+4]=x[I+5]=f.alpha*s,this.batchCardCount++}}else this._appendToBatchGroup(f,i,c,f.alpha*s)}},e._drawBuffers=function(e){if(!(this.batchCardCount<=0)){this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : "+this.batchReason);var i=this._activeShader,n=this._vertexPositionBuffer,s=this._textureIndexBuffer,r=this._uvPositionBuffer,a=this._alphaBuffer;e.useProgram(i),e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(i.vertexPositionAttribute,n.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices),e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(i.textureIndexAttribute,s.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._indices),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(i.uvPositionAttribute,r.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._uvs),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(i.alphaAttribute,a.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._alphas),e.uniformMatrix4fv(i.pMatrixUniform,e.FALSE,this._projectionMatrix);for(var o=0;o<this._batchTextureCount;o++){var l=this._batchTextures[o];e.activeTexture(e.TEXTURE0+o),e.bindTexture(e.TEXTURE_2D,l),this.setTextureParams(e,l.isPOT)}e.drawArrays(e.TRIANGLES,0,this.batchCardCount*t.INDICIES_PER_CARD),this._batchID++}},e._drawCover=function(e,i){this._isDrawing>0&&this._drawBuffers(e),this.vocalDebug&&console.log("Draw["+this._drawID+":"+this._batchID+"] : Cover");var n=this._activeShader,s=this._vertexPositionBuffer,r=this._uvPositionBuffer;e.clear(e.COLOR_BUFFER_BIT),e.useProgram(n),e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(n.vertexPositionAttribute,s.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,t.COVER_VERT),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(n.uvPositionAttribute,r.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,i?t.COVER_UV_FLIP:t.COVER_UV),e.uniform1i(n.samplerUniform,0),e.uniform1f(n.uprightUniform,i?0:1),e.drawArrays(e.TRIANGLES,0,t.INDICIES_PER_CARD)},af.StageGL=af.promote(t,"Stage")}(),this.createjs=this.createjs||{},function(){function t(t){this.DisplayObject_constructor(),"string"==typeof t?(this.image=e.createElement("img"),this.image.src=t):this.image=t,this.sourceRect=null,this._webGLRenderStyle=af.DisplayObject._StageGL_BITMAP}var i=af.extend(t,af.DisplayObject);i.initialize=t,i.isVisible=function(){var t=this.image,e=this.cacheCanvas||t&&(t.naturalWidth||t.getContext||t.readyState>=2);return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)},i.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i=this.image,n=this.sourceRect;if(i.getImage&&(i=i.getImage()),!i)return!0;if(n){var s=n.x,r=n.y,a=s+n.width,o=r+n.height,l=0,h=0,c=i.width,u=i.height;s<0&&(l-=s,s=0),a>c&&(a=c),r<0&&(h-=r,r=0),o>u&&(o=u),t.drawImage(i,s,r,a-s,o-r,l,h,a-s,o-r)}else t.drawImage(i,0,0);return!0},i.getBounds=function(){var t=this.DisplayObject_getBounds();if(t)return t;var e=this.image,i=this.sourceRect||e,n=e&&(e.naturalWidth||e.getContext||e.readyState>=2);return n?this._rectangle.setValues(0,0,i.width,i.height):null},i.clone=function(e){var i=this.image;i&&e&&(i=i.cloneNode());var n=new t(i);return this.sourceRect&&(n.sourceRect=this.sourceRect.clone()),this._cloneProps(n),n},i.toString=function(){return"[Bitmap (name="+this.name+")]"},af.Bitmap=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=t,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=af.DisplayObject._StageGL_SPRITE,null!=e&&this.gotoAndPlay(e)}var e=af.extend(t,af.DisplayObject);e.initialize=t,e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;this._normalizeFrame();var i=this.spriteSheet.getFrame(0|this._currentFrame);if(!i)return!1;var n=i.rect;return n.width&&n.height&&t.drawImage(i.image,n.x,n.y,n.width,n.height,-i.regX,-i.regY,n.width,n.height),!0},e.play=function(){this.paused=!1},e.stop=function(){this.paused=!0},e.gotoAndPlay=function(t){this.paused=!1,this._skipAdvance=!0,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.advance=function(t){var e=this.framerate||this.spriteSheet.framerate,i=e&&null!=t?t/(1e3/e):1;this._normalizeFrame(i)},e.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},e.clone=function(){return this._cloneProps(new t(this.spriteSheet))},e.toString=function(){return"[Sprite (name="+this.name+")]"},e._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.currentFrame=this.currentFrame,t.currentAnimation=this.currentAnimation,t.paused=this.paused,t.currentAnimationFrame=this.currentAnimationFrame,t.framerate=this.framerate,t._animation=this._animation,t._currentFrame=this._currentFrame,t._skipAdvance=this._skipAdvance,t},e._tick=function(t){this.paused||(this._skipAdvance||this.advance(t&&t.delta),this._skipAdvance=!1),this.DisplayObject__tick(t)},e._normalizeFrame=function(t){t=t||0;var e,i=this._animation,n=this.paused,s=this._currentFrame;if(i){var r=i.speed||1,a=this.currentAnimationFrame;if(e=i.frames.length,a+t*r>=e){var o=i.next;if(this._dispatchAnimationEnd(i,s,n,o,e-1))return;if(o)return this._goto(o,t-(e-a)/r);this.paused=!0,a=i.frames.length-1}else a+=t*r;this.currentAnimationFrame=a,this._currentFrame=i.frames[0|a]}else if(s=this._currentFrame+=t,e=this.spriteSheet.getNumFrames(),s>=e&&e>0&&!this._dispatchAnimationEnd(i,s,n,e-1)&&(this._currentFrame-=e)>=e)return this._normalizeFrame();s=0|this._currentFrame,this.currentFrame!=s&&(this.currentFrame=s,this.dispatchEvent("change"))},e._dispatchAnimationEnd=function(t,e,i,n,s){var r=t?t.name:null;if(this.hasEventListener("animationend")){var a=new af.Event("animationend");a.name=r,a.next=n,this.dispatchEvent(a)}var o=this._animation!=t||this._currentFrame!=e;return o||i||!this.paused||(this.currentAnimationFrame=s,o=!0),o},e._goto=function(t,e){if(this.currentAnimationFrame=0,isNaN(t)){var i=this.spriteSheet.getAnimation(t);i&&(this._animation=i,this.currentAnimation=t,this._normalizeFrame(e))}else this.currentAnimation=this._animation=null,this._currentFrame=t,this._normalizeFrame()},af.Sprite=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t){this.DisplayObject_constructor(),this.graphics=t||new af.Graphics}var e=af.extend(t,af.DisplayObject);e.isVisible=function(){var t=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},e.draw=function(t,e){return this.DisplayObject_draw(t,e)||this.graphics.draw(t,this),!0},e.clone=function(e){var i=e&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new t(i))},e.toString=function(){return"[Shape (name="+this.name+")]"},af.Shape=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.DisplayObject_constructor(),this.text=t,this.font=e,this.color=i,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}var i=af.extend(t,af.DisplayObject),n=af.createCanvas?af.createCanvas():e.createElement("canvas");n.getContext&&(t._workingContext=n.getContext("2d"),n.width=n.height=1),t.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},t.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},i.isVisible=function(){var t=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&t)},i.draw=function(t,e){if(this.DisplayObject_draw(t,e))return!0;var i=this.color||"#000";return this.outline?(t.strokeStyle=i,t.lineWidth=1*this.outline):t.fillStyle=i,this._drawText(this._prepContext(t)),!0},i.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},i.getMeasuredLineHeight=function(){return 1.2*this._getMeasuredWidth("M")},i.getMeasuredHeight=function(){return this._drawText(null,{}).height},i.getBounds=function(){var e=this.DisplayObject_getBounds();if(e)return e;if(null==this.text||""===this.text)return null;var i=this._drawText(null,{}),n=this.maxWidth&&this.maxWidth<i.width?this.maxWidth:i.width,s=n*t.H_OFFSETS[this.textAlign||"left"],r=this.lineHeight||this.getMeasuredLineHeight(),a=r*t.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(s,a,n,i.height)},i.getMetrics=function(){var e={lines:[]};return e.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),e.vOffset=e.lineHeight*t.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,e,e.lines)},i.clone=function(){return this._cloneProps(new t(this.text,this.font,this.color))},i.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"},i._cloneProps=function(t){return this.DisplayObject__cloneProps(t),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.maxWidth=this.maxWidth,t.outline=this.outline,t.lineHeight=this.lineHeight,t.lineWidth=this.lineWidth,t},i._prepContext=function(t){return t.font=this.font||"10px sans-serif",t.textAlign=this.textAlign||"left",t.textBaseline=this.textBaseline||"top",t.lineJoin="miter",t.miterLimit=2.5,t},i._drawText=function(e,i,n){var s=!!e;s||(e=t._workingContext,e.save(),this._prepContext(e));for(var r=this.lineHeight||this.getMeasuredLineHeight(),a=0,o=0,l=String(this.text).split(/(?:\r\n|\r|\n)/),h=0,c=l.length;h<c;h++){var u=l[h],d=null;if(null!=this.lineWidth&&(d=e.measureText(u).width)>this.lineWidth){var f=u.split(/(\s)/);u=f[0],d=e.measureText(u).width;for(var p=1,m=f.length;p<m;p+=2){var g=e.measureText(f[p]+f[p+1]).width;d+g>this.lineWidth?(s&&this._drawTextLine(e,u,o*r),n&&n.push(u),d>a&&(a=d),u=f[p+1],d=e.measureText(u).width,o++):(u+=f[p]+f[p+1],d+=g)}}s&&this._drawTextLine(e,u,o*r),n&&n.push(u),i&&null==d&&(d=e.measureText(u).width),d>a&&(a=d),o++}return i&&(i.width=a,i.height=o*r),s||e.restore(),i},i._drawTextLine=function(t,e,i){this.outline?t.strokeText(e,0,i,this.maxWidth||65535):t.fillText(e,0,i,this.maxWidth||65535)},i._getMeasuredWidth=function(e){var i=t._workingContext;i.save();var n=this._prepContext(i).measureText(e).width;return i.restore(),n},af.Text=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(t,e){this.Container_constructor(),this.text=t||"",this.spriteSheet=e,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}var e=af.extend(t,af.Container);t.maxPoolSize=100,t._spritePool=[],e.draw=function(t,e){this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e))},e.getBounds=function(){return this._updateText(),this.Container_getBounds()},e.isVisible=function(){var t=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&0!==this.scaleX&&0!==this.scaleY&&t)},e.clone=function(){return this._cloneProps(new t(this.text,this.spriteSheet))},e.addChild=e.addChildAt=e.removeChild=e.removeChildAt=e.removeAllChildren=function(){},e._updateState=function(){this._updateText()},e._cloneProps=function(t){return this.Container__cloneProps(t),t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.spaceWidth=this.spaceWidth,t},e._getFrameIndex=function(t,e){var i,n=e.getAnimation(t);return n||(t!=(i=t.toUpperCase())||t!=(i=t.toLowerCase())||(i=null),i&&(n=e.getAnimation(i))),n&&n.frames[0]},e._getFrame=function(t,e){var i=this._getFrameIndex(t,e);return null==i?i:e.getFrame(i)},e._getLineHeight=function(t){var e=this._getFrame("1",t)||this._getFrame("T",t)||this._getFrame("L",t)||t.getFrame(0);return e?e.rect.height:1},e._getSpaceWidth=function(t){var e=this._getFrame("1",t)||this._getFrame("l",t)||this._getFrame("e",t)||this._getFrame("a",t)||t.getFrame(0);return e?e.rect.width:1},e._updateText=function(){var e,i=0,n=0,s=this._oldProps,r=!1,a=this.spaceWidth,o=this.lineHeight,l=this.spriteSheet,h=t._spritePool,c=this.children,u=0,d=c.length;for(var f in s)s[f]!=this[f]&&(s[f]=this[f],r=!0);if(r){var p=!!this._getFrame(" ",l);p||a||(a=this._getSpaceWidth(l)),o||(o=this._getLineHeight(l));for(var m=0,g=this.text.length;m<g;m++){var v=this.text.charAt(m);if(" "!=v||p)if("\n"!=v&&"\r"!=v){var _=this._getFrameIndex(v,l);null!=_&&(u<d?e=c[u]:(c.push(e=h.length?h.pop():new af.Sprite),e.parent=this,d++),e.spriteSheet=l,e.gotoAndStop(_),e.x=i,e.y=n,u++,i+=e.getBounds().width+this.letterSpacing)}else"\r"==v&&"\n"==this.text.charAt(m+1)&&m++,i=0,n+=o;else i+=a}while(d>u)h.push(e=c.pop()),e.parent=null,d--;h.length>t.maxPoolSize&&(h.length=t.maxPoolSize)}},af.BitmapText=af.promote(t,"Container")}(),this.createjs=this.createjs||{},function(){function t(e){var i,n,s,r;this.Container_constructor(),!t.inited&&t.init(),e instanceof String||arguments.length>1?(i=e,n=arguments[1],s=arguments[2],r=arguments[3],null==s&&(s=-1),e=null):e&&(i=e.mode,n=e.startPosition,s=e.loop,r=e.labels),e||(e={labels:r}),this.mode=i||t.INDEPENDENT,this.startPosition=n||0,this.loop=!0===s?-1:s||0,this.currentFrame=0,this.paused=e.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||e.frameBounds,this.framerate=null,e.useTicks=e.paused=!0,this.timeline=new af.Timeline(e),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}var e=af.extend(t,af.Container);t.INDEPENDENT="independent",t.SINGLE_FRAME="single",t.SYNCHED="synched",t.inited=!1,t.init=function(){t.inited||(i.install(),t.inited=!0)},e._getLabels=function(){return this.timeline.getLabels()},e.getLabels=af.deprecate(e._getLabels,"MovieClip.getLabels"),e._getCurrentLabel=function(){return this.timeline.currentLabel},e.getCurrentLabel=af.deprecate(e._getCurrentLabel,"MovieClip.getCurrentLabel"),e._getDuration=function(){return this.timeline.duration},e.getDuration=af.deprecate(e._getDuration,"MovieClip.getDuration");try{Object.defineProperties(e,{labels:{get:e._getLabels},currentLabel:{get:e._getCurrentLabel},totalFrames:{get:e._getDuration},duration:{get:e._getDuration}})}catch(n){}function i(){throw"MovieClipPlugin cannot be instantiated."}e.initialize=t,e.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},e.draw=function(t,e){return this.DisplayObject_draw(t,e)||(this._updateState(),this.Container_draw(t,e)),!0},e.play=function(){this.paused=!1},e.stop=function(){this.paused=!0},e.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.advance=function(e){var i=t.INDEPENDENT;if(this.mode===i){var n=this,s=n.framerate;while((n=n.parent)&&null===s)n.mode===i&&(s=n._framerate);if(this._framerate=s,!this.paused){var r=null!==s&&-1!==s&&null!==e?e/(1e3/s)+this._t:1,a=0|r;this._t=r-a;while(a--)this._updateTimeline(this._rawPosition+1,!1)}}},e.clone=function(){throw"MovieClip cannot be cloned."},e.toString=function(){return"[MovieClip (name="+this.name+")]"},e._updateState=function(){-1!==this._rawPosition&&this.mode===t.INDEPENDENT||this._updateTimeline(-1)},e._tick=function(t){this.advance(t&&t.delta),this.Container__tick(t)},e._goto=function(t){var e=this.timeline.resolve(t);null!=e&&(this._t=0,this._updateTimeline(e,!0))},e._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},e._updateTimeline=function(e,i){var n=this.mode!==t.INDEPENDENT,s=this.timeline;n&&(e=this.startPosition+(this.mode===t.SINGLE_FRAME?0:this._synchOffset)),e<0&&(e=0),(this._rawPosition!==e||n)&&(this._rawPosition=e,s.loop=this.loop,s.setPosition(e,n||!this.actionsEnabled,i,this._bound_resolveState))},e._renderFirstFrame=function(){var t=this.timeline,e=t.rawPosition;t.setPosition(0,!0,!0,this._bound_resolveState),t.rawPosition=e},e._resolveState=function(){var t=this.timeline;for(var e in this.currentFrame=t.position,this._managed)this._managed[e]=1;for(var i=t.tweens,n=0,s=i.length;n<s;n++){var r=i[n],a=r.target;if(a!==this&&!r.passive){var o=r._stepPosition;a instanceof af.DisplayObject?this._addManagedChild(a,o):this._setState(a.state,o)}}var l=this.children;for(n=l.length-1;n>=0;n--){var h=l[n].id;1===this._managed[h]&&(this.removeChildAt(n),delete this._managed[h])}},e._setState=function(t,e){if(t)for(var i=t.length-1;i>=0;i--){var n=t[i],s=n.t,r=n.p;for(var a in r)s[a]=r[a];this._addManagedChild(s,e)}},e._addManagedChild=function(e,i){e._off||(this.addChildAt(e,0),e instanceof t&&(e._synchOffset=i,e.mode===t.INDEPENDENT&&e.autoReset&&!this._managed[e.id]&&e._reset()),this._managed[e.id]=2)},e._getBounds=function(t,e){var i=this.DisplayObject_getBounds();return i||this.frameBounds&&(i=this._rectangle.copy(this.frameBounds[this.currentFrame])),i?this._transformBounds(i,t,e):this.Container__getBounds(t,e)},af.MovieClip=af.promote(t,"Container"),i.priority=100,i.ID="MovieClip",i.install=function(){af.Tween._installPlugin(i)},i.init=function(e,n,s){"startPosition"===n&&e.target instanceof t&&e._addPlugin(i)},i.step=function(t,e,i){},i.change=function(t,e,i,n,s,r){if("startPosition"===i)return 1===s?e.props[i]:e.prev.props[i]}}(),this.createjs=this.createjs||{},function(){function t(){throw"SpriteSheetUtils cannot be instantiated"}var i=af.createCanvas?af.createCanvas():e.createElement("canvas");i.getContext&&(t._workingCanvas=i,t._workingContext=i.getContext("2d"),i.width=i.height=1),t.extractFrame=function(i,n){isNaN(n)&&(n=i.getAnimation(n).frames[0]);var s=i.getFrame(n);if(!s)return null;var r=s.rect,a=t._workingCanvas;a.width=r.width,a.height=r.height,t._workingContext.drawImage(s.image,r.x,r.y,r.width,r.height,0,0,r.width,r.height);var o=e.createElement("img");return o.src=a.toDataURL("image/png"),o},t.addFlippedFrames=af.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),t.mergeAlpha=af.deprecate(null,"SpriteSheetUtils.mergeAlpha"),t._flip=function(i,n,s,r){for(var a=i._images,o=t._workingCanvas,l=t._workingContext,h=a.length/n,c=0;c<h;c++){var u=a[c];u.__tmp=c,l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,o.width+1,o.height+1),o.width=u.width,o.height=u.height,l.setTransform(s?-1:1,0,0,r?-1:1,s?u.width:0,r?u.height:0),l.drawImage(u,0,0);var d=e.createElement("img");d.src=o.toDataURL("image/png"),d.width=u.width||u.naturalWidth,d.height=u.height||u.naturalHeight,a.push(d)}var f=i._frames,p=f.length/n;for(c=0;c<p;c++){u=f[c];var m=u.rect.clone();d=a[u.image.__tmp+h*n];var g={image:d,rect:m,regX:u.regX,regY:u.regY};s&&(m.x=(d.width||d.naturalWidth)-m.x-m.width,g.regX=m.width-u.regX),r&&(m.y=(d.height||d.naturalHeight)-m.y-m.height,g.regY=m.height-u.regY),f.push(g)}var v="_"+(s?"h":"")+(r?"v":""),_=i._animations,b=i._data,y=_.length/n;for(c=0;c<y;c++){var w=_[c];u=b[w];var E={name:w+v,speed:u.speed,next:u.next,frames:[]};u.next&&(E.next+=v),f=u.frames;for(var C=0,T=f.length;C<T;C++)E.frames.push(f[C]+p*n);b[E.name]=E,_.push(E.name)}},af.SpriteSheetUtils=t}(),this.createjs=this.createjs||{},function(){function t(t){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=t||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}var i=af.extend(t,af.EventDispatcher);t.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",t.ERR_RUNNING="a build is already running",i.addFrame=function(e,i,n,s,r){if(this._data)throw t.ERR_RUNNING;var a=i||e.bounds||e.nominalBounds;return!a&&e.getBounds&&(a=e.getBounds()),a?(n=n||1,this._frames.push({source:e,sourceRect:a,scale:n,funct:s,data:r,index:this._frames.length,height:a.height*n})-1):null},i.addAnimation=function(e,i,n,s){if(this._data)throw t.ERR_RUNNING;this._animations[e]={frames:i,next:n,speed:s}},i.addMovieClip=function(e,i,n,s,r,a){if(this._data)throw t.ERR_RUNNING;var o=e.frameBounds,l=i||e.bounds||e.nominalBounds;if(!l&&e.getBounds&&(l=e.getBounds()),l||o){var h,c,u=this._frames.length,d=e.timeline.duration;for(h=0;h<d;h++){var f=o&&o[h]?o[h]:l;this.addFrame(e,f,n,this._setupMovieClipFrame,{i:h,f:s,d:r})}var p=e.timeline._labels,m=[];for(var g in p)m.push({index:p[g],label:g});if(m.length)for(m.sort((function(t,e){return t.index-e.index})),h=0,c=m.length;h<c;h++){for(var v=m[h].label,_=u+m[h].index,b=u+(h==c-1?d:m[h+1].index),y=[],w=_;w<b;w++)y.push(w);a&&(v=a(v,e,_,b),!v)||this.addAnimation(v,y,!0)}}},i.build=function(){if(this._data)throw t.ERR_RUNNING;this._startBuild();while(this._drawNext());return this._endBuild(),this.spriteSheet},i.buildAsync=function(e){if(this._data)throw t.ERR_RUNNING;this.timeSlice=e,this._startBuild();var i=this;this._timerID=setTimeout((function(){i._run()}),50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))},i.stopAsync=function(){clearTimeout(this._timerID),this._data=null},i.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},i.toString=function(){return"[SpriteSheetBuilder]"},i._startBuild=function(){var i=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;var n=[];this._data={images:[],frames:n,framerate:this.framerate,animations:this._animations};var s=this._frames.slice();if(s.sort((function(t,e){return t.height<=e.height?-1:1})),s[s.length-1].height+2*i>this.maxHeight)throw t.ERR_DIMENSIONS;var r=0,a=0,o=0;while(s.length){var l=this._fillRow(s,r,o,n,i);if(l.w>a&&(a=l.w),r+=l.h,!l.h||!s.length){var h=af.createCanvas?af.createCanvas():e.createElement("canvas");h.width=this._getSize(a,this.maxWidth),h.height=this._getSize(r,this.maxHeight),this._data.images[o]=h,l.h||(a=r=0,o++)}}},i._setupMovieClipFrame=function(t,e){var i=t.actionsEnabled;t.actionsEnabled=!1,t.gotoAndStop(e.i),t.actionsEnabled=i,e.f&&e.f(t,e.d,e.i)},i._getSize=function(t,e){var i=4;while(Math.pow(2,++i)<t);return Math.min(e,Math.pow(2,i))},i._fillRow=function(e,i,n,s,r){var a=this.maxWidth,o=this.maxHeight;i+=r;for(var l=o-i,h=r,c=0,u=e.length-1;u>=0;u--){var d=e[u],f=this._scale*d.scale,p=d.sourceRect,m=d.source,g=Math.floor(f*p.x-r),v=Math.floor(f*p.y-r),_=Math.ceil(f*p.height+2*r),b=Math.ceil(f*p.width+2*r);if(b>a)throw t.ERR_DIMENSIONS;_>l||h+b>a||(d.img=n,d.rect=new af.Rectangle(h,i,b,_),c=c||_,e.splice(u,1),s[d.index]=[h,i,b,_,n,Math.round(-g+f*m.regX-r),Math.round(-v+f*m.regY-r)],h+=b)}return{w:h,h:c}},i._endBuild=function(){this.spriteSheet=new af.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},i._run=function(){var t=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),e=(new Date).getTime()+t,i=!1;while(e>(new Date).getTime())if(!this._drawNext()){i=!0;break}if(i)this._endBuild();else{var n=this;this._timerID=setTimeout((function(){n._run()}),50-t)}var s=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){var r=new af.Event("progress");r.progress=s,this.dispatchEvent(r)}},i._drawNext=function(){var t=this._frames[this._index],e=t.scale*this._scale,i=t.rect,n=t.sourceRect,s=this._data.images[t.img],r=s.getContext("2d");return t.funct&&t.funct(t.source,t.data),r.save(),r.beginPath(),r.rect(i.x,i.y,i.width,i.height),r.clip(),r.translate(Math.ceil(i.x-n.x*e),Math.ceil(i.y-n.y*e)),r.scale(e,e),t.source.draw(r),r.restore(),++this._index<this._frames.length},af.SpriteSheetBuilder=af.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(t){this.DisplayObject_constructor(),"string"==typeof t&&(t=e.getElementById(t)),this.mouseEnabled=!1;var i=t.style;i.position="absolute",i.transformOrigin=i.WebkitTransformOrigin=i.msTransformOrigin=i.MozTransformOrigin=i.OTransformOrigin="0% 0%",this.htmlElement=t,this._oldProps=null,this._oldStage=null,this._drawAction=null}var i=af.extend(t,af.DisplayObject);i.isVisible=function(){return null!=this.htmlElement},i.draw=function(t,e){return!0},i.cache=function(){},i.uncache=function(){},i.updateCache=function(){},i.hitTest=function(){},i.localToGlobal=function(){},i.globalToLocal=function(){},i.localToLocal=function(){},i.clone=function(){throw"DOMElement cannot be cloned."},i.toString=function(){return"[DOMElement (name="+this.name+")]"},i._tick=function(t){var e=this.stage;e&&e!==this._oldStage&&(this._drawAction&&e.off("drawend",this._drawAction),this._drawAction=e.on("drawend",this._handleDrawEnd,this),this._oldStage=e),this.DisplayObject__tick(t)},i._handleDrawEnd=function(t){var e=this.htmlElement;if(e){var i=e.style,n=this.getConcatenatedDisplayProps(this._props),s=n.matrix,r=n.visible?"visible":"hidden";if(r!=i.visibility&&(i.visibility=r),n.visible){var a=this._oldProps,o=a&&a.matrix,l=1e4;if(!o||!o.equals(s)){var h="matrix("+(s.a*l|0)/l+","+(s.b*l|0)/l+","+(s.c*l|0)/l+","+(s.d*l|0)/l+","+(s.tx+.5|0);i.transform=i.WebkitTransform=i.OTransform=i.msTransform=h+","+(s.ty+.5|0)+")",i.MozTransform=h+"px,"+(s.ty+.5|0)+"px)",a||(a=this._oldProps=new af.DisplayProps(!0,null)),a.matrix.copy(s)}a.alpha!=n.alpha&&(i.opacity=""+(n.alpha*l|0)/l,a.alpha=n.alpha)}}},af.DOMElement=af.promote(t,"DisplayObject")}(),this.createjs=this.createjs||{},function(){function t(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}var e=t.prototype;e.getBounds=function(t){return t},e.shaderParamSetup=function(t,e,i){},e.applyFilter=function(t,e,i,n,s,r,a,o){r=r||t,null==a&&(a=e),null==o&&(o=i);try{var l=t.getImageData(e,i,n,s)}catch(h){return!1}return!!this._applyFilter(l)&&(r.putImageData(l,a,o),!0)},e.toString=function(){return"[Filter]"},e.clone=function(){return new t},e._applyFilter=function(t){return!0},af.Filter=t}(),this.createjs=this.createjs||{},function(){function t(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0}var i=t.prototype;t.getFilterBounds=function(t,e){e||(e=new af.Rectangle);var i=t.filters,n=i&&i.length;if(!!n<=0)return e;for(var s=0;s<n;s++){var r=i[s];if(r&&r.getBounds){var a=r.getBounds();a&&(0==s?e.setValues(a.x,a.y,a.width,a.height):e.extend(a.x,a.y,a.width,a.height))}}return e},i.toString=function(){return"[BitmapCache]"},i.define=function(t,e,i,n,s,r,a){if(!t)throw"No symbol to cache";this._options=a,this.target=t,this.width=n>=1?n:1,this.height=s>=1?s:1,this.x=e||0,this.y=i||0,this.scale=r||1,this.update()},i.update=function(e){if(!this.target)throw"define() must be called before update()";var i=t.getFilterBounds(this.target),n=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+i.width,this._drawHeight=Math.ceil(this.height*this.scale)+i.height,n&&this._drawWidth==n.width&&this._drawHeight==n.height||this._updateSurface(),this._filterOffX=i.x,this._filterOffY=i.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(e),this.cacheID=this.cacheID?this.cacheID+1:1},i.release=function(){if(this._webGLCache)this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1;else{var t=this.target.stage;t instanceof af.StageGL&&t.releaseTexture(this.target.cacheCanvas)}this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},i.getCacheDataURL=function(){var t=this.target&&this.target.cacheCanvas;return t?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=t.toDataURL?t.toDataURL():null),this._cacheDataURL):null},i.draw=function(t){return!!this.target&&(t.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0)},i._updateSurface=function(){if(!this._options||!this._options.useGL){var t=this.target.cacheCanvas;return t||(t=this.target.cacheCanvas=af.createCanvas?af.createCanvas():e.createElement("canvas")),t.width=this._drawWidth,void(t.height=this._drawHeight)}if(!this._webGLCache)if("stage"===this._options.useGL){if(!this.target.stage||!this.target.stage.isWebGL){var i="Cannot use 'stage' for cache because the object's parent stage is ";throw i+=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage.",i}this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if("new"===this._options.useGL)this.target.cacheCanvas=e.createElement("canvas"),this._webGLCache=new af.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else{if(!(this._options.useGL instanceof af.StageGL))throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0}t=this.target.cacheCanvas;var n=this._webGLCache;n.isCacheControlled&&(t.width=this._drawWidth,t.height=this._drawHeight,n.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(n.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),n.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):n.isCacheControlled||n.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},i._drawToCache=function(t){var e=this.target.cacheCanvas,i=this.target,n=this._webGLCache;if(n)n.cacheDraw(i,i.filters,this),e=this.target.cacheCanvas,e.width=this._drawWidth,e.height=this._drawHeight;else{var s=e.getContext("2d");t||s.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),s.save(),s.globalCompositeOperation=t,s.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),s.translate(-this.x,-this.y),i.draw(s,!0),s.restore(),i.filters&&i.filters.length&&this._applyFilters(s)}e._invalid=!0},i._applyFilters=function(t){var e,i=this.target.filters,n=this._drawWidth,s=this._drawHeight,r=0,a=i[r];do{a.usesContext?(e&&(t.putImageData(e,0,0),e=null),a.applyFilter(t,0,0,n,s)):(e||(e=t.getImageData(0,0,n,s)),a._applyFilter(e)),a=null!==a._multiPass?a._multiPass:i[++r]}while(a);e&&t.putImageData(e,0,0)},af.BitmapCache=t}(),this.createjs=this.createjs||{},function(){function t(t,e,i){this.Filter_constructor(),this._blurX=t,this._blurXTable=[],this._lastBlurX=null,this._blurY=e,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(i)||i<1)&&(i=1),this.setQuality(0|i)}var e=af.extend(t,af.Filter);e.getBlurX=function(){return this._blurX},e.getBlurY=function(){return this._blurY},e.setBlurX=function(t){(isNaN(t)||t<0)&&(t=0),this._blurX=t},e.setBlurY=function(t){(isNaN(t)||t<0)&&(t=0),this._blurY=t},e.getQuality=function(){return this._quality},e.setQuality=function(t){(isNaN(t)||t<0)&&(t=0),this._quality=0|t},e._getShader=function(){var t=this._lastBlurX!==this._blurX,e=this._lastBlurY!==this._blurY,i=this._lastQuality!==this._quality;return t||e||i?((t||i)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(e||i)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader},e._setShader=function(){this._compiledShader};try{Object.defineProperties(e,{blurX:{get:e.getBlurX,set:e.setBlurX},blurY:{get:e.getBlurY,set:e.setBlurY},quality:{get:e.getQuality,set:e.setQuality},_builtShader:{get:e._getShader,set:e._setShader}})}catch(i){console.log(i)}e._getTable=function(t){var e=4.2;if(t<=1)return[1];var i=[],n=Math.ceil(2*t);n+=n%2?0:1;for(var s=n/2|0,r=-s;r<=s;r++){var a=r/s*e;i.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-Math.pow(a,2)/4))}var o=i.reduce((function(t,e){return t+e}));return i.map((function(t,e,i){return t/o}))},e._updateShader=function(){if(void 0!==this._blurX&&void 0!==this._blurY){var t=this.FRAG_SHADER_TEMPLATE;t=t.replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0)),t=t.replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=t}},e.shaderParamSetup=function(t,e,i){t.uniform1fv(t.getUniformLocation(i,"xWeight"),this._blurXTable),t.uniform1fv(t.getUniformLocation(i,"yWeight"),this._blurYTable),t.uniform2f(t.getUniformLocation(i,"textureOffset"),2/(e._viewportWidth*this._quality),2/(e._viewportHeight*this._quality))},t.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],t.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],e.getBounds=function(t){var e=0|this.blurX,i=0|this.blurY;if(e<=0&&i<=0)return t;var n=Math.pow(this.quality,.2);return(t||new af.Rectangle).pad(i*n+1,e*n+1,i*n+1,e*n+1)},e.clone=function(){return new t(this.blurX,this.blurY,this.quality)},e.toString=function(){return"[BlurFilter]"},e._applyFilter=function(e){var i=this._blurX>>1;if(isNaN(i)||i<0)return!1;var n=this._blurY>>1;if(isNaN(n)||n<0)return!1;if(0==i&&0==n)return!1;var s=this.quality;(isNaN(s)||s<1)&&(s=1),s|=0,s>3&&(s=3),s<1&&(s=1);var r=e.data,a=0,o=0,l=0,h=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,v=0,_=0,b=0,y=0,w=i+i+1|0,E=n+n+1|0,C=0|e.width,T=0|e.height,x=C-1|0,S=T-1|0,I=i+1|0,L=n+1|0,O={r:0,b:0,g:0,a:0},A=O;for(l=1;l<w;l++)A=A.n={r:0,b:0,g:0,a:0};A.n=O;var k={r:0,b:0,g:0,a:0},R=k;for(l=1;l<E;l++)R=R.n={r:0,b:0,g:0,a:0};R.n=k;var P=null,D=0|t.MUL_TABLE[i],M=0|t.SHG_TABLE[i],j=0|t.MUL_TABLE[n],B=0|t.SHG_TABLE[n];while(s-- >0){d=u=0;var F=D,U=M;for(o=T;--o>-1;){for(f=I*(v=r[0|u]),p=I*(_=r[u+1|0]),m=I*(b=r[u+2|0]),g=I*(y=r[u+3|0]),A=O,l=I;--l>-1;)A.r=v,A.g=_,A.b=b,A.a=y,A=A.n;for(l=1;l<I;l++)h=u+((x<l?x:l)<<2)|0,f+=A.r=r[h],p+=A.g=r[h+1],m+=A.b=r[h+2],g+=A.a=r[h+3],A=A.n;for(P=O,a=0;a<C;a++)r[u++]=f*F>>>U,r[u++]=p*F>>>U,r[u++]=m*F>>>U,r[u++]=g*F>>>U,h=d+((h=a+i+1)<x?h:x)<<2,f-=P.r-(P.r=r[h]),p-=P.g-(P.g=r[h+1]),m-=P.b-(P.b=r[h+2]),g-=P.a-(P.a=r[h+3]),P=P.n;d+=C}for(F=j,U=B,a=0;a<C;a++){for(u=a<<2,f=L*(v=r[u])|0,p=L*(_=r[u+1|0])|0,m=L*(b=r[u+2|0])|0,g=L*(y=r[u+3|0])|0,R=k,l=0;l<L;l++)R.r=v,R.g=_,R.b=b,R.a=y,R=R.n;for(c=C,l=1;l<=n;l++)u=c+a<<2,f+=R.r=r[u],p+=R.g=r[u+1],m+=R.b=r[u+2],g+=R.a=r[u+3],R=R.n,l<S&&(c+=C);if(u=a,P=k,s>0)for(o=0;o<T;o++)h=u<<2,r[h+3]=y=g*F>>>U,y>0?(r[h]=f*F>>>U,r[h+1]=p*F>>>U,r[h+2]=m*F>>>U):r[h]=r[h+1]=r[h+2]=0,h=a+((h=o+L)<S?h:S)*C<<2,f-=P.r-(P.r=r[h]),p-=P.g-(P.g=r[h+1]),m-=P.b-(P.b=r[h+2]),g-=P.a-(P.a=r[h+3]),P=P.n,u+=C;else for(o=0;o<T;o++)h=u<<2,r[h+3]=y=g*F>>>U,y>0?(y=255/y,r[h]=(f*F>>>U)*y,r[h+1]=(p*F>>>U)*y,r[h+2]=(m*F>>>U)*y):r[h]=r[h+1]=r[h+2]=0,h=a+((h=o+L)<S?h:S)*C<<2,f-=P.r-(P.r=r[h]),p-=P.g-(P.g=r[h+1]),m-=P.b-(P.b=r[h+2]),g-=P.a-(P.a=r[h+3]),P=P.n,u+=C}}return!0},af.BlurFilter=af.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t){this.Filter_constructor(),this.alphaMap=t,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}var i=af.extend(t,af.Filter);i.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.alphaMap),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},i.clone=function(){var e=new t(this.alphaMap);return e._alphaMap=this._alphaMap,e._mapData=this._mapData,e},i.toString=function(){return"[AlphaMapFilter]"},i._applyFilter=function(t){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;for(var e=t.data,i=this._mapData,n=0,s=e.length;n<s;n+=4)e[n+3]=i[n]||0;return!0},i._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;var t,i=this._alphaMap=this.alphaMap,n=i;i instanceof HTMLCanvasElement?t=n.getContext("2d"):(n=af.createCanvas?af.createCanvas():e.createElement("canvas"),n.width=i.width,n.height=i.height,t=n.getContext("2d"),t.drawImage(i,0,0));try{var s=t.getImageData(0,0,i.width,i.height)}catch(r){return!1}return this._mapData=s.data,!0},af.AlphaMapFilter=af.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t){this.Filter_constructor(),this.mask=t,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}var e=af.extend(t,af.Filter);e.shaderParamSetup=function(t,e,i){this._mapTexture||(this._mapTexture=t.createTexture()),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._mapTexture),e.setTextureParams(t),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.mask),t.uniform1i(t.getUniformLocation(i,"uAlphaSampler"),1)},e.applyFilter=function(t,e,i,n,s,r,a,o){return!this.mask||(r=r||t,null==a&&(a=e),null==o&&(o=i),r.save(),t==r&&(r.globalCompositeOperation="destination-in",r.drawImage(this.mask,a,o),r.restore(),!0))},e.clone=function(){return new t(this.mask)},e.toString=function(){return"[AlphaMaskFilter]"},af.AlphaMaskFilter=af.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n,s,r,a,o){this.Filter_constructor(),this.redMultiplier=null!=t?t:1,this.greenMultiplier=null!=e?e:1,this.blueMultiplier=null!=i?i:1,this.alphaMultiplier=null!=n?n:1,this.redOffset=s||0,this.greenOffset=r||0,this.blueOffset=a||0,this.alphaOffset=o||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}var e=af.extend(t,af.Filter);e.shaderParamSetup=function(t,e,i){t.uniform4f(t.getUniformLocation(i,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),t.uniform4f(t.getUniformLocation(i,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},e.toString=function(){return"[ColorFilter]"},e.clone=function(){return new t(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},e._applyFilter=function(t){for(var e=t.data,i=e.length,n=0;n<i;n+=4)e[n]=e[n]*this.redMultiplier+this.redOffset,e[n+1]=e[n+1]*this.greenMultiplier+this.greenOffset,e[n+2]=e[n+2]*this.blueMultiplier+this.blueOffset,e[n+3]=e[n+3]*this.alphaMultiplier+this.alphaOffset;return!0},af.ColorFilter=af.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function t(t,e,i,n){this.setColor(t,e,i,n)}var e=t.prototype;t.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],t.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],t.LENGTH=t.IDENTITY_MATRIX.length,e.setColor=function(t,e,i,n){return this.reset().adjustColor(t,e,i,n)},e.reset=function(){return this.copy(t.IDENTITY_MATRIX)},e.adjustColor=function(t,e,i,n){return this.adjustHue(n),this.adjustContrast(e),this.adjustBrightness(t),this.adjustSaturation(i)},e.adjustBrightness=function(t){return 0==t||isNaN(t)||(t=this._cleanValue(t,255),this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])),this},e.adjustContrast=function(e){return 0==e||isNaN(e)||(e=this._cleanValue(e,100),e<0?i=127+e/100*127:(i=e%1,i=0==i?t.DELTA_INDEX[e]:t.DELTA_INDEX[e|0]*(1-i)+t.DELTA_INDEX[1+(e|0)]*i,i=127*i+127),this._multiplyMatrix([i/127,0,0,0,.5*(127-i),0,i/127,0,0,.5*(127-i),0,0,i/127,0,.5*(127-i),0,0,0,1,0,0,0,0,0,1])),this;var i},e.adjustSaturation=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,100);var e=1+(t>0?3*t/100:t/100),i=.3086,n=.6094,s=.082;return this._multiplyMatrix([i*(1-e)+e,n*(1-e),s*(1-e),0,0,i*(1-e),n*(1-e)+e,s*(1-e),0,0,i*(1-e),n*(1-e),s*(1-e)+e,0,0,0,0,0,1,0,0,0,0,0,1]),this},e.adjustHue=function(t){if(0==t||isNaN(t))return this;t=this._cleanValue(t,180)/180*Math.PI;var e=Math.cos(t),i=Math.sin(t),n=.213,s=.715,r=.072;return this._multiplyMatrix([n+e*(1-n)+i*-n,s+e*-s+i*-s,r+e*-r+i*(1-r),0,0,n+e*-n+.143*i,s+e*(1-s)+.14*i,r+e*-r+-.283*i,0,0,n+e*-n+i*-(1-n),s+e*-s+i*s,r+e*(1-r)+i*r,0,0,0,0,0,1,0,0,0,0,0,1]),this},e.concat=function(e){return e=this._fixMatrix(e),e.length!=t.LENGTH||this._multiplyMatrix(e),this},e.clone=function(){return(new t).copy(this)},e.toArray=function(){for(var e=[],i=0,n=t.LENGTH;i<n;i++)e[i]=this[i];return e},e.copy=function(e){for(var i=t.LENGTH,n=0;n<i;n++)this[n]=e[n];return this},e.toString=function(){return"[ColorMatrix]"},e._multiplyMatrix=function(t){var e,i,n,s=[];for(e=0;e<5;e++){for(i=0;i<5;i++)s[i]=this[i+5*e];for(i=0;i<5;i++){var r=0;for(n=0;n<5;n++)r+=t[i+5*n]*s[n];this[i+5*e]=r}}},e._cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},e._fixMatrix=function(e){return e instanceof t&&(e=e.toArray()),e.length<t.LENGTH?e=e.slice(0,e.length).concat(t.IDENTITY_MATRIX.slice(e.length,t.LENGTH)):e.length>t.LENGTH&&(e=e.slice(0,t.LENGTH)),e},af.ColorMatrix=t}(),this.createjs=this.createjs||{},function(){function t(t){this.Filter_constructor(),this.matrix=t,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}var e=af.extend(t,af.Filter);e.shaderParamSetup=function(t,e,i){var n=this.matrix,s=new Float32Array([n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]]);t.uniformMatrix4fv(t.getUniformLocation(i,"uColorMatrix"),!1,s),t.uniform4f(t.getUniformLocation(i,"uColorMatrixOffset"),n[4]/255,n[9]/255,n[14]/255,n[19]/255)},e.toString=function(){return"[ColorMatrixFilter]"},e.clone=function(){return new t(this.matrix)},e._applyFilter=function(t){for(var e,i,n,s,r=t.data,a=r.length,o=this.matrix,l=o[0],h=o[1],c=o[2],u=o[3],d=o[4],f=o[5],p=o[6],m=o[7],g=o[8],v=o[9],_=o[10],b=o[11],y=o[12],w=o[13],E=o[14],C=o[15],T=o[16],x=o[17],S=o[18],I=o[19],L=0;L<a;L+=4)e=r[L],i=r[L+1],n=r[L+2],s=r[L+3],r[L]=e*l+i*h+n*c+s*u+d,r[L+1]=e*f+i*p+n*m+s*g+v,r[L+2]=e*_+i*b+n*y+s*w+E,r[L+3]=e*C+i*T+n*x+s*S+I;return!0},af.ColorMatrixFilter=af.promote(t,"Filter")}(),this.createjs=this.createjs||{},function(){function e(){throw"Touch cannot be instantiated"}e.isSupported=function(){return!!("ontouchstart"in t||t.navigator["msPointerEnabled"]&&t.navigator["msMaxTouchPoints"]>0||t.navigator["pointerEnabled"]&&t.navigator["maxTouchPoints"]>0)},e.enable=function(i,n,s){return!!(i&&i.canvas&&e.isSupported())&&(i.__touch||(i.__touch={pointers:{},multitouch:!n,preventDefault:!s,count:0},"ontouchstart"in t?e._IOS_enable(i):(t.navigator["msPointerEnabled"]||t.navigator["pointerEnabled"])&&e._IE_enable(i)),!0)},e.disable=function(i){i&&("ontouchstart"in t?e._IOS_disable(i):(t.navigator["msPointerEnabled"]||t.navigator["pointerEnabled"])&&e._IE_disable(i),delete i.__touch)},e._IOS_enable=function(t){var i=t.canvas,n=t.__touch.f=function(i){e._IOS_handleEvent(t,i)};i.addEventListener("touchstart",n,!1),i.addEventListener("touchmove",n,!1),i.addEventListener("touchend",n,!1),i.addEventListener("touchcancel",n,!1)},e._IOS_disable=function(t){var e=t.canvas;if(e){var i=t.__touch.f;e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",i,!1),e.removeEventListener("touchend",i,!1),e.removeEventListener("touchcancel",i,!1)}},e._IOS_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();for(var i=e.changedTouches,n=e.type,s=0,r=i.length;s<r;s++){var a=i[s],o=a.identifier;a.target==t.canvas&&("touchstart"==n?this._handleStart(t,o,e,a.pageX,a.pageY):"touchmove"==n?this._handleMove(t,o,e,a.pageX,a.pageY):"touchend"!=n&&"touchcancel"!=n||this._handleEnd(t,o,e))}}},e._IE_enable=function(i){var n=i.canvas,s=i.__touch.f=function(t){e._IE_handleEvent(i,t)};void 0===t.navigator["pointerEnabled"]?(n.addEventListener("MSPointerDown",s,!1),t.addEventListener("MSPointerMove",s,!1),t.addEventListener("MSPointerUp",s,!1),t.addEventListener("MSPointerCancel",s,!1),i.__touch.preventDefault&&(n.style.msTouchAction="none")):(n.addEventListener("pointerdown",s,!1),t.addEventListener("pointermove",s,!1),t.addEventListener("pointerup",s,!1),t.addEventListener("pointercancel",s,!1),i.__touch.preventDefault&&(n.style.touchAction="none")),i.__touch.activeIDs={}},e._IE_disable=function(e){var i=e.__touch.f;void 0===t.navigator["pointerEnabled"]?(t.removeEventListener("MSPointerMove",i,!1),t.removeEventListener("MSPointerUp",i,!1),t.removeEventListener("MSPointerCancel",i,!1),e.canvas&&e.canvas.removeEventListener("MSPointerDown",i,!1)):(t.removeEventListener("pointermove",i,!1),t.removeEventListener("pointerup",i,!1),t.removeEventListener("pointercancel",i,!1),e.canvas&&e.canvas.removeEventListener("pointerdown",i,!1))},e._IE_handleEvent=function(t,e){if(t){t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();var i=e.type,n=e.pointerId,s=t.__touch.activeIDs;if("MSPointerDown"==i||"pointerdown"==i){if(e.srcElement!=t.canvas)return;s[n]=!0,this._handleStart(t,n,e,e.pageX,e.pageY)}else s[n]&&("MSPointerMove"==i||"pointermove"==i?this._handleMove(t,n,e,e.pageX,e.pageY):"MSPointerUp"!=i&&"MSPointerCancel"!=i&&"pointerup"!=i&&"pointercancel"!=i||(delete s[n],this._handleEnd(t,n,e)))}},e._handleStart=function(t,e,i,n,s){var r=t.__touch;if(r.multitouch||!r.count){var a=r.pointers;a[e]||(a[e]=!0,r.count++,t._handlePointerDown(e,i,n,s))}},e._handleMove=function(t,e,i,n,s){t.__touch.pointers[e]&&t._handlePointerMove(e,i,n,s)},e._handleEnd=function(t,e,i){var n=t.__touch,s=n.pointers;s[e]&&(n.count--,t._handlePointerUp(e,i,!0),delete s[e])},af.Touch=e}(),this.createjs=this.createjs||{},function(){var t=af.EaselJS=af.EaselJS||{};t.version="1.0.0",t.buildDate="Thu, 14 Sep 2017 19:47:53 GMT"}()};if("undefined"===typeof sf)var sf=i.g.window||{};const rf=sf.document||{},af=sf.createjs=sf.createjs||{};nf.call(sf,sf,rf);var of=af;
/*!
* TweenJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/
const lf=function(t,e){this.createjs=this.createjs||{},uf.extend=function(t,e){function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},uf.promote=function(t,e){var i=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(n)for(var s in i[(e+="_")+"constructor"]=n.constructor,n)i.hasOwnProperty(s)&&"function"==typeof n[s]&&(i[e+s]=n[s]);return t},this.createjs=this.createjs||{},uf.deprecate=function(t,e){return function(){var i="Deprecated property or method '"+e+"'. See docs for info.";return console&&(console.warn?console.warn(i):console.log(i)),t&&t.apply(this,arguments)}},this.createjs=this.createjs||{},function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},uf.Event=t}(),this.createjs=this.createjs||{},function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,a=s.length;r<a;r++)if(s[r]==e){1==a?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"==typeof t){var n=this._listeners;if(!e&&(!n||!n[t]))return!0;t=new uf.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(l){}if(t.bubbles&&this.parent){var s=this,r=[s];while(s.parent)r.push(s=s.parent);var a,o=r.length;for(a=o-1;a>=0&&!t.propagationStopped;a--)r[a]._dispatchEvent(t,1+(0==a));for(a=1;a<o&&!t.propagationStopped;a++)r[a]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){var e=this;while(e){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n,s=e<=2?this._captureListeners:this._listeners;if(t&&s&&(n=s[t.type])&&(i=n.length)){try{t.currentTarget=this}catch(o){}try{t.eventPhase=0|e}catch(o){}t.removed=!1,n=n.slice();for(var r=0;r<i&&!t.immediatePropagationStopped;r++){var a=n[r];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},uf.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){function e(){throw"Ticker cannot be instantiated."}e.RAF_SYNCHED="synched",e.RAF="raf",e.TIMEOUT="timeout",e.timingMode=null,e.maxDelta=0,e.paused=!1,e.removeEventListener=null,e.removeAllEventListeners=null,e.dispatchEvent=null,e.hasEventListener=null,e._listeners=null,uf.EventDispatcher.initialize(e),e._addEventListener=e.addEventListener,e.addEventListener=function(){return!e._inited&&e.init(),e._addEventListener.apply(e,arguments)},e._inited=!1,e._startTime=0,e._pausedTime=0,e._ticks=0,e._pausedTicks=0,e._interval=50,e._lastTime=0,e._times=null,e._tickTimes=null,e._timerId=null,e._raf=!0,e._setInterval=function(t){e._interval=t,e._inited&&e._setupTick()},e.setInterval=uf.deprecate(e._setInterval,"Ticker.setInterval"),e._getInterval=function(){return e._interval},e.getInterval=uf.deprecate(e._getInterval,"Ticker.getInterval"),e._setFPS=function(t){e._setInterval(1e3/t)},e.setFPS=uf.deprecate(e._setFPS,"Ticker.setFPS"),e._getFPS=function(){return 1e3/e._interval},e.getFPS=uf.deprecate(e._getFPS,"Ticker.getFPS");try{Object.defineProperties(e,{interval:{get:e._getInterval,set:e._setInterval},framerate:{get:e._getFPS,set:e._setFPS}})}catch(s){console.log(s)}e.init=function(){e._inited||(e._inited=!0,e._times=[],e._tickTimes=[],e._startTime=e._getTime(),e._times.push(e._lastTime=0),e.interval=e._interval)},e.reset=function(){if(e._raf){var i=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.oCancelAnimationFrame||t.msCancelAnimationFrame;i&&i(e._timerId)}else clearTimeout(e._timerId);e.removeAllEventListeners("tick"),e._timerId=e._times=e._tickTimes=null,e._startTime=e._lastTime=e._ticks=e._pausedTime=0,e._inited=!1},e.getMeasuredTickTime=function(t){var i=0,n=e._tickTimes;if(!n||n.length<1)return-1;t=Math.min(n.length,t||0|e._getFPS());for(var s=0;s<t;s++)i+=n[s];return i/t},e.getMeasuredFPS=function(t){var i=e._times;return!i||i.length<2?-1:(t=Math.min(i.length-1,t||0|e._getFPS()),1e3/((i[0]-i[t])/t))},e.getTime=function(t){return e._startTime?e._getTime()-(t?e._pausedTime:0):-1},e.getEventTime=function(t){return e._startTime?(e._lastTime||e._startTime)-(t?e._pausedTime:0):-1},e.getTicks=function(t){return e._ticks-(t?e._pausedTicks:0)},e._handleSynch=function(){e._timerId=null,e._setupTick(),e._getTime()-e._lastTime>=.97*(e._interval-1)&&e._tick()},e._handleRAF=function(){e._timerId=null,e._setupTick(),e._tick()},e._handleTimeout=function(){e._timerId=null,e._setupTick(),e._tick()},e._setupTick=function(){if(null==e._timerId){var i=e.timingMode;if(i==e.RAF_SYNCHED||i==e.RAF){var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame;if(n)return e._timerId=n(i==e.RAF?e._handleRAF:e._handleSynch),void(e._raf=!0)}e._raf=!1,e._timerId=setTimeout(e._handleTimeout,e._interval)}},e._tick=function(){var t=e.paused,i=e._getTime(),n=i-e._lastTime;if(e._lastTime=i,e._ticks++,t&&(e._pausedTicks++,e._pausedTime+=n),e.hasEventListener("tick")){var s=new uf.Event("tick"),r=e.maxDelta;s.delta=r&&n>r?r:n,s.paused=t,s.time=i,s.runTime=i-e._pausedTime,e.dispatchEvent(s)}e._tickTimes.unshift(e._getTime()-i);while(e._tickTimes.length>100)e._tickTimes.pop();e._times.unshift(i);while(e._times.length>100)e._times.pop()};var i=t,n=i.performance.now||i.performance.mozNow||i.performance.msNow||i.performance.oNow||i.performance.webkitNow;e._getTime=function(){return(n&&n.call(i.performance)||(new Date).getTime())-e._startTime},uf.Ticker=e}(),this.createjs=this.createjs||{},function(){function t(t){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,t&&(this.useTicks=!!t.useTicks,this.ignoreGlobalPause=!!t.ignoreGlobalPause,this.loop=!0===t.loop?-1:t.loop||0,this.reversed=!!t.reversed,this.bounce=!!t.bounce,this.timeScale=t.timeScale||1,t.onChange&&this.addEventListener("change",t.onChange),t.onComplete&&this.addEventListener("complete",t.onComplete))}var e=uf.extend(t,uf.EventDispatcher);e._setPaused=function(t){return uf.Tween._register(this,t),this},e.setPaused=uf.deprecate(e._setPaused,"AbstractTween.setPaused"),e._getPaused=function(){return this._paused},e.getPaused=uf.deprecate(e._getPaused,"AbstactTween.getPaused"),e._getCurrentLabel=function(t){var e=this.getLabels();null==t&&(t=this.position);for(var i=0,n=e.length;i<n;i++)if(t<e[i].position)break;return 0===i?null:e[i-1].label},e.getCurrentLabel=uf.deprecate(e._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(e,{paused:{set:e._setPaused,get:e._getPaused},currentLabel:{get:e._getCurrentLabel}})}catch(i){}e.advance=function(t,e){this.setPosition(this.rawPosition+t*this.timeScale,e)},e.setPosition=function(t,e,i,n){var s=this.duration,r=this.loop,a=this.rawPosition,o=0,l=0,h=!1;if(t<0&&(t=0),0===s){if(h=!0,-1!==a)return h}else{if(o=t/s|0,l=t-o*s,h=-1!==r&&t>=r*s+s,h&&(t=(l=s)*(o=r)+s),t===a)return h;var c=!this.reversed!==!(this.bounce&&o%2);c&&(l=s-l)}this.position=l,this.rawPosition=t,this._updatePosition(i,h),h&&(this.paused=!0),n&&n(this),e||this._runActions(a,t,i,!i&&-1===a),this.dispatchEvent("change"),h&&this.dispatchEvent("complete")},e.calculatePosition=function(t){var e=this.duration,i=this.loop,n=0,s=0;if(0===e)return 0;-1!==i&&t>=i*e+e?(s=e,n=i):t<0?s=0:(n=t/e|0,s=t-n*e);var r=!this.reversed!==!(this.bounce&&n%2);return r?e-s:s},e.getLabels=function(){var t=this._labelList;if(!t){t=this._labelList=[];var e=this._labels;for(var i in e)t.push({label:i,position:e[i]});t.sort((function(t,e){return t.position-e.position}))}return t},e.setLabels=function(t){this._labels=t,this._labelList=null},e.addLabel=function(t,e){this._labels||(this._labels={}),this._labels[t]=e;var i=this._labelList;if(i){for(var n=0,s=i.length;n<s;n++)if(e<i[n].position)break;i.splice(n,0,{label:t,position:e})}},e.gotoAndPlay=function(t){this.paused=!1,this._goto(t)},e.gotoAndStop=function(t){this.paused=!0,this._goto(t)},e.resolve=function(t){var e=Number(t);return isNaN(e)&&(e=this._labels&&this._labels[t]),e},e.toString=function(){return"[AbstractTween]"},e.clone=function(){throw"AbstractTween can not be cloned."},e._init=function(t){t&&t.paused||(this.paused=!1),t&&null!=t.position&&this.setPosition(t.position)},e._updatePosition=function(t,e){},e._goto=function(t){var e=this.resolve(t);null!=e&&this.setPosition(e,!1,!0)},e._runActions=function(t,e,i,n){if(this._actionHead||this.tweens){var s,r,a,o,l=this.duration,h=this.reversed,c=this.bounce,u=this.loop;if(0===l?(s=r=a=o=0,h=c=!1):(s=t/l|0,r=e/l|0,a=t-s*l,o=e-r*l),-1!==u&&(r>u&&(o=l,r=u),s>u&&(a=l,s=u)),i)return this._runActionsRange(o,o,i,n);if(s!==r||a!==o||i||n){-1===s&&(s=a=0);var d=t<=e,f=s;do{var p=!h!==!(c&&f%2),m=f===s?a:d?0:l,g=f===r?o:d?l:0;if(p&&(m=l-m,g=l-g),c&&f!==s&&m===g);else if(this._runActionsRange(m,g,i,n||f!==s&&!c))return!0;n=!1}while(d&&++f<=r||!d&&--f>=r)}}},e._runActionsRange=function(t,e,i,n){},uf.AbstractTween=uf.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){function t(e,n){this.AbstractTween_constructor(n),this.pluginData=null,this.target=e,this.passive=!1,this._stepHead=new i(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,n&&(this.pluginData=n.pluginData,n.override&&t.removeTweens(e)),this.pluginData||(this.pluginData={}),this._init(n)}var e=uf.extend(t,uf.AbstractTween);function i(t,e,i,n,s,r){this.next=null,this.prev=t,this.t=e,this.d=i,this.props=n,this.ease=s,this.passive=r,this.index=t?t.index+1:0}function n(t,e,i,n,s){this.next=null,this.prev=t,this.t=e,this.d=0,this.scope=i,this.funct=n,this.params=s}t.IGNORE={},t._tweens=[],t._plugins=null,t._tweenHead=null,t._tweenTail=null,t.get=function(e,i){return new t(e,i)},t.tick=function(e,i){var n=t._tweenHead;while(n){var s=n._next;i&&!n.ignoreGlobalPause||n._paused||n.advance(n.useTicks?1:e),n=s}},t.handleEvent=function(t){"tick"===t.type&&this.tick(t.delta,t.paused)},t.removeTweens=function(e){if(e.tweenjs_count){var i=t._tweenHead;while(i){var n=i._next;i.target===e&&t._register(i,!0),i=n}e.tweenjs_count=0}},t.removeAllTweens=function(){var e=t._tweenHead;while(e){var i=e._next;e._paused=!0,e.target&&(e.target.tweenjs_count=0),e._next=e._prev=null,e=i}t._tweenHead=t._tweenTail=null},t.hasActiveTweens=function(e){return e?!!e.tweenjs_count:!!t._tweenHead},t._installPlugin=function(e){for(var i=e.priority=e.priority||0,n=t._plugins=t._plugins||[],s=0,r=n.length;s<r;s++)if(i<n[s].priority)break;n.splice(s,0,e)},t._register=function(e,i){var n=e.target;if(!i&&e._paused){n&&(n.tweenjs_count=n.tweenjs_count?n.tweenjs_count+1:1);var s=t._tweenTail;s?(t._tweenTail=s._next=e,e._prev=s):t._tweenHead=t._tweenTail=e,!t._inited&&uf.Ticker&&(uf.Ticker.addEventListener("tick",t),t._inited=!0)}else if(i&&!e._paused){n&&n.tweenjs_count--;var r=e._next,a=e._prev;r?r._prev=a:t._tweenTail=a,a?a._next=r:t._tweenHead=r,e._next=e._prev=null}e._paused=i},e.wait=function(t,e){return t>0&&this._addStep(+t,this._stepTail.props,null,e),this},e.to=function(t,e,i){(null==e||e<0)&&(e=0);var n=this._addStep(+e,null,i);return this._appendProps(t,n),this},e.label=function(t){return this.addLabel(t,this.duration),this},e.call=function(t,e,i){return this._addAction(i||this.target,t,e||[this])},e.set=function(t,e){return this._addAction(e||this.target,this._set,[t])},e.play=function(t){return this._addAction(t||this,this._set,[{paused:!1}])},e.pause=function(t){return this._addAction(t||this,this._set,[{paused:!0}])},e.w=e.wait,e.t=e.to,e.c=e.call,e.s=e.set,e.toString=function(){return"[Tween]"},e.clone=function(){throw"Tween can not be cloned."},e._addPlugin=function(t){var e=this._pluginIds||(this._pluginIds={}),i=t.ID;if(i&&!e[i]){e[i]=!0;for(var n=this._plugins||(this._plugins=[]),s=t.priority||0,r=0,a=n.length;r<a;r++)if(s<n[r].priority)return void n.splice(r,0,t);n.push(t)}},e._updatePosition=function(t,e){var i=this._stepHead.next,n=this.position,s=this.duration;if(this.target&&i){var r=i.next;while(r&&r.t<=n)i=i.next,r=i.next;var a=e?0===s?1:n/s:(n-i.t)/i.d;this._updateTargetProps(i,a,e)}this._stepPosition=i?n-i.t:0},e._updateTargetProps=function(e,i,n){if(!(this.passive=!!e.passive)){var s,r,a,o,l=e.prev.props,h=e.props;(o=e.ease)&&(i=o(i,0,1,1));var c=this._plugins;t:for(var u in l){if(r=l[u],a=h[u],s=r!==a&&"number"===typeof r?r+(a-r)*i:i>=1?a:r,c)for(var d=0,f=c.length;d<f;d++){var p=c[d].change(this,e,u,s,i,n);if(p===t.IGNORE)continue t;void 0!==p&&(s=p)}this.target[u]=s}}},e._runActionsRange=function(t,e,i,n){var s=t>e,r=s?this._actionTail:this._actionHead,a=e,o=t;s&&(a=t,o=e);var l=this.position;while(r){var h=r.t;if((h===e||h>o&&h<a||n&&h===t)&&(r.funct.apply(r.scope,r.params),l!==this.position))return!0;r=s?r.prev:r.next}},e._appendProps=function(e,i,n){var s,r,a,o,l,h=this._stepHead.props,c=this.target,u=t._plugins,d=i.prev,f=d.props,p=i.props||(i.props=this._cloneProps(f)),m={};for(s in e)if(e.hasOwnProperty(s)&&(m[s]=p[s]=e[s],void 0===h[s])){if(o=void 0,u)for(r=u.length-1;r>=0;r--)if(a=u[r].init(this,s,o),void 0!==a&&(o=a),o===t.IGNORE){delete p[s],delete m[s];break}o!==t.IGNORE&&(void 0===o&&(o=c[s]),f[s]=void 0===o?null:o)}for(s in m){a=e[s];var g,v=d;while((g=v)&&(v=g.prev))if(v.props!==g.props){if(void 0!==v.props[s])break;v.props[s]=f[s]}}if(!1!==n&&(u=this._plugins))for(r=u.length-1;r>=0;r--)u[r].step(this,i,m);(l=this._injected)&&(this._injected=null,this._appendProps(l,i,!1))},e._injectProp=function(t,e){var i=this._injected||(this._injected={});i[t]=e},e._addStep=function(t,e,n,s){var r=new i(this._stepTail,this.duration,t,e,n,s||!1);return this.duration+=t,this._stepTail=this._stepTail.next=r},e._addAction=function(t,e,i){var s=new n(this._actionTail,this.duration,t,e,i);return this._actionTail?this._actionTail.next=s:this._actionHead=s,this._actionTail=s,this},e._set=function(t){for(var e in t)this[e]=t[e]},e._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},uf.Tween=uf.promote(t,"AbstractTween")}(),this.createjs=this.createjs||{},function(){function t(t){var e,i;t instanceof Array||null==t&&arguments.length>1?(e=t,i=arguments[1],t=arguments[2]):t&&(e=t.tweens,i=t.labels),this.AbstractTween_constructor(t),this.tweens=[],e&&this.addTween.apply(this,e),this.setLabels(i),this._init(t)}var e=uf.extend(t,uf.AbstractTween);e.addTween=function(t){t._parent&&t._parent.removeTween(t);var e=arguments.length;if(e>1){for(var i=0;i<e;i++)this.addTween(arguments[i]);return arguments[e-1]}if(0===e)return null;this.tweens.push(t),t._parent=this,t.paused=!0;var n=t.duration;return t.loop>0&&(n*=t.loop+1),n>this.duration&&(this.duration=n),this.rawPosition>=0&&t.setPosition(this.rawPosition),t},e.removeTween=function(t){var e=arguments.length;if(e>1){for(var i=!0,n=0;n<e;n++)i=i&&this.removeTween(arguments[n]);return i}if(0===e)return!0;var s=this.tweens;n=s.length;while(n--)if(s[n]===t)return s.splice(n,1),t._parent=null,t.duration>=this.duration&&this.updateDuration(),!0;return!1},e.updateDuration=function(){this.duration=0;for(var t=0,e=this.tweens.length;t<e;t++){var i=this.tweens[t],n=i.duration;i.loop>0&&(n*=i.loop+1),n>this.duration&&(this.duration=n)}},e.toString=function(){return"[Timeline]"},e.clone=function(){throw"Timeline can not be cloned."},e._updatePosition=function(t,e){for(var i=this.position,n=0,s=this.tweens.length;n<s;n++)this.tweens[n].setPosition(i,!0,t)},e._runActionsRange=function(t,e,i,n){for(var s=this.position,r=0,a=this.tweens.length;r<a;r++)if(this.tweens[r]._runActions(t,e,i,n),s!==this.position)return!0},uf.Timeline=uf.promote(t,"AbstractTween")}(),this.createjs=this.createjs||{},function(){function t(){throw"Ease cannot be instantiated."}t.linear=function(t){return t},t.none=t.linear,t.get=function(t){return t<-1?t=-1:t>1&&(t=1),function(e){return 0==t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},t.getPowIn=function(t){return function(e){return Math.pow(e,t)}},t.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},t.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},t.quadIn=t.getPowIn(2),t.quadOut=t.getPowOut(2),t.quadInOut=t.getPowInOut(2),t.cubicIn=t.getPowIn(3),t.cubicOut=t.getPowOut(3),t.cubicInOut=t.getPowInOut(3),t.quartIn=t.getPowIn(4),t.quartOut=t.getPowOut(4),t.quartInOut=t.getPowInOut(4),t.quintIn=t.getPowIn(5),t.quintOut=t.getPowOut(5),t.quintInOut=t.getPowInOut(5),t.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},t.sineOut=function(t){return Math.sin(t*Math.PI/2)},t.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},t.backIn=t.getBackIn(1.7),t.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},t.backOut=t.getBackOut(1.7),t.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},t.backInOut=t.getBackInOut(1.7),t.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},t.circOut=function(t){return Math.sqrt(1- --t*t)},t.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},t.bounceIn=function(e){return 1-t.bounceOut(1-e)},t.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},t.bounceInOut=function(e){return e<.5?.5*t.bounceIn(2*e):.5*t.bounceOut(2*e-1)+.5},t.getElasticIn=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return-t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e)}},t.elasticIn=t.getElasticIn(1,.3),t.getElasticOut=function(t,e){var i=2*Math.PI;return function(n){if(0==n||1==n)return n;var s=e/i*Math.asin(1/t);return t*Math.pow(2,-10*n)*Math.sin((n-s)*i/e)+1}},t.elasticOut=t.getElasticOut(1,.3),t.getElasticInOut=function(t,e){var i=2*Math.PI;return function(n){var s=e/i*Math.asin(1/t);return(n*=2)<1?t*Math.pow(2,10*(n-=1))*Math.sin((n-s)*i/e)*-.5:t*Math.pow(2,-10*(n-=1))*Math.sin((n-s)*i/e)*.5+1}},t.elasticInOut=t.getElasticInOut(1,.3*1.5),uf.Ease=t}(),this.createjs=this.createjs||{},function(){function t(){throw"MotionGuidePlugin cannot be instantiated."}var e=t;e.priority=0,e.ID="MotionGuide",e.install=function(){return uf.Tween._installPlugin(t),uf.Tween.IGNORE},e.init=function(t,i,n){"guide"==i&&t._addPlugin(e)},e.step=function(t,i,n){for(var s in n)if("guide"===s){var r=i.props.guide,a=e._solveGuideData(n.guide,r);r.valid=!a;var o=r.endData;if(t._injectProp("x",o.x),t._injectProp("y",o.y),a||!r.orient)break;var l=void 0===i.prev.props.rotation?t.target.rotation||0:i.prev.props.rotation;if(r.startOffsetRot=l-r.startData.rotation,"fixed"==r.orient)r.endAbsRot=o.rotation+r.startOffsetRot,r.deltaRotation=0;else{var h=void 0===n.rotation?t.target.rotation||0:n.rotation,c=h-r.endData.rotation-r.startOffsetRot,u=c%360;switch(r.endAbsRot=h,r.orient){case"auto":r.deltaRotation=c;break;case"cw":r.deltaRotation=(u+360)%360+360*Math.abs(c/360|0);break;case"ccw":r.deltaRotation=(u-360)%360+-360*Math.abs(c/360|0);break}}t._injectProp("rotation",r.endAbsRot)}},e.change=function(t,i,n,s,r,a){var o=i.props.guide;if(o&&i.props!==i.prev.props&&o!==i.prev.props.guide)return"guide"===n&&!o.valid||"x"==n||"y"==n||"rotation"===n&&o.orient?uf.Tween.IGNORE:void e._ratioToPositionData(r,o,t.target)},e.debug=function(t,i,n){t=t.guide||t;var s=e._findPathProblems(t);if(s&&console.error("MotionGuidePlugin Error found: \n"+s),!i)return s;var r=t.path,a=r.length,o=3,l=9;for(i.save(),i.lineCap="round",i.lineJoin="miter",i.beginPath(),i.moveTo(r[0],r[1]),d=2;d<a;d+=4)i.quadraticCurveTo(r[d],r[d+1],r[d+2],r[d+3]);i.strokeStyle="black",i.lineWidth=1.5*o,i.stroke(),i.strokeStyle="white",i.lineWidth=o,i.stroke(),i.closePath();var h=n.length;if(n&&h){var c={},u={};e._solveGuideData(t,c);for(var d=0;d<h;d++)c.orient="fixed",e._ratioToPositionData(n[d],c,u),i.beginPath(),i.moveTo(u.x,u.y),i.lineTo(u.x+Math.cos(.0174533*u.rotation)*l,u.y+Math.sin(.0174533*u.rotation)*l),i.strokeStyle="black",i.lineWidth=1.5*o,i.stroke(),i.strokeStyle="red",i.lineWidth=o,i.stroke(),i.closePath()}return i.restore(),s},e._solveGuideData=function(t,i){var n=void 0;if(n=e.debug(t))return n;var s=i.path=t.path;i.orient=t.orient;i.subLines=[],i.totalLength=0,i.startOffsetRot=0,i.deltaRotation=0,i.startData={ratio:0},i.endData={ratio:1},i.animSpan=1;var r,a,o,l,h,c,u,d,f,p=s.length,m=10,g={};for(r=s[0],a=s[1],u=2;u<p;u+=4){o=s[u],l=s[u+1],h=s[u+2],c=s[u+3];var v={weightings:[],estLength:0,portion:0},_=r,b=a;for(d=1;d<=m;d++){e._getParamsForCurve(r,a,o,l,h,c,d/m,!1,g);var y=g.x-_,w=g.y-b;f=Math.sqrt(y*y+w*w),v.weightings.push(f),v.estLength+=f,_=g.x,b=g.y}for(i.totalLength+=v.estLength,d=0;d<m;d++)f=v.estLength,v.weightings[d]=v.weightings[d]/f;i.subLines.push(v),r=h,a=c}f=i.totalLength;var E=i.subLines.length;for(u=0;u<E;u++)i.subLines[u].portion=i.subLines[u].estLength/f;var C=isNaN(t.start)?0:t.start,T=isNaN(t.end)?1:t.end;e._ratioToPositionData(C,i,i.startData),e._ratioToPositionData(T,i,i.endData),i.startData.ratio=C,i.endData.ratio=T,i.animSpan=i.endData.ratio-i.startData.ratio},e._ratioToPositionData=function(t,i,n){var s,r,a,o,l,h=i.subLines,c=0,u=10,d=t*i.animSpan+i.startData.ratio;for(r=h.length,s=0;s<r;s++){if(o=h[s].portion,c+o>=d){l=s;break}c+=o}void 0===l&&(l=r-1,c-=o);var f=h[l].weightings,p=o;for(r=f.length,s=0;s<r;s++){if(o=f[s]*p,c+o>=d)break;c+=o}l=4*l+2,a=s/u+(d-c)/o*(1/u);var m=i.path;return e._getParamsForCurve(m[l-2],m[l-1],m[l],m[l+1],m[l+2],m[l+3],a,i.orient,n),i.orient&&(t>=.99999&&t<=1.00001&&void 0!==i.endAbsRot?n.rotation=i.endAbsRot:n.rotation+=i.startOffsetRot+t*i.deltaRotation),n},e._getParamsForCurve=function(t,e,i,n,s,r,a,o,l){var h=1-a;l.x=h*h*t+2*h*a*i+a*a*s,l.y=h*h*e+2*h*a*n+a*a*r,o&&(l.rotation=57.2957795*Math.atan2((n-e)*h+(r-n)*a,(i-t)*h+(s-i)*a))},e._findPathProblems=function(t){var e=t.path,i=e&&e.length||0;if(i<6||(i-2)%4){var n="\tCannot parse 'path' array due to invalid number of entries in path. ";return n+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",n+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n",n+="Only [ "+i+" ] values found. Expected: "+Math.max(4*Math.ceil((i-2)/4)+2,6),n}for(var s=0;s<i;s++)if(isNaN(e[s]))return"All data in path array must be numeric";var r=t.start;if(isNaN(r)&&void 0!==r)return"'start' out of bounds. Expected 0 to 1, got: "+r;var a=t.end;if(isNaN(a)&&void 0!==a)return"'end' out of bounds. Expected 0 to 1, got: "+a;var o=t.orient;return o&&"fixed"!=o&&"auto"!=o&&"cw"!=o&&"ccw"!=o?'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+o:void 0},uf.MotionGuidePlugin=t}(),this.createjs=this.createjs||{},function(){var t=uf.TweenJS=uf.TweenJS||{};t.version="1.0.0",t.buildDate="Thu, 14 Sep 2017 19:47:47 GMT"}()};if("undefined"===typeof hf)var hf=i.g.window||{};const cf=hf.document||{},uf=hf.createjs=hf.createjs||{};lf.call(hf,hf,cf);var df=uf;const{LoadQueue:ff}=ef.A,{Text:pf,Bitmap:mf,Point:gf,BitmapCache:vf,Stage:_f,Shape:bf,Graphics:yf,Container:wf,Touch:Ef,Ticker:Cf,Event:Tf,EventDispatcher:xf,Rectangle:Sf}=of,{Tween:If,Ease:Lf}=df;delete Tf.prototype.clone;class Of extends mf{cacheId=null;loaded=!1;constructor(t=null){super(""),t&&"object"===typeof t&&(this.image=t)}get baseTexture(){return this.image}get originalWidth(){return this.image?this.image.width:0}get originalHeight(){return this.image?this.image.height:0}dispose(){this.image&&(this.image.src=""),this.image=null,this.loaded=!1,this.cacheId=null,this.cacheCanvas=null,this.bitmapCache=null}static addToCache(t,e){throw new TypeError("not implemented yet")}static removeFromCache(t){throw new TypeError("not implemented yet")}static from(t){throw new TypeError("not implemented yet")}static fromBuffer(t,e,i){throw new TypeError("not implemented yet")}static async fromLoader(t,e){if("object"!==typeof t)return null;const i=new Of(t);return i.loaded=!0,i.cacheId=e,t.canvasCache?(i.cacheCanvas=t.canvasCache,i.bitmapCache=new vf,i.bitmapCache.define(i,0,0,t.width,t.height)):(i.cache(0,0,t.width,t.height),t.canvasCache=i.cacheCanvas),i}static async fromURL(t,e){if("string"!==typeof t)return null;const i=await Af(t),n=new Of;return n.image=i,n.loaded=!0,n.cacheId=e,n}}window.URL||window.webkitURL;function Af(t,e=null){return new Promise(((i,n)=>{const s=e&&"object"===typeof e&&"HTMLImageElement"===e.constructor.name?e:document.createElement("img"),r=()=>{s.onerror=null,s.onabort=null,s.onload=null};if(s.onerror=e=>{r(),n(new Error("Can't load image \""+t+'"'))},s.onabort=e=>{r(),n(new Error('Request aborted "'+t+'"'))},s.onload=t=>{r(),s.dataset.complete=!0,i(s)},y(t)||(s.crossOrigin="anonymous"),s.src===t&&"true"===s.dataset.complete)return r(),i(s);s.src=t}))}function kf(t,e,i){t.setAttribute("width",e),t.setAttribute("height",i);const n=t.getContext("2d");return"function"===typeof n.reset&&n.reset(),n.clearRect(0,0,e,i),n}function Rf(t,e,i){if(!(t instanceof HTMLCanvasElement))throw new TypeError("Invalid canvas element");const n=kf(t,e.width,e.height);return n.drawImage(e,0,0),n.globalCompositeOperation="source-in",n.fillStyle=i||"#ffffff",n.fillRect(0,0,e.width,e.height),t}function Pf(t,e=256){const i=Df(t),n=e/Math.max(i.height,i.width);return t.map((t=>({x:(t.x-i.x)*n,y:(t.y-i.y)*n,width:t.width*n,height:t.height*n})))}function Df(t){let e=1/0,i=1/0,n=-1/0,s=-1/0;for(const r of t)e=Math.min(e,r.x),i=Math.min(i,r.y),n=Math.max(n,r.x+r.width),s=Math.max(s,r.y+r.height);return{x:e,y:i,width:n-e,height:s-i}}async function Mf(t,e="",i=128){const n=Qd.getMetadataOf(t);if("object"===typeof n.thumbnailData)return;const s=Object.seal({imagePath:null,imageElement:null,bounds:null,images:[]});for(const a of t.children){if(!a.image||"string"!==typeof a.image)continue;const t=Qd.getMetadataOf(a);if("object"===typeof n.thumbnailImage)continue;const i=Bf(a.image,e);t.thumbnailImage=Object.seal({imagePath:i,imageElement:null,blendMode:tf(a.blend_mode),fillColor:null,get activeColor(){return t.activeColor||null},get dirty(){return this.fillColor!==this.activeColor},get visible(){return a.visible},rect:Object.freeze({x:a.x,y:a.y,width:a.width,height:a.height})}),s.images.push(t.thumbnailImage)}const r=Pf(s.images.map((t=>t.rect)),i);s.bounds=Df(r);for(let a=0;a<s.images.length;a++){const t=s.images[a];t.rect=Object.freeze(r[a])}s.images=s.images.reverse(),n.thumbnailData=s}async function jf(t,e=null){const i=Qd.getMetadataOf(t);if("object"!==typeof i.thumbnailData)return null;const n=i.thumbnailData,s=n.bounds;if(!s||0===n.images.length)return null;if(n.imagePath&&!n.images.some((t=>t.dirty)))return n.imagePath;const r=e||document.createElement("canvas"),a=kf(r,s.width,s.height),o=document.createElement("canvas");for(const l of n.images){if(!l.visible)continue;let t=l.imageElement;t||(l.imageElement=await Af(l.imagePath),t=l.imageElement),l.activeColor&&(l.fillColor=l.activeColor,t=Rf(o,t,l.activeColor)),a.globalCompositeOperation=l.blendMode,a.drawImage(t,l.rect.x,l.rect.y,l.rect.width,l.rect.height)}return n.imagePath&&n.images.some((t=>t.dirty))?(n.imagePath=null,n.images.forEach((t=>{t.fillColor=null})),await jf(t,e)):(n.imagePath=Uf(r.toDataURL("image/png",.8)),n.imagePath)}const Bf=(t,e)=>Ff(t)?t:e+t,Ff=t=>t&&(t.startsWith("data:")||t.startsWith("blob:")),Uf=(t,e="image/png")=>{if(!t||!t.startsWith("data:"))return null;const i=atob(t.split(",")[1]),n=[];for(let r=0;r<i.length;r++)n.push(i.charCodeAt(r));const s=new Blob([new Uint8Array(n)],{type:e});return(window.URL||window.webkitURL).createObjectURL(s)},Nf={class:"list-item-loading-icon"},Xf={width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function Hf(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("span",Nf,[((0,s.uX)(),(0,s.CE)("svg",Xf,[(0,s.Lk)("circle",{style:(0,r.Tr)({fill:o.color}),class:"spinner_anim_1",cx:"12",cy:"12",r:"0"},null,4),(0,s.Lk)("circle",{style:(0,r.Tr)({fill:o.color}),class:"spinner_anim_1 spinner_anim_2",cx:"12",cy:"12",r:"0"},null,4)]))])}var Vf={name:"StampBadge",inject:["theme"],computed:{backgroundColor(){return"categories"===this.parentList?this.categoriesScrollBackgroundColor:this.itemsScrollBackgroundColor},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"},categoriesScrollBackgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.categoriesBg||"#f3f3f3"},itemsScrollBackgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.itemsBg||"#ffffff"}},props:{parentList:{type:String,default:"items"}}};const Gf=(0,H.A)(Vf,[["render",Hf],["__scopeId","data-v-3786755d"]]);var Yf=Gf,zf={name:"ImageLoad",components:{LoadingIcon:Yf},data(){return{thumbnailOrientation:"",forceLoading:!1,thumbnailUrl:"",watching:[]}},props:{item:{type:Object,required:!0},baseUrl:{type:String,required:!0},parentList:{type:String,required:!0,validator:t=>["items","categories"].includes(t)}},computed:{src(){return this.imageUrl||this.thumbnailUrl||""},loading(){return this.forceLoading||!this.src},imageUrl(){return this.item&&this.item.image?Bf(this.item.image,this.thumbnailBaseURL):""},itemId(){return this.item&&this.item.id},isDynamic(){return this.item&&this.item.isDynamic},thumbnailBaseURL(){return(this.baseUrl||"./")+"thumbnails/"}},watch:{src:{immediate:!0,handler:function(t,e){t&&t!==e&&!t.startsWith("blob:")&&(this.thumbnailOrientation="",this.showLoading())}},imageUrl:{immediate:!0,handler:function(t,e){t!==e&&this.setupItem()}},itemId:{immediate:!0,handler:function(t,e){t!==e&&this.setupItem()}}},mounted(){this.setupItem()},methods:{async setupItem(){this.thumbnailOrientation="",this.showLoading(),this.isDynamic&&(this.thumbnailUrl="",await this.renderDynamicThumbnail(),this.watchChanges())},async renderDynamicThumbnail(){const t=this.item.base(),e=this.itemId;await Mf(t,this.thumbnailBaseURL);const i=await jf(t);e===this.itemId&&(this.thumbnailUrl=i)},watchChanges(){this.watching.forEach((t=>t())),this.watching.length=0,this.watching.push(Qd.watch(this.item.base(),(()=>this.renderDynamicThumbnail())))},showLoading(){this.forceLoading=!0},hideLoading(){this.forceLoading=!1},handleImageError(t){this.$nextTick((()=>{this.hideLoading(),this.thumbnailOrientation="landscape"}))},handleImageLoad(t){const e=t.target;this.$nextTick((()=>{this.updateThumbnailOrientation(e)}))},updateThumbnailOrientation(t){if(!t||!t.naturalWidth||!t.naturalHeight)return;this.hideLoading();const e=t.naturalWidth/t.naturalHeight;this.thumbnailOrientation=e<1?"portrait":"landscape"}},beforeUnmount(){this.watching.forEach((t=>t())),this.watching.length=0}};const Wf=(0,H.A)(zf,[["render",pr],["__scopeId","data-v-69ffbce0"]]);var $f=Wf;const qf=t=>((0,s.Qi)("data-v-6a9ae750"),t=t(),(0,s.jt)(),t),Qf=qf((()=>(0,s.Lk)("g",null,[(0,s.Lk)("path",{d:"M87.748,388.784c0.461,11.01,9.521,19.699,20.539,19.699h191.911c11.018,0,20.078-8.689,20.539-19.699l13.705-289.316\n          H74.043L87.748,388.784z M247.655,171.329c0-4.61,3.738-8.349,8.35-8.349h13.355c4.609,0,8.35,3.738,8.35,8.349v165.293\n          c0,4.611-3.738,8.349-8.35,8.349h-13.355c-4.61,0-8.35-3.736-8.35-8.349V171.329z M189.216,171.329\n          c0-4.61,3.738-8.349,8.349-8.349h13.355c4.609,0,8.349,3.738,8.349,8.349v165.293c0,4.611-3.737,8.349-8.349,8.349h-13.355\n          c-4.61,0-8.349-3.736-8.349-8.349V171.329L189.216,171.329z M130.775,171.329c0-4.61,3.738-8.349,8.349-8.349h13.356\n          c4.61,0,8.349,3.738,8.349,8.349v165.293c0,4.611-3.738,8.349-8.349,8.349h-13.356c-4.61,0-8.349-3.736-8.349-8.349V171.329z"}),(0,s.Lk)("path",{d:"M343.567,21.043h-88.535V4.305c0-2.377-1.927-4.305-4.305-4.305h-92.971c-2.377,0-4.304,1.928-4.304,4.305v16.737H64.916\n          c-7.125,0-12.9,5.776-12.9,12.901V74.47h304.451V33.944C356.467,26.819,350.692,21.043,343.567,21.043z"})],-1))),Jf=[Qf];function Kf(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("button",{class:"btn-default remove-items-button",style:(0,r.Tr)({backgroundColor:o.backgroundColor,color:o.color})},[((0,s.uX)(),(0,s.CE)("svg",{class:"svg-icon",style:(0,r.Tr)({fill:o.color}),viewBox:"0 0 408.483 408.483",xmlns:"http://www.w3.org/2000/svg"},Jf,4))],4)}var Zf={name:"RemoveItemsButton",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnRemoveItems||"#f69bc5"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const tp=(0,H.A)(Zf,[["render",Kf],["__scopeId","data-v-6a9ae750"]]);var ep=tp;const ip=t=>((0,s.Qi)("data-v-05edee66"),t=t(),(0,s.jt)(),t),np={class:"badge-default scroll-list-stamp-item"},sp={class:"svg-icon",xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",preserveAspectRatio:"none",x:"0px",y:"0px",height:"410px",viewBox:"175 80 450 450"},rp={transform:"matrix( 1, 0, 0, 1, 0,0) "},ap=ip((()=>(0,s.Lk)("path",{fill:"#FFFFFF","fill-opacity":"0.9",stroke:"none",d:"\n        M 528.15 157.25\n        L 528.15 157.2\n        Q 508.8001953125 109.1783203125 485.7 103.6 460.0771484375 89.19609375 423.3 117.55 408.6943359375 127.758203125 400.5 144.9 392.305859375 127.7583984375 377.65 117.55 340.92265625 89.19609375 315.3 103.6 292.1998046875 109.1783203125 272.8 157.2\n        L 272.8 157.25\n        Q 263.3693359375 180.7224609375 262.1 199.65 252.8814453125 196.9533203125 243.9 199.7 220.0025390625 200.8796875 200.6 228.35\n        L 200.6 228.3\n        Q 186.1041015625 248.3263671875 182.15 276.9 177.7408203125 308.5408203125 195.4 336\n        L 195.45 336.1\n        Q 210.7138671875 360.1861328125 240.05 376.2\n        L 240.1 376.25\n        Q 249.4578125 381.3517578125 258.1 383.2 248.43984375 407.00390625 257.15 434.95\n        L 257.15 434.95\n        Q 266.0703125 463.3734375 279.45 480\n        L 279.5 480.05\n        Q 299.132421875 507.04375 337.2 501.7\n        L 337.25 501.7\n        Q 362.259765625 498.1439453125 374.1 488.5 384.273046875 490.9607421875 399.95 491.25 400.5 491.261328125 401.05 491.25 416.7271484375 490.9607421875 426.9 488.5 438.740234375 498.1439453125 463.7 501.7\n        L 463.75 501.7\n        Q 501.867578125 507.04375 521.5 480.05\n        L 521.55 480\n        Q 534.9294921875 463.3734375 543.8 434.95\n        L 543.8 434.95\n        Q 552.56015625 407.00390625 542.9 383.2 551.542578125 381.3515625 560.9 376.25\n        L 560.9 376.2\n        Q 590.2859375 360.1861328125 605.5 336.1\n        L 605.6 336\n        Q 623.259375 308.5408203125 618.8 276.9 614.895703125 248.3263671875 600.35 228.3\n        L 600.4 228.35\n        Q 580.997265625 200.8796875 557.05 199.7 548.1189453125 196.9533203125 538.9 199.65 537.6306640625 180.7224609375 528.15 157.25\n        M 326.55 131.4\n        Q 339.65 126.1 359.35 141.3 379.1 156.55 380.75 192.15 382.5 227.7 379.05 246.95 375.65 266.2 349.95 272.85 324.25 279.45 312.85 259.85 301.5 240.2 294.7 220.15 287.9 200.1 300.65 168.45 313.45 136.7 326.55 131.4\n        M 441.65 141.3\n        Q 461.35 126.1 474.45 131.4 487.55 136.7 500.35 168.45 513.1 200.1 506.3 220.15 499.5 240.2 488.15 259.85 476.75 279.45 451.05 272.85 425.35 266.2 421.95 246.95 418.5 227.7 420.25 192.15 421.9 156.55 441.65 141.3\n        M 398.2 301.05\n        Q 398.3 301.05 400.5 300.9 402.7 301.05 402.8 301.05 422.7 302.45 434 313.75 445.3 325 451.9 342.95 455.55 363.25 468.5 362.3 476.5 362.7 487.35 365.05 498.15 367.4 510.2 385.5 522.2 403.6 515.2 426 508.2 448.35 497.9 461.55 487.55 474.75 467.95 472 448.3 469.2 444.05 460.95 439.7 452.65 435.85 453.45 431.95 454.2 424.5 457.6 417.05 460.95 400.5 461.25 383.95 460.95 376.5 457.6 369.05 454.2 365.15 453.45 361.3 452.65 356.95 460.95 352.7 469.2 333.05 472 313.45 474.75 303.1 461.55 292.8 448.35 285.8 426 278.8 403.6 290.8 385.5 302.85 367.4 313.65 365.05 324.5 362.7 332.5 362.3 345.45 363.25 349.1 342.95 355.7 325 367 313.75 378.3 302.45 398.2 301.05\n        M 575.9 245.65\n        Q 586.25 260.25 589.1 281 591.95 301.75 580.35 319.8 568.7 337.8 546.55 349.9 524.35 362 511.75 334.6 499.15 307.15 505 288.65 510.8 270.15 526.05 249.1 541.25 228 553.4 229.5 565.55 231 575.9 245.65\n        M 247.6 229.5\n        Q 259.75 228 274.95 249.1 290.2 270.15 296 288.65 301.85 307.15 289.25 334.6 276.65 362 254.45 349.9 232.3 337.8 220.65 319.8 209.05 301.75 211.9 281 214.75 260.25 225.1 245.65 235.45 231 247.6 229.5 Z"},null,-1)));function op(t,e,i,n,a,o){return(0,s.uX)(),(0,s.CE)("span",np,[((0,s.uX)(),(0,s.CE)("svg",sp,[(0,s.Lk)("g",rp,[ap,(0,s.Lk)("path",{style:(0,r.Tr)({fill:o.backgroundColor}),stroke:"none",d:"\n        M 274.95 249.1\n        Q 259.75 228 247.6 229.5 235.45 231 225.1 245.65 214.75 260.25 211.9 281 209.05 301.75 220.65 319.8 232.3 337.8 254.45 349.9 276.65 362 289.25 334.6 301.85 307.15 296 288.65 290.2 270.15 274.95 249.1\n        M 589.1 281\n        Q 586.25 260.25 575.9 245.65 565.55 231 553.4 229.5 541.25 228 526.05 249.1 510.8 270.15 505 288.65 499.15 307.15 511.75 334.6 524.35 362 546.55 349.9 568.7 337.8 580.35 319.8 591.95 301.75 589.1 281\n        M 400.5 300.9\n        Q 398.3 301.05 398.2 301.05 378.3 302.45 367 313.75 355.7 325 349.1 342.95 345.45 363.25 332.5 362.3 324.5 362.7 313.65 365.05 302.85 367.4 290.8 385.5 278.8 403.6 285.8 426 292.8 448.35 303.1 461.55 313.45 474.75 333.05 472 352.7 469.2 356.95 460.95 361.3 452.65 365.15 453.45 369.05 454.2 376.5 457.6 383.95 460.95 400.5 461.25 417.05 460.95 424.5 457.6 431.95 454.2 435.85 453.45 439.7 452.65 444.05 460.95 448.3 469.2 467.95 472 487.55 474.75 497.9 461.55 508.2 448.35 515.2 426 522.2 403.6 510.2 385.5 498.15 367.4 487.35 365.05 476.5 362.7 468.5 362.3 455.55 363.25 451.9 342.95 445.3 325 434 313.75 422.7 302.45 402.8 301.05 402.7 301.05 400.5 300.9\n        M 474.45 131.4\n        Q 461.35 126.1 441.65 141.3 421.9 156.55 420.25 192.15 418.5 227.7 421.95 246.95 425.35 266.2 451.05 272.85 476.75 279.45 488.15 259.85 499.5 240.2 506.3 220.15 513.1 200.1 500.35 168.45 487.55 136.7 474.45 131.4\n        M 359.35 141.3\n        Q 339.65 126.1 326.55 131.4 313.45 136.7 300.65 168.45 287.9 200.1 294.7 220.15 301.5 240.2 312.85 259.85 324.25 279.45 349.95 272.85 375.65 266.2 379.05 246.95 382.5 227.7 380.75 192.15 379.1 156.55 359.35 141.3 Z"},null,4)])]))])}var lp={name:"StampBadge",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnListItemBadge||"#c7bbbe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const hp=(0,H.A)(lp,[["render",op],["__scopeId","data-v-05edee66"]]);var cp=hp;const up=t=>((0,s.Qi)("data-v-781d0524"),t=t(),(0,s.jt)(),t),dp={class:"badge-default color-picker-stamp-item"},fp={class:"svg-icon",xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",preserveAspectRatio:"none",x:"0px",y:"0px",width:"140px",height:"140px",viewBox:"0 0 140 140"},pp={id:"Layer0_0_FILL"},mp=["fill"],gp=up((()=>(0,s.Lk)("path",{id:"Layer0_0_1_STROKES",stroke:"#ffffff","stroke-width":"13.45","stroke-linejoin":"round","stroke-linecap":"round",fill:"none",d:"M 70 14.7 L 99.8 51.65 Q 100.05 51.9 100.3 52.1 112.85 64.7 112.85 82.5 112.85 100.25 100.3 112.8 98.15 114.95 95.9 116.7 84.7 125.3 70 125.3 55.3 125.3 44.1 116.7 41.8 114.95 39.65 112.8 27.15 100.25 27.15 82.5 27.15 64.7 39.65 52.1 40.1 51.7 40.6 51.3 L 70 14.7 Z"},null,-1))),vp=up((()=>(0,s.Lk)("g",{transform:"matrix( 1, 0, 0, 1, 0,0) "},[(0,s.Lk)("use",{"xlink:href":"#Layer0_0_FILL"}),(0,s.Lk)("use",{"xlink:href":"#Layer0_0_1_STROKES"})],-1)));function _p(t,e,i,n,r,a){return(0,s.uX)(),(0,s.CE)("span",dp,[((0,s.uX)(),(0,s.CE)("svg",fp,[(0,s.Lk)("defs",null,[(0,s.Lk)("g",pp,[(0,s.Lk)("path",{fill:a.backgroundColor,stroke:"none",d:"M 112.85 82.5 Q 112.85 64.7 100.3 52.1 100.05 51.9 99.8 51.65 L 70 14.7 40.6 51.3 Q 40.1 51.7 39.65 52.1 27.15 64.7 27.15 82.5 27.15 100.25 39.65 112.8 41.8 114.95 44.1 116.7 55.3 125.3 70 125.3 84.7 125.3 95.9 116.7 98.15 114.95 100.3 112.8 112.85 100.25 112.85 82.5 Z"},null,8,mp)]),gp]),vp]))])}var bp={name:"ColorPickerBadge",inject:["theme"],computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnListItemBadge||"#c7bbbe"},color(){return ut.isDark(this.backgroundColor)?"#f2f3f4":"#31393C"}}};const yp=(0,H.A)(bp,[["render",_p],["__scopeId","data-v-781d0524"]]);var wp=yp,Ep={name:"ListItemButton",components:{ThumbnailImageLoad:$f,StampBadge:cp,ColorPickerBadge:wp,RemoveItemsButton:ep},computed:{isVisible(){return this.item&&this.item.visible&&this.updateSignal>=0}},props:{parentList:{type:String,required:!0,validator:t=>["items","categories"].includes(t)},baseUrl:{type:String,required:!0},item:{type:Object,required:!0},updateSignal:{type:Number,default:0}}};const Cp=(0,H.A)(Ep,[["render",ur]]);var Tp=Cp;const xp={class:"display"},Sp=["width","height"],Ip=["width","height"];function Lp(t,e,i,n,r,a){return(0,s.uX)(),(0,s.CE)("div",xp,[(0,s.Lk)("canvas",{class:"size-slot",width:i.canvasWidth+"px",height:i.canvasHeight+"px"},null,8,Sp),(0,s.Lk)("canvas",{id:"game",ref:"display",width:i.canvasWidth+"px",height:i.canvasHeight+"px"},null,8,Ip)])}var Op={name:"GameCanvas",props:{canvasWidth:{type:Number,default:0},canvasHeight:{type:Number,default:0}},methods:{getCanvas(){return this.$refs.display}}};const Ap=(0,H.A)(Op,[["render",Lp],["__scopeId","data-v-dea2e4f0"]]);var kp=Ap;const Rp=t=>((0,s.Qi)("data-v-62996741"),t=t(),(0,s.jt)(),t),Pp={class:"w-creen"},Dp={class:"floating-box"},Mp={class:"content"},jp={class:"name"},Bp={key:0,class:"owner"},Fp=["href"],Up={class:"description can-select"},Np={key:0,class:"tags"},Xp=Rp((()=>(0,s.Lk)("svg",{height:"24px",width:"24px",version:"1.1",viewBox:"0 0 32 32"},[(0,s.Lk)("g",{"fill-rule":"evenodd",stroke:"none"},[(0,s.Lk)("g",{stroke:"none"},[(0,s.Lk)("path",{d:"M12,4 L3.99961498,4 C2.89525812,4 2,4.88743329 2,5.99961498 L2,14 L15.3809027,27.3809027 C16.1646418,28.1646418 17.433119,28.1668566 18.2115341,27.3884415 L25.3884415,20.2115341 C26.168017,19.4319586 26.1640508,18.1640508 25.3809027,17.3809027 L12,4 L12,4 Z M7.5,11 C8.32842717,11 9,10.3284272 9,9.5 C9,8.67157283 8.32842717,8 7.5,8 C6.67157283,8 6,8.67157283 6,9.5 C6,10.3284272 6.67157283,11 7.5,11 L7.5,11 Z"})])])],-1))),Hp=["href"],Vp={class:"floating-icon-wrapper"},Gp=["src","alt"],Yp={key:1,class:"floating-button-wrapper"};function zp(t,e,i,n,a,o){const l=(0,s.g2)("PoweredBy"),h=(0,s.g2)("ToggleButton");return(0,s.uX)(),(0,s.CE)("div",Pp,[o.resolveHomeHref()?((0,s.uX)(),(0,s.Wv)(l,{key:0,href:o.resolveHomeHref(),by:"meiker.io",premiumHref:i.poweredByPremiumHref,premiumLabel:i.poweredByPremiumLabel,presentationMode:i.presentationMode},null,8,["href","premiumHref","premiumLabel","presentationMode"])):(0,s.Q3)("",!0),(0,s.Lk)("div",Dp,[(0,s.Lk)("div",Mp,[(0,s.Lk)("h2",jp,(0,r.v_)(i.data.name),1),i.data.owner?((0,s.uX)(),(0,s.CE)("p",Bp,[(0,s.eW)("by "),(0,s.Lk)("a",{href:o.ownerHref,target:"_blank"},(0,r.v_)(i.data.owner.nickname),9,Fp)])):(0,s.Q3)("",!0),(0,s.Lk)("div",Up,[i.data.tags&&i.data.tags.length>0?((0,s.uX)(),(0,s.CE)("div",Np,[Xp,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.data.tags||[],((t,e)=>((0,s.uX)(),(0,s.CE)("a",{key:e,href:o.resolveTagHref(t),class:"tag",target:"_blank"},(0,r.v_)(t),9,Hp)))),128))])):(0,s.Q3)("",!0),(0,s.Lk)("p",null,(0,r.v_)(i.data.description||"No description"),1)])])]),(0,s.Lk)("div",Vp,[(0,s.Lk)("img",{class:"float-game-icon",src:i.data.icon,alt:i.data.name},null,8,Gp)]),i.showPlayButton?((0,s.uX)(),(0,s.CE)("div",Yp,[(0,s.Lk)("a",{onClick:e[0]||(e[0]=(...t)=>o.onClickPlay&&o.onClickPlay(...t)),class:(0,r.C4)(["splash-button","noselect",i.showPlayButton?"":"hidden"])}," Play ",2),(0,s.Lk)("a",{class:(0,r.C4)(["button","noselect",i.showPlayButton?"":"hidden"]),style:{display:"none"},ref:"fakeButton"}," Play ",2)])):(0,s.Q3)("",!0),i.enableFullscreenButton?((0,s.uX)(),(0,s.Wv)(h,{key:2,class:"floating-fullscreen-toggle",value:i.fullScreenOnPlay,label:"Fullscreen on play",onChange:e[1]||(e[1]=e=>t.$emit("fullscreen-toggle",e))},null,8,["value"])):(0,s.Q3)("",!0)])}const Wp=t=>((0,s.Qi)("data-v-1e8c5a3a"),t=t(),(0,s.jt)(),t),$p={class:"switch"},qp=["disabled","checked"],Qp=Wp((()=>(0,s.Lk)("span",{class:"slider round"},null,-1)));function Jp(t,e,i,a,o,l){return(0,s.uX)(),(0,s.CE)("div",{class:"btn-toggle",style:{display:"flex"},onClick:e[1]||(e[1]=(0,n.D$)((()=>{l.changeValue(!o.currentValue)}),["stop","prevent"]))},[i.showLabel?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"text-label noselect",style:(0,r.Tr)({color:l.color})},(0,r.v_)(i.label),5)):(0,s.Q3)("",!0),(0,s.Lk)("label",$p,[(0,s.Lk)("input",{type:"checkbox",disabled:i.disabled,checked:o.currentValue,onChange:e[0]||(e[0]=(...t)=>l.change&&l.change(...t))},null,40,qp),Qp])])}var Kp={name:"ToggleButton",inject:["theme"],data(){return{currentValue:this.value}},methods:{change(t){this.changeValue(t.target.checked)},changeValue(t){if(this.disabled)return!1;this.currentValue=t,this.$emit("change",t)},updateModel(){this.currentValue=this.value}},mounted(){this.updateModel()},watch:{value(t){this.updateModel()}},computed:{backgroundColor(){return this.theme&&this.theme.colors&&this.theme.colors.btnToggle||"#4A4A70"},mainBgColor(){return this.theme&&this.theme.colors&&this.theme.colors.mainBg||"#bebebe"},color(){return ut.isDark(this.mainBgColor)?"#f2f3f4":"#31393C"}},props:{showLabel:{type:Boolean,default:!0},label:{type:String,default:""},value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}}};const Zp=(0,H.A)(Kp,[["render",Jp],["__scopeId","data-v-1e8c5a3a"]]);var tm=Zp;const em={splashTimeout:5e3};var im={name:"WelcomeScreen",components:{PoweredBy:Ft,ToggleButton:tm},computed:{ownerHref(){return this.presentationMode?"javascript:;":this.resolveOwnerHref(this.data.owner.id)}},props:{showPlayButton:{type:Boolean,default:!1},fullScreenOnPlay:{type:Boolean,default:!1},enableFullscreenButton:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},poweredByPremiumHref:{type:String},poweredByPremiumLabel:{type:String},presentationMode:{type:Boolean,default:!1}},methods:{onClickPlay(){this.$emit("click-play");const t=this.$refs.fakeButton,e=em.splashTimeout;setTimeout((()=>{t.click()}),e)},resolveOwnerHref(t){return this.data&&this.data.resolvers&&"function"===typeof this.data.resolvers.ownerLinkResolver?this.data.resolvers.ownerLinkResolver(t,"preloader"):"javascript:;"},resolveTagHref(t){return this.presentationMode?"javascript:;":this.data&&this.data.resolvers&&"function"===typeof this.data.resolvers.tagLinkResolver?this.data.resolvers.tagLinkResolver(t,"preloader"):"javascript:;"},resolveHomeHref(){return this.data&&this.data.resolvers&&"function"===typeof this.data.resolvers.siteHomeLink?this.data.resolvers.siteHomeLink("preloader"):""}}};const nm=(0,H.A)(im,[["render",zp],["__scopeId","data-v-62996741"]]);var sm=nm;const rm={class:"wrapper",ref:"wrapper"},am={class:"center-square",ref:"animationBox"},om={key:0,class:"center-text animation-target visible",ref:"draw"},lm={key:1,class:"center-text animation-target visible",ref:"share"},hm={key:2,class:"center-text animation-target visible",ref:"play"},cm=["href"],um={class:"logo",ref:"logo"},dm={class:"slogan",ref:"slogan"},fm={id:"text1",ref:"text1"},pm=["href"];function mm(t,e,i,r,a,o){return(0,s.uX)(),(0,s.CE)("div",{class:"splash-screen",onClick:e[0]||(e[0]=(0,n.D$)(((...t)=>o.animateLogo&&o.animateLogo(...t)),["stop","prevent"]))},[(0,s.Lk)("div",rm,null,512),(0,s.Lk)("div",am,[a.drawVisible?((0,s.uX)(),(0,s.CE)("div",om,"Draw",512)):(0,s.Q3)("",!0),a.shareVisible?((0,s.uX)(),(0,s.CE)("div",lm,"Share",512)):(0,s.Q3)("",!0),a.playVisible?((0,s.uX)(),(0,s.CE)("div",hm,"Play",512)):(0,s.Q3)("",!0)],512),(0,s.Lk)("a",{class:"center-box",href:o.meikerHref,target:"_blank"},[(0,s.Lk)("div",um,null,512),(0,s.Lk)("div",dm,[(0,s.Lk)("div",fm,"Made in",512),(0,s.Lk)("a",{id:"text2",ref:"text2",href:o.meikerHref}," Meiker ",8,pm)],512)],8,cm)])}const gm=550;var vm={data(){return{canClick:!1,drawVisible:!1,shareVisible:!1,playVisible:!1}},computed:{meikerHref(){return this.presentationMode?null:"https://meiker.io/?utm_source=player&utm_medium=splash-screen&utm_campaign=in-game-splash-screen"}},props:{presentationMode:{type:Boolean,required:!0}},mounted(){setTimeout((()=>{this.prepareAnimation()}),0);const t=em.splashTimeout;setTimeout((()=>{this.$emit("finish")}),t)},methods:{async init(){const t=this.$refs.text1,e=this.$refs.text2;this.canClick=!1,e.classList.remove("visible"),t.classList.remove("animation-target"),await this.animateFrame(),t.classList.add("animation-target"),await this.animateFrame(),e.classList.add("visible"),e.classList.remove("animation-target"),await this.animateFrame(),e.classList.add("animation-target"),await this.animateFrame(),this.canClick=!0},animateFrame(){return window.requestAnimationFrame?new Promise((t=>{requestAnimationFrame(t)})):new Promise((t=>setTimeout(t,0)))},prepareAnimation(){setTimeout((()=>{this.startAnimation()}),200)},async startAnimation(){this.showDraw()},showDraw(){this.drawVisible=!0,this.$nextTick((()=>{const t=this.$refs.draw;setTimeout((()=>{t.addEventListener("transitionend",(()=>{this.showShare()})),t.classList.remove("visible")}),gm)}))},showShare(){this.shareVisible=!0,this.$nextTick((()=>{const t=this.$refs.share;setTimeout((()=>{t.addEventListener("transitionend",(()=>{this.showPlay()})),t.classList.remove("visible")}),gm)}))},showPlay(){this.playVisible=!0,this.$nextTick((()=>{const t=this.$refs.play;setTimeout((()=>{t.addEventListener("transitionend",(()=>{this.showLogo()})),t.classList.remove("visible")}),gm)}))},showLogo(){const t=this.$refs.logo;t.classList.add("visible"),this.showWrapper()},async showSlogan(){const t=this.$refs.slogan;await this.init(),t.classList.add("visible")},showWrapper(){const t=this.$refs.wrapper;t.classList.add("expanded"),t.addEventListener("transitionend",(()=>{this.showSlogan()}))},async animateLogo(){this.canClick&&await this.init()}}};const _m=(0,H.A)(vm,[["render",mm],["__scopeId","data-v-7e8761a5"]]);var bm=_m;i(8260),i(3910),i(6085);const ym=ef.A.LoadQueue,wm=of.Bitmap,Em=(of.Point,of.BitmapCache),Cm=(of.Stage,of.Shape,of.Container),Tm=(of.Touch,of.Ticker),xm=df.Tween,Sm=df.Ease,Im=t=>{if("object"!==typeof t)return null;const e=new wm("");return e.image=t,e.mouseEnabled=!1,e.tickEnabled=!1,t.canvasCache?(e.cacheCanvas=t.canvasCache,e.bitmapCache=new Em,e.bitmapCache.define(e,0,0,t.width,t.height)):(e.cache(0,0,t.width,t.height),t.canvasCache=e.cacheCanvas),e},Lm=t=>{if("string"!==typeof t)return null;let e=new wm("");e.mouseEnabled=!1,e.tickEnabled=!1;const i=new Image;return i.onload=t=>{e.image=i,e.cache(0,0,i.width,i.height),e.dispatchEvent("cached")},i.crossOrigin="anonymous",i.src=t,e},Om={};class Am{static register(t,e){return Om[t]=e,this}static dispatch(t,e=[]){let i=null;return"function"===typeof Om[t]&&(i=Om[t].apply(null,e||[])),i instanceof Promise?i:Promise.resolve(i)}}const km={mm:void 0};"function"!==typeof window.mmload&&(window.mmload=function(t){t.mm=this},window.mmload=window.mmload.bind(Am)),window.mmload(km);var Rm=km.mm;
/*!
* EaselJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/
const Pm={};(function(){function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},Pm.Event=t})(),function(){function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var s=n[t];return s&&this.removeEventListener(t,e,i),s=n[t],s?s.push(e):n[t]=[e],e},e.on=function(t,e,i,n,s,r){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,(function(t){e.call(i,t,s),n&&t.remove()}),r)},e.removeEventListener=function(t,e,i){var n=i?this._captureListeners:this._listeners;if(n){var s=n[t];if(s)for(var r=0,a=s.length;r<a;r++)if(s[r]===e){1===a?delete n[t]:s.splice(r,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t,e,i){if("string"===typeof t){var n=this._listeners;if(!e&&(!n||!n[t]))return!0;t=new Pm.Event(t,e,i)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(l){}if(t.bubbles&&this.parent){var s,r=this,a=[r];while(r.parent)a.push(r=r.parent);var o=a.length;for(s=o-1;s>=0&&!t.propagationStopped;s--)a[s]._dispatchEvent(t,1+(0===s));for(s=1;s<o&&!t.propagationStopped;s++)a[s]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return!t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){var e=this;while(e){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,n,s=e<=2?this._captureListeners:this._listeners;if(t&&s&&(n=s[t.type])&&(i=n.length)){try{t.currentTarget=this}catch(o){}try{t.eventPhase=0|e}catch(o){}t.removed=!1,n=n.slice();for(var r=0;r<i&&!t.immediatePropagationStopped;r++){var a=n[r];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1===e),t.removed=!1)}}2===e&&this._dispatchEvent(t,2.1)},Pm.EventDispatcher=t}();const Dm=Pm.Event,Mm=Pm.EventDispatcher;class jm{constructor(t="",e=10){this.files={},this.baseURL=t,this._onDemandMode=!0,this._queueItems=[],this._downloading=!1,this._loadedFiles=0,this._totalFiles=0,this._queues=[];for(let i=0;i<e;i++){const t=new ym(!0);t.id=i,t.on("fileload",this._handleFileLoad,this),t.on("fileerror",this._handleFileError,this),t.on("complete",this._handleComplete,this),0===i&&t.on("progress",this._handleProgress,this),this._queues.push(t)}this._events=new Mm}_handleProgress(t){this._downloading&&(t.loaded=this._loadedFiles/this._totalFiles,t.progress=t.loaded,this._events.dispatchEvent(t))}_handleFileLoad(t){if(this._loadedFiles++,this.files[t.item.id])return;/^blob:/.test(t.item.id)?this.files[t.item.id]=t.item.id:this.files[t.item.id]=t.result;let e=this._queueItems.findIndex((e=>e.id===t.item.id));-1!==e&&(this._queueItems[e].listeners.forEach((e=>{const i={id:t.item.id,result:this.getItem(t.item.id)};i.result.bitmapCache?e.resolve(i):i.result.on("cached",(()=>{e.resolve(i)}))})),this._queueItems.splice(e,1)),this._events.dispatchEvent(this._eventFactory("fileload",{id:t.item.id}))}_handleFileError(t){if(this._loadedFiles++,this.files[t.item.id])return!1;this.files[t.item.id]=null;let e=this._queueItems.findIndex((e=>e.id===t.item.id));-1!==e&&(this._queueItems[e].listeners.forEach((e=>e.reject(new Error(t.item.id)))),this._queueItems.splice(e,1))}_eventFactory(t,e){let i=new Dm(t);return i.loadedCount=this._loadedFiles,i.total=this._totalFiles,e.id&&(i.fileId=e.id),i.result=e.result,i}_handleComplete(t){if(this._downloading)return 0===this._queueItems.length?(this._downloading=!1,this._loadedFiles=0,this._totalFiles=0,void this._events.dispatchEvent(this._eventFactory("complete",{}))):void this._queues.forEach((t=>{t._numItems===t._numItemsLoaded&&this._loadQueueItems(t)}))}_loadQueueItems(t){t.removeAll();const e=this._queueItems.filter((e=>e.queueId===t.id));0!==e.length&&t.loadManifest(e)}setBaseUrl(t){this.baseURL=t}setOnDemandMode(t){this._onDemandMode=t}isOnDemandMode(){return this._onDemandMode}addEventListener(t,e){this._events.on(t,e)}on(t,e){this._events.on(t,e)}addToQueue(t){return t?new Promise(((e,i)=>{let n=this._queueItems.find((e=>e.id===t)),s=t;!/^blob:/.test(s)&&this.baseURL&&(s=`${this.baseURL}${t}`),n||(n={id:t,src:s,crossOrigin:"Anonymous",listeners:[],queueId:this._queueItems.length%this._queues.length},this._queueItems.push(n)),n.listeners.push({resolve:e,reject:i})})):Promise.reject(new Error("Src is empty or exist"))}hasItem(t){return!(!t||!this.files[t])}getItem(t){return this.hasItem(t)?/^blob:/.test(t)?Lm(this.files[t]):Im(this.files[t]):null}releaseItem(t){return!!this.hasItem(t)&&(this.files[t]=null,delete this.files[t],!0)}loadItems(){if(!this._downloading){if(this._downloading=!0,this._queueItems.length>0)return this._loadedFiles=0,this._totalFiles=this._queueItems.length,this._queues.forEach((t=>this._loadQueueItems(t))),void this._events.dispatchEvent(this._eventFactory("start",{}));setTimeout((()=>this._handleComplete(null)),0)}}cleanOut(){this._queues.forEach((t=>t.removeAll())),this._events.removeAllEventListeners(),this.files={},this._queueItems=[],this._downloading=!1,this._loadedFiles=0,this._totalFiles=0}}const Bm=new jm;var Fm=Bm;Math.PI,Object.freeze({PINCH_START:"stagepinchstart",PINCH_MOVE:"stagepinchmove",PINCH_END:"stagepinchend"});class Um{constructor(t){this.offsetY=0,this.offsetX=0,this.offsetStep=1,this._maxOffsetY=parseInt(t.up||0),this._minOffsetY=-parseInt(t.down||0),this._maxOffsetX=parseInt(t.right||0),this._minOffsetX=-parseInt(t.left||0)}transform({action:t,offset:e},i){switch(t){case"up":this._moveUp(i);break;case"down":this._moveDown(i);break;case"left":this._moveLeft(i);break;case"right":this._moveRight(i);break;case"default":this._moveDefault(i);break;case"exact":this._moveExact(e,i);break}}clone(){return new Um({up:this._maxOffsetY,down:-this._minOffsetY,right:this._maxOffsetX,left:-this._minOffsetX})}random(){return{y:parseInt(Math.random()*(this._maxOffsetY-this._minOffsetY)+this._minOffsetY),x:parseInt(Math.random()*(this._maxOffsetX-this._minOffsetX)+this._minOffsetX)}}_moveExact(t,e){this._moveDefault(e),this.offsetY=parseInt(t.y),this.offsetX=parseInt(t.x),e.y+=this.offsetY,e.x+=this.offsetX}_moveUp(t){this._minOffsetY!==this.offsetY&&(this.offsetY-=this.offsetStep,t.y-=this.offsetStep)}_moveDown(t){this._maxOffsetY!==this.offsetY&&(this.offsetY+=this.offsetStep,t.y+=this.offsetStep)}_moveRight(t){this._maxOffsetX!==this.offsetX&&(this.offsetX+=this.offsetStep,t.x+=this.offsetStep)}_moveLeft(t){this._minOffsetX!==this.offsetX&&(this.offsetX-=this.offsetStep,t.x-=this.offsetStep)}_moveDefault(t){t.x-=this.offsetX,t.y-=this.offsetY,this.offsetX=0,this.offsetY=0}}var Nm=Um;class Xm{constructor(){this._pendingCalls=[],this._onFlushOnceListeners=[]}once(t,e){"function"===typeof e&&"flush"===t&&this._onFlushOnceListeners.push(e)}reset(){this._pendingCalls=[],this._onFlushOnceListeners=[]}push(t){return"function"===typeof t?this.pushCallback(t):"object"===typeof t?this.pushPromise(t):void 0}pushCallback(t){"function"===typeof t&&this._pendingCalls.push(t)}pushPromise({resolve:t,reject:e}){"function"===typeof t&&"function"===typeof e&&this._pendingCalls.push({resolve:t,reject:e})}flushCalls(){this._pendingCalls.forEach((t=>{"function"===typeof t&&t()})),this.__flushListeners()}clearCalls(){this._pendingCalls=[],this.__flushListeners()}resolveAll(t=null){this._pendingCalls.forEach((e=>{"object"===typeof e&&"function"===typeof e.resolve&&e.resolve(t)})),this.__flushListeners()}rejectAll(t){this._pendingCalls.forEach((e=>{"object"===typeof e&&"function"===typeof e.resolve&&e.reject(t)})),this.__flushListeners()}__flushListeners(){this._onFlushOnceListeners.forEach((t=>{"function"===typeof t&&t()})),this.reset()}}var Hm=Xm;const Vm=(t,e,i,n)=>{i[e]=i[t],i[t]=function(){this[e](...arguments);let i=[...arguments];Ym.slaveCall(n,(e=>{e[t](...i)}))}};class Gm{constructor(){this.masterRefs=[],this.masterObjects={},this.slaveObjects={},this.pendingCalls=new Hm}onFlushOnce(t){return this.pendingCalls.once("flush",t)}reset(){this.masterRefs=[],this.masterObjects={},this.slaveObjects={},this.pendingCalls.reset()}addMaster(t,e){-1===this.masterRefs.indexOf(t)&&this.masterRefs.push(t),Vm("setVisible","___setVisible",e,t),Vm("setProps","___setProps",e,t),Vm("transform","___transform",e,t),this.masterObjects[t]=e}addSlave(t,e){return new Promise(((i,n)=>{this.pendingCalls.push((()=>{if(-1===this.masterRefs.indexOf(t)||"object"!==typeof e)return n(new Error("Invalid master ref or slaveObject"));this.slaveObjects[t]||(this.slaveObjects[t]=[]);let s=this.masterObjects[t];if(s._transformations&&(e._transformations=s._transformations.clone()),s.category&&e.category&&e.category.scope&&e.category.scope===s.category.scope)return n(new Error("This layer was linked with master layer under the same color global scope"));this.slaveObjects[t].push(e),i(s)}))}))}flushPendingCalls(){this.pendingCalls.flushCalls()}slaveCall(t,e){-1!==this.masterRefs.indexOf(t)&&"function"===typeof e&&this.slaveObjects[t]&&this.slaveObjects[t].forEach(e)}}const Ym=new Gm;var zm=Ym;let Wm=!0;const $m=t=>{t&&"undefined"===typeof t.__tweenTickEnabled&&(t.__tweenTickEnabled=!1,Tm.framerate=60,Tm.addEventListener("tick",(e=>{!e.paused&&t.__tweenTickEnabled&&t.invalidate()})))},qm=t=>{const e=t.target,i=e.target||{},n=i.stage;$m(i.stage),n&&!n.__tweenTickEnabled&&Wm&&(n.__tweenTickEnabled=!0)},Qm=t=>{const e=t.target,i=e.target||{},n=i.stage;e.removeAllEventListeners(),n&&n.__tweenTickEnabled&&Wm&&(n.__tweenTickEnabled=!1)};var Jm={timeScale:1,get isEnabled(){return Wm},enable(){Wm=!0},disable(){Wm=!1},get(t){if(!Wm||"object"!==typeof t)return{to(){return!1}};t instanceof Zm&&(t=t.getStageDisplay());const e=xm.get(t,{override:!1,timeScale:this.timeScale});return e.addEventListener("change",qm),e.addEventListener("complete",Qm),e}};class Km{constructor(t){if(this.width=t.width||0,this.height=t.height||0,this.__json=t,this._stageDisplay=new Cm,this._stageDisplay.mouseEnabled=!1,this._stageDisplay.x=t.x||0,this._stageDisplay.y=t.y||0,this._mirror=t.mirror,this._ref=t.ref,this._random={factor:.5},t.random)for(const e in t.random)this._random[e]=t.random[e];this._stage=null,this._mirror?zm.addSlave(this._mirror,this).catch((t=>{this._mirror=null})):this._ref&&zm.addMaster(this._ref,this),this._transformations=null,t.transform&&(this._transformations=new Nm(t.transform))}on(t,e){this._stageDisplay.on(t,e)}once(t,e){this._stageDisplay.on(t,e,null,!0)}dispatchEvent(t,e,i){return this._stageDisplay.dispatchEvent(t,e,i)}enableInteractionEvents(t){this._stageDisplay.mouseEnabled=!!t}getRef(){return this._ref}getJsonBase(){return this.__json}removeAllChildren(){this._stageDisplay.removeAllChildren()}addChild(t){if("function"===typeof t.getStageDisplay)return t._stage=this._stage,void this._stageDisplay.addChild(t.getStageDisplay());this._stageDisplay.addChild(t)}get name(){return this.__json.name}get id(){return this.__json.id}get x(){return this._stageDisplay.x}get y(){return this._stageDisplay.y}setPosition(t,e){if(!Jm.isEnabled)return this._stageDisplay.x=t||0,void(this._stageDisplay.y=e||0);Jm.get(this).to({x:t||0,y:e||0},200,Sm.quartInOut)}setVisible(t){this._stageDisplay.visible=!!t,this.__json.visible=!!t}isVisible(){return this._stageDisplay.visible}isMirrored(){return!!this._mirror}transform(t){t&&this._transformations&&this._transformations.transform(t,this._stageDisplay)}getStageDisplay(){return this._stageDisplay}getStage(){return this._stage}getRandomChance(){return this._random.factor}isReady(){return!1}setProps(t){}update(){this._stageDisplay.visible!==this.__json.visible&&this.setVisible(this.__json.visible),this._stageDisplay.x===this.__json.x&&this._stageDisplay.y===this.__json.y||this.setPosition(this.__json.x,this.__json.y)}random(){let t=Math.random(),e=t<=this._random.factor;return this.isVisible()!==e&&this.setVisible(e),e}release(){}}var Zm=Km;class tg{constructor(){this.icons={},this._pendingResolves={}}flushPendingPromises(){for(const t in this.icons)"undefined"!==typeof this.icons[t]&&0!==this.icons[t].length&&this.icons[t].forEach(((e,i)=>{"undefined"!==typeof this._pendingResolves[`${t}${i}`]&&(this._pendingResolves[`${t}${i}`].forEach((t=>t(e))),delete this._pendingResolves[`${t}${i}`])}))}cleanOut(){this.icons={},this._pendingResolves={}}async add(t,e){if(!t||!e||!e.type||"image"!==e.type)throw new Error("Icon is empty or exist");e.visible=!1;let i=new rg(e,!0);if(!i)throw new Error("Icon is invalid");if("undefined"===typeof this.icons[t]&&(this.icons[t]=[],this.icons[t].keys=[]),-1!==this.icons[t].findIndex((t=>t.getJsonBase().id===i.getJsonBase().id)))throw new Error("Icon already exists");this.icons[t].push(i);let n=this.icons[t].indexOf(i),s=i.getJsonBase().name;this.icons[t].keys[n]=s,Fm.isOnDemandMode()||i.load(),"undefined"!==typeof this._pendingResolves[`${t}${n}`]&&(this._pendingResolves[`${t}${n}`].forEach((t=>t(i))),delete this._pendingResolves[`${t}${n}`]),"undefined"!==typeof this._pendingResolves[`${t}${s}`]&&(this._pendingResolves[`${t}${s}`].forEach((t=>t(i))),delete this._pendingResolves[`${t}${s}`])}has({name:t,index:e}){return"object"===typeof this.icons[t]&&("string"===typeof e&&(e=this.icons[t].keys.findIndex((t=>t===e))),"undefined"!==typeof this.icons[t][e])}get({name:t,index:e}){return new Promise(((i,n)=>{let s=null;if("string"===typeof e&&"object"===typeof this.icons[t]&&(e=this.icons[t].keys.findIndex((t=>t===e))),this.has({name:t,index:e})&&(s=this.icons[t][e]),!s||!s.isReady())return this._pendingResolves[`${t}${e}`]=this._pendingResolves[`${t}${e}`]||[],void this._pendingResolves[`${t}${e}`].push(i);i(s)}))}}const eg=new tg;var ig=eg;const ng=new RegExp(/^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i);class sg extends Zm{constructor(t,e=!1,i=!1){super(t),super.setVisible(!!t.visible),this.category=null,this.bmd=null,this.src=t.image,this.centerAligned=!!i,t.image="",t.thumbnail=null,t.rotation=t.rotation||0,t.scaleX=t.scaleX||1,t.scaleY=t.scaleY||1;const n=(Fm.baseURL||"./")+"thumbnails/";t.useIcon&&ng.test(t.name)&&(t.useIcon.index=t.name),this.hasCustomThumbnail()&&(t.thumbnail="",ig.get(t.useIcon).then((e=>{t.thumbnail=e.src,/^(blob|data):/.test(e.src)||(t.thumbnail=n+e.src),t.thumbnail&&this.dispatchEvent("thumbnail")}))),this._pendingPromises=new Hm,this._isImageAdded=!1,this._loaded=!1,Fm.isOnDemandMode()?(/^(blob|data):/.test(this.src)||(t.image=n+this.src),!e&&this.isVisible()&&this.load()):e||this.load()}update(){super.update(),!this.isVisible()&&Fm.isOnDemandMode()||this.updateBmdCache(),this.isVisible()&&this.bmd&&(this.bmd.rotation!==this.__json.rotation&&this.setRotation(this.__json.rotation),this.bmd.scaleX!==this.__json.scaleX&&this.setScaleX(this.__json.scaleX),this.bmd.scaleY!==this.__json.scaleY&&this.setScaleY(this.__json.scaleY))}hasCustomThumbnail(){return this.__json.useIcon&&this.__json.useIcon.name&&"undefined"!==typeof this.__json.useIcon.index}enableInteractionEvents(t){super.enableInteractionEvents(t),this.bmd&&(this.bmd.mouseEnabled=!!t)}updateBmdCache(){let t=this.getJsonBase();!t.image&&this.bmd&&this.bmd.bitmapCache&&!Fm.isOnDemandMode()&&(t.image=this.bmd.bitmapCache.getCacheDataURL())}setPosition(t,e){return this.__json.x=t||0,this.__json.y=e||0,super.setPosition(t,e)}setRotation(t){if(this.__json.rotation=t||0,!this.bmd)return!1;Jm.isEnabled?Jm.get(this.bmd).to({rotation:this.__json.rotation},200,Sm.quartInOut):this.bmd.rotation=this.__json.rotation}setScaleX(t){if(this.__json.scaleX=t||1,!this.bmd)return!1;Jm.isEnabled?Jm.get(this.bmd).to({scaleX:this.__json.scaleX,scaleY:this.__json.scaleY},200,Sm.quartInOut):this.bmd.scaleX=this.__json.scaleX}setScaleY(t){if(this.__json.scaleY=t||1,!this.bmd)return!1;Jm.isEnabled?Jm.get(this.bmd).to({scaleX:this.__json.scaleX,scaleY:this.__json.scaleY},200,Sm.quartInOut):this.bmd.scaleY=this.__json.scaleY}setVisible(t){super.setVisible(t),Fm.hasItem(this.src)||this.release(),!this.bmd&&this.isVisible()&&Fm.isOnDemandMode()&&this.load()}release(){this.bmd&&this.bmd.uncache(),this.bmd=null,this._loaded=!1,this._isImageAdded=!1,this.removeAllChildren(),Fm.releaseItem(this.src)}load(){if(this._loaded||this._isImageAdded)return Promise.reject(new Error("Image loaded"));this.bmd=Fm.getItem(this.src);const t=()=>{this._isImageAdded||(this.addChild(this.bmd),this._isImageAdded=!0),this._loaded=!0;let t=this.getStage();t&&t.invalidate(),this.updateBmdCache(),this.centerAligned&&this.bmd&&this.bmd.bitmapCache&&(this.bmd.regX=this.bmd.bitmapCache.width/2,this.bmd.regY=this.bmd.bitmapCache.height/2),this.bmd&&(this.bmd.rotation=this.__json.rotation||0,this.bmd.scaleX=this.__json.scaleX||1,this.bmd.scaleY=this.__json.scaleY||1)};return this.bmd?this.bmd&&!this.bmd.bitmapCache?new Promise(((e,i)=>{this.bmd.on("cached",(()=>{t(),e()}))})):(t(),Promise.resolve()):new Promise(((e,i)=>{if(!this.isVisible()&&Fm.isOnDemandMode())return this._pendingPromises.pushPromise({resolve:e,reject:i});Fm.addToQueue(this.src).then((i=>{this.bmd=i.result,t(),e(),this._pendingPromises.resolveAll()})).catch((t=>{i(t),this._pendingPromises.rejectAll(t)})),Fm.isOnDemandMode()&&Fm.loadItems()}))}isReady(){return this._loaded}}var rg=sg;class ag extends rg{constructor(t,e){super(t),this._color=this.__json.name,this.getRef()&&this.isVisible()&&zm.onFlushOnce((()=>this.setProps({color:this.getActiveColor()})))}getActiveColor(){return this._color}setVisible(t){return this.category&&t&&this.category.fireSetPropsEvent({color:this.getActiveColor()},this),super.setVisible(t)}setProps(t){if(t&&t.color){const e=t.color===this.getActiveColor();this.setVisible(e)}}}var og=ag;class lg extends Zm{constructor(t,e){super(t),super.setVisible(!!t.visible),super.setPosition(0,0),this.activeDisplay=-1,this.displays=[],this.colors=[],this.hideButtons=t.hideButtons,this._stage=e;let i=[],n=null,s=t.useIcon&&t.useIcon.name;t.children=t.children||[],t.children.forEach(((t,e)=>{if(!t||!t.name||!t.image)return;n&&(t.visible=!1),s&&(t.useIcon=t.useIcon||{name:s,index:e});let r=t.visible;r&&(n=t.name);let a=new rg(t,!0);this.addChild(a),this.displays.push(a),this.colors.push(t.name),Fm.isOnDemandMode()||i.push(a.load())})),n&&this._setActiveColor(n),-1===this.activeDisplay&&this._setActiveColor(this.colors[0]),Promise.all(i).then((()=>this._setActiveColor(this.colors[this.activeDisplay]))),this.getRef()&&this.isVisible()&&zm.onFlushOnce((()=>this.setProps({color:this.colors[this.activeDisplay]})))}getActiveColor(){return this.colors[this.activeDisplay]}getActiveImage(){return this.displays[this.activeDisplay]}getColors(){return this.colors}_setActiveColor(t){const e=this.colors.indexOf(t);if(-1===e)return;this.activeDisplay=e,this.displays.forEach(((t,i)=>{if(e===i)return t.setVisible(this.isVisible());t.isVisible()&&t.setVisible(!1)}));let i=this.displays[e],n=this.getJsonBase();n.image=i.getJsonBase().image,n.thumbnail=i.getJsonBase().thumbnail,i.hasCustomThumbnail()&&!n.thumbnail&&i.once("thumbnail",(()=>{this.activeDisplay===e&&(n.thumbnail=i.getJsonBase().thumbnail)}))}setVisible(t){return this.displays[this.activeDisplay].setVisible(t),super.setVisible(t)}setPosition(t,e){return super.setPosition(0,0)}update(){const t=this.activeDisplay;this.displays[this.activeDisplay].update(),this.displays[this.activeDisplay].isVisible()||(this.activeDisplay=-1),-1===this.activeDisplay&&(this.activeDisplay=this.displays.findIndex((t=>(t.update(),t.isVisible())))),-1===this.activeDisplay&&(this.activeDisplay=t),t!==this.activeDisplay&&this.setProps({color:this.colors[this.activeDisplay]}),super.update()}random(t={}){let e=Math.random(),i=t&&t.forceVisible,n=i||e<=this.getRandomChance();if(n){e=Math.random();let t=parseInt(1024*e%this.colors.length);this.setProps({color:this.colors[t]})}return this.isVisible()!==n&&this.setVisible(n),n}setProps(t){t&&t.color&&(this.category&&this.category.fireSetPropsEvent(t,this),this._setActiveColor(t.color))}isReady(){return this.displays[this.activeDisplay].isReady()}}var hg=lg;const cg={FIXED:"fixed",OPTIONAL:"optional",MIXED:"mixed",ICON:"icon",COLORPIKER:"color-picker",COLOR:"color",DYNAMIC:"dynamic",PALETTE:"palette",REMOVABLE:"removable",UIHIDDEN:"ui-hidden",LOCALPALETTE:"local-palette",LOCALPALETTES:"local-palettes",MOVE:"move",REF:"ref",MIRROR:"mirror",COLORGLOBAL:"enable-color-global",COLORLINK:"color-link",VISIBILITYLINK:"visibility-link",VISIBILITYGROUP:"visibility-group",VISIBLEWHENCOLORIN:"visible-when-color-in",RANDOM:"random",RANDOMCHILD:"random-c",RANDOMMAX:"random-max",RANDOMMIN:"random-min",ICONSET:"icon-set",USEICON:"use-icon",STAMPS:"stamps",toArray(){const t=[];for(const e in this)t.push(cg[e]);return t}},ug={f:cg.FIXED,o:cg.OPTIONAL,m:cg.MIXED,i:cg.ICON,colp:cg.COLORPIKER,c:cg.COLOR,d:cg.DYNAMIC,pal:cg.PALETTE,rm:cg.REMOVABLE,"ui-h":cg.UIHIDDEN,lpal:cg.LOCALPALETTE,lpals:cg.LOCALPALETTES,cl:cg.COLORLINK,"c-link":cg.COLORLINK,vl:cg.VISIBILITYLINK,"v-link":cg.VISIBILITYLINK,vg:cg.VISIBILITYGROUP,"v-group":cg.VISIBILITYGROUP,vwci:cg.VISIBLEWHENCOLORIN,mo:cg.MOVE,ref:cg.REF,mi:cg.MIRROR,cg:cg.COLORGLOBAL,"color-global":cg.COLORGLOBAL,r:cg.RANDOM,"random-children":cg.RANDOMCHILD,"r-c":cg.RANDOMCHILD,"r-max":cg.RANDOMMAX,"r-min":cg.RANDOMMIN,is:cg.ICONSET,ui:cg.USEICON,s:cg.STAMPS};var dg=cg;const fg=new Mm;class pg{constructor(t,e){if(this.id=t.id,this.isFixed=-1!==t.tags.indexOf(dg.FIXED),this.isMixed=-1!==t.tags.indexOf(dg.MIXED),this.isOptional=-1!==t.tags.indexOf(dg.OPTIONAL),this.children=[],this.hideIcon=!!t.hideIcon,!this.hideIcon){let e=new rg(t,!0);Fm.isOnDemandMode()||e.load()}let i;if(this.__useColorGlobal=-1!==t.tags.indexOf(dg.COLORGLOBAL),this.__isBusy=!1,this.__scope=t.colorGlobalScope,this.__useColorGlobal&&fg.addEventListener(this.__scope,(({eventProps:t,eventTarget:e})=>{this.__isBusy=!0;let i=null;this.isFixed&&(i=this.children.find((t=>t.isVisible())));let n=!1;this.children.forEach((i=>{Object.is(e,i)||"function"!==typeof i.setProps||(i.setProps(t),n=!0)})),n&&this.children.forEach((t=>t.update())),i&&-1===this.children.findIndex((t=>t.isVisible()))&&i.setVisible(!0),this.__isBusy=!1})),t.children=t.children||[],t.children.length>0&&(i=1/t.children.length),this._random={factor:1,childFactor:i,maxVisible:t.children.length},t.random)for(const r in t.random)this._random[r]=t.random[r];let n=t.useIcon&&t.useIcon.name;[...t.children].reverse().forEach(((t,i)=>{if(!t||!t.type)return;let s=null;switch("undefined"!==typeof this._random.childFactor&&(t.random&&"undefined"!==typeof t.random.factor||(t.random=t.random||{},t.random.factor=this._random.childFactor)),n&&(t.useIcon=t.useIcon||{name:n,index:"color-picker"!==t.type?i:void 0}),"color-picker"!==t.type||t.children&&0!==t.children.length||(t.type="image"),t.type){case"image":s=new rg(t);break;case"color-picker":s=new hg(t,e);break;case"color":s=new og(t,e);break;default:return null}s&&(e.addChild(s),t.index=e.children.indexOf(s),s.category=this,this.children.push(s))})),this.isFixed&&-1===this.children.findIndex((t=>t.isVisible()))&&zm.onFlushOnce((()=>this.random()));const s=this.children.find((t=>t.isVisible()));this.__useColorGlobal&&s&&"function"===typeof s.getActiveColor&&zm.onFlushOnce((()=>s.setProps({color:s.getActiveColor()})))}get scope(){return this.__scope}preventSetPropsEventDefaults(t=!0){this.__isBusy=t}fireSetPropsEvent(t,e){if(this.__useColorGlobal&&this.__scope&&!this.__isBusy&&t&&t.color){const i=new Dm(this.__scope);i.eventProps=t,i.eventTarget=e,fg.dispatchEvent(i)}}update(){0!==this.children.length&&(this.children.forEach((t=>t.update())),this.isFixed&&-1===this.children.findIndex((t=>t.isVisible()))&&this.children[0].setVisible(!0))}getRandomChance(){return this._random.factor}random(){if(0===this.children.length||this.hideIcon)return 0;let t=this.children.length,e=0,i=0;this.isOptional&&(e=0,t=1),this.isFixed&&(e=1,t=1),this._random.maxVisible>=0&&this.isMixed&&(t=this._random.maxVisible),this._random.minVisible>=0&&!this.isFixed&&(e=this._random.minVisible),t<e&&(e=t);let n=Math.random(),s=this.isFixed||n<=this.getRandomChance();s||(t=0,e=0);let r=[...this.children].reverse(),a=r.length,o=0,l=a;while(i<e&&l-- >0){let t=Math.random();0===o&&r.forEach((t=>{o+=t.getRandomChance()}));let e=t*o,n=0,s=r.find((t=>{const i=t.getRandomChance();return n+=i,n>=e}));s.random({forceVisible:!0}),s.isVisible()||s.setVisible(!0),o-=s.getRandomChance(),r.splice(r.indexOf(s),1),i++}return r.forEach((e=>{if(t<=i)return e.setVisible(!1);e.random(),e.isVisible()&&i++})),this.isFixed&&0===i&&this.children[0].setVisible(!0),s}isReady(){return-1===this.children.findIndex((t=>t.isVisible()&&!t.isReady()))}}pg.clearOut=()=>fg.removeAllEventListeners();let mg=[],gg=[],vg=[],_g={},bg=[];const yg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("move"))return;if(!t._tagsProps||!t._tagsProps.move)return e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "move" property.`);const[n,s,r,a,o=1]=t._tagsProps.move.split(" ").map((t=>parseInt(t)||0));if(n<0||s<0||r<0||a<0||o<0)return e(`Layer "${t.name}"(#${t.id}) has an invalid negative "move" parameter.`);(n||s||r||a||o)&&(i||(t.transform={up:n>0?n:0,right:s>0?s:0,down:r>0?r:0,left:a>0?a:0,step:o>0?o:1}))},wg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("enable-color-global"))return;const n=t._tagsProps["enable-color-global"]||Math.random().toString(36).substr(2,10);i||(t.colorGlobalScope=n),"undefined"!==typeof t._tagsProps["enable-color-global"]&&t.children.forEach((t=>{if("object"!==typeof t.tags)return;const e=t.tags.find((t=>-1!==t.indexOf("mirror:")||-1!==t.indexOf("ref:")));if(!e)return;const[i,s]=e.split(":").map((t=>t.trim())),r={scope:n,childJson:t};r[i]=s,bg.push(r)})),Bg((()=>{bg.forEach((t=>bg.forEach(((i,s)=>{if(!t.ref||t.ref!==i.mirror||t.scope!==i.scope||t.scope!==n)return;bg.splice(s,1);const r=t.childJson.tags;return-1!==r.indexOf("color-picker")||-1!==r.indexOf("color")?e(`Layer "${i.childJson.name}"(#${i.childJson.id}) was linked with layer "${t.childJson.name}"(#${t.childJson.id}) under the same color global scope "${i.scope}"`):void 0}))))}))},Eg=(t,e,i=!1)=>{if(-1!==t.tags.indexOf("color-picker"))return t._tagsProps&&t._tagsProps["color-picker"]&&"hidden"!==t._tagsProps["color-picker"]?e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "color-picker" tag. Please use only [color-picker] or [color-picker:hidden], not [color-picker:${t._tagsProps["color-picker"]}].`):void(i||(t.hideButtons="hidden"===t._tagsProps["color-picker"]))},Cg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("color-link"))return;const n="color-link",s=["color-picker","color","palette","visible-when-color-in"];return t.tags.find((t=>s.includes(t)))?void 0:e(`Layer "${t.name}"(#${t.id}) has an invalid [${n}] tag. Only layers with ${s.map((t=>`[${t}]`)).join(", ")} can have a [${n}] tag.`)},Tg=(t,e,i=!1)=>{const n="visible-when-color-in",s=["color-link"],r=["visibility-link"];if(-1===t.tags.indexOf(n))return;if(!t._tagsProps||"undefined"===typeof t._tagsProps[n])return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted [${n}] property. It must be a palette defined like [${n}:any-palette-name].`);if(!t.tags.find((t=>s.includes(t))))return e(`Layer "${t.name}"(#${t.id}) has an invalid [${n}] tag. Only layers with ${s.map((t=>`[${t}]`)).join(", ")} can have a [${n}] tag.`);const a=t.tags.find((t=>r.includes(t)));return a?e(`Layer "${t.name}"(#${t.id}) has an invalid combination of tags. The [${a}] and [${n}] tags can't be used together.`):void 0},xg=(t,e,i=!1)=>{const n="visibility-link";if(-1!==t.tags.indexOf(n))return t._tagsProps&&"undefined"!==typeof t._tagsProps[n]?void Bg((()=>{if("image-dynamic"!==t.type)return e(`Layer "${t.name}"(#${t.id}) has an invalid [${n}] tag. For now, the tag can only be used on layers children of a [dynamic] tag.`)})):e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted [${n}] property. It must be a scope defined like [${n}:any-scope-name].`)},Sg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("visibility-group"))return;const n="visibility-group",s=["visibility-link"];return t._tagsProps&&"undefined"!==typeof t._tagsProps[n]?t.tags.find((t=>s.includes(t)))?void 0:e(`Layer "${t.name}"(#${t.id}) has an invalid [${n}] tag. Only layers with ${s.map((t=>`[${t}]`)).join(", ")} can have a [${n}] tag.`):e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted [${n}] property. It must be a group defined like [${n}:any-group-name].`)},Ig=(t,e,i=!1)=>{if(-1!==t.tags.indexOf("removable"))return t._tagsProps&&t._tagsProps.removable?e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "removable" tag. Please use only [removable], not [removable:${t._tagsProps.removable}].`):void Bg((()=>{if("image-dynamic"!==t.type)return e(`Layer "${t.name}"(#${t.id}) has an invalid [removable] tag. The tag can only be used on layers children of a [dynamic] tag.`)}))},Lg=(t,e,i=!1)=>{let n=null;const s=t.tags.find((t=>"dynamic"===t)),r=t.tags.find((t=>"palette"===t));if(s||r)return s&&t._tagsProps&&t._tagsProps["dynamic"]?e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "dynamic" tag. Please use only [dynamic], not [dynamic:${t._tagsProps["dynamic"]}].`):(n=t.tags.find((t=>"dynamic"!==t&&"random"!==t&&"move"!==t&&"ref"!==t&&"mirror"!==t&&"ui-hidden"!==t)),s&&n?e(`Layer "${t.name}"(#${t.id}) has the [dynamic] tag next to the [${n}] tag`):(n=t.tags.find((t=>"palette"!==t&&"random"!==t&&"color-link"!==t&&"visibility-link"!==t&&"visibility-group"!==t&&"removable"!==t&&"ui-hidden"!==t)),r&&n?e(`Layer "${t.name}"(#${t.id}) has the [palette] tag next to the [${n}] tag`):void 0))},Og=(t,e,i=!1)=>{if(-1!==t.tags.indexOf("stamps"))return t.tags.length>1?e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "stamps" tag. Layers with a "stamps" tag should not have any other tags.`):t._tagsProps&&t._tagsProps.stamps?e(`Layer "${t.name}"(#${t.id}) as an incorrectly formatted "stamps" tag. Please use only [stamps], not [stamps:${t._tagsProps.stamps}].`):void 0},Ag=(t,e,i=!1)=>{["random","random-c","random-max","random-min"].forEach((n=>{if(-1===t.tags.indexOf(n))return;if(!t._tagsProps||"undefined"===typeof t._tagsProps[n])return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted "${n}" property.`);let s=t._tagsProps[n];const r=/^[+-]?\d+(\.\d+)?$/;if(!r.test(s))return e(`Layer "${t.name}"(#${t.id}) has an invalid number value.`);const a="random-max"===n||"random-min"===n;if(s=a?Number.parseInt(s):Number.parseFloat(s),isNaN(s))return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "${n}" property.`);if(s<0)return e(`Layer "${t.name}"(#${t.id}) has an invalid negative "${n}" parameter.`);if(!a&&s>1)return e(`Layer "${t.name}"(#${t.id}) property "${n}" must be between 0 and 1.`);if(!i)switch(t.random=t.random||{},n){case"random":t.random.factor=s;break;case"random-c":t.random.childFactor=s;break;case"random-max":t.random.maxVisible=s;break;case"random-min":t.random.minVisible=s;break}}))},kg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("use-icon")||-1!==t.tags.indexOf("icon-set"))return;if(!t._tagsProps||!t._tagsProps["use-icon"])return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "use-icon" property.`);let[n,s]=t._tagsProps["use-icon"].split(" ").map((t=>t.trim()));return"undefined"!==typeof s&&(s=parseInt(s)),"number"===typeof s&&(isNaN(s)||s<0)?e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "use-icon" property.`):n?void Bg((()=>{const r="none"===n;if(-1===vg.indexOf(n)&&!r)return e(`Layer "${t.name}"(#${t.id}) attempts to use an undefined "icon-set" called "${n}".`);i||(t.hideIcon=r,r||(t.useIcon={name:n,index:s}))})):e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "use-icon" property.`)},Rg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("icon-set")||-1!==t.tags.indexOf("use-icon"))return;if(!t._tagsProps||!t._tagsProps["icon-set"])return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "icon-set" property.`);const n=t._tagsProps["icon-set"];return-1!==vg.indexOf(n)?e(`Layer "${t.name}"(#${t.id}) has a duplicate "icon-set" name "${n}".`):"none"===n?e(`Layer "${t.name}"(#${t.id}) has a reserve "icon-set" name "${n}".`):(i||(t.iconSet={name:n.trim()},Bg((()=>{t.visible=!1}))),void vg.push(n))},Pg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("ref"))return;if(!t._tagsProps||!t._tagsProps.ref)return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "ref" property.`);const n=t._tagsProps.ref;if(-1!==gg.indexOf(n))return e(`Layer "${t.name}"(#${t.id}) has a duplicate "ref" name "${n}".`);const s=["image","color-picker","color","dynamic"];if(!s.includes(t.type))return e(`Layer "${t.name}"(#${t.id}) is not a type that can use the [ref] tag. Only layers ${s.map((t=>`"${t}"`)).join(", ")} can use the [ref] tag.`);i||(t.ref=n),gg.push(n),_g[n]=t},Dg=(t,e,i=!1)=>{if(-1===t.tags.indexOf("mirror"))return;if(!t._tagsProps||!t._tagsProps.mirror)return e(`Layer "${t.name}"(#${t.id}) has an incorrectly formatted  "mirror" property.`);const n=t._tagsProps.mirror;Bg((()=>{if(-1===gg.indexOf(n))return e(`Layer "${t.name}"(#${t.id}) attempts to use an undefined "ref" called "${n}".`);const s=_g[n];return t.type!==s.type?e(`Layer "${t.name}"(#${t.id}) and its reference "${n}" need to share the same "type" property.`):t.children.length!==s.children.length?e(`Layer "${t.name}"(#${t.id}) and its reference "${n}" need to share the same number of children.`):t.children.every(((t,e)=>s.children[e].type===t.type&&s.children[e].tags.every(((e,i)=>t.tags[i]===e))))?void(i||(t.mirror=n,t.visible=_g[n].visible,t.children.forEach(((t,e)=>{t.visible=_g[n].children[e].visible})))):e(`Layer "${t.name}"(#${t.id}) and its reference "${n}" need to share the same tags for each child.`)}))},Mg=t=>{if(!t||!t.tags||t._tags)return;const e={};t._tags=t.tags.map((t=>t)),t.tags=t.tags.map((t=>{if(!t.indexOf(":"))return t;const[i,n]=t.split(":").map((t=>t.trim()));return e[i]=n,i})),t._tagsProps=e},jg=(t,e,i=!1)=>{Rg(t,e,i),kg(t,e,i),Pg(t,e,i),Dg(t,e,i),yg(t,e,i),wg(t,e,i),Ag(t,e,i),Lg(t,e,i),Eg(t,e,i),Cg(t,e,i),xg(t,e,i),Sg(t,e,i),Tg(t,e,i),Ig(t,e,i),Og(t,e,i),delete t._tagsProps},Bg=t=>{mg.push(t)},Fg=async t=>{for(const e of mg){if("function"!==typeof e)continue;const i=e(t);i&&i instanceof Promise&&await i}mg=[],gg=[],vg=[],_g={},bg=[]};dg.computeTagsProps=Mg,dg.prepareCustomTags=jg,dg.flushPendingCalls=Fg,dg.pushFunc=Bg,dg.tagNameByAlias=t=>t&&"string"===typeof ug[t]?ug[t]:null;Math.PI;const Ug=180/Math.PI,Ng=Object.freeze({PINCH_START:"stagepinchstart",PINCH_MOVE:"stagepinchmove",PINCH_END:"stagepinchend"});class Xg{constructor(){throw new Error("Pinch cannot be instantiated")}static isSupported(){return Ef.isSupported()}static enable(t){return!!(t&&t.canvas&&Ef.isSupported())&&(t.__pinch&&t.__pinch.enable||("undefined"===typeof t.__pinch&&(t.__pinch={enabled:!0,touchs:[],eventData:null}),t.__pinch.enable=!0,t.__pinch.touchs=[],t.__pinch.eventData=null,t.addEventListener("stagemousedown",Hg),t.addEventListener("stagemouseup",Vg),t.addEventListener("stagemousemove",Gg)),!0)}static disable(t){return!(!t||!t.canvas)&&(!("object"!==typeof t.__pinch||!t.__pinch.enable)&&(t.__pinch.enable=!1,t.removeEventListener("stagemousedown",Hg),t.removeEventListener("stagemouseup",Vg),t.removeEventListener("stagemousemove",Gg),!0))}}const Hg=t=>{if(!t.isTouch||-1===t.pointerID)return;const e=t.target;if(!e.__pinch||!e.__pinch.enable)return;const i=e.__pinch,n=i.touchs;if(n.length>=2)return;const s=i.touchs.findIndex((e=>e.pointerID===t.pointerID));if(-1===s&&i.touchs.push({pointerID:t.pointerID,x:t.stageX,y:t.stageY}),2!==n.length)return;i.eventData={delta:1,distance:Yg(n[0],n[1]),angle:zg(n[0],n[1]),pivot:{x:(n[0].x+n[1].x)/2,y:(n[0].y+n[1].y)/2}};const r=new Dm(Ng.PINCH_START);r.set(i.eventData),e.dispatchEvent(r)},Vg=t=>{if(!t.isTouch||-1===t.pointerID)return;const e=t.target;if(!e.__pinch||!e.__pinch.enable)return;const i=e.__pinch,n=i.touchs.findIndex((e=>e.pointerID===t.pointerID));-1!==n&&(i.touchs.splice(n,1),i.eventData&&(i.eventData=null,e.dispatchEvent(new Dm(Ng.PINCH_END))))},Gg=t=>{if(!t.isTouch||-1===t.pointerID)return;const e=t.target;if(!e.__pinch||!e.__pinch.enable)return;const i=e.__pinch,n=i.touchs.find((e=>e.pointerID===t.pointerID));if(!n)return;n.x=t.stageX,n.y=t.stageY;const s=i.touchs;if(2!==s.length)return;const r=Yg(s[0],s[1]);i.eventData.delta=r/i.eventData.distance,i.eventData.angle=zg(s[0],s[1]);const a=new Dm(Ng.PINCH_MOVE);a.set({delta:i.eventData.delta,distance:r,angle:i.eventData.angle,pivot:{x:(s[0].x+s[1].x)/2,y:(s[0].y+s[1].y)/2}}),e.dispatchEvent(a)},Yg=(t,e)=>Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),zg=(t,e)=>Math.atan2(e.x-t.x,-(e.y-t.y))*Ug,Wg=Object.freeze({CHILD_CREATED:"childcreated",READY:"ready",SHOW:"show",HIDE:"hide",DISPOSE:"dispose",UPDATE:"update",PISTON_ATTRIBUTE_CHANGE:"pistonattributechanged",ITEM_EDITOR_SHOW:"itemeditorshow",ITEM_EDITOR_HIDE:"itemeditorhide",BEFORE_MOUNT:"beforemount",MOUNT:"mount",UNMOUNT:"unmount",BEFORE_UNMOUNT:"beforeunmount",PROGRESS:"progress",COMPLETE:"complete"}),$g=Object.freeze({CLICK:"click"});function qg(t,e){t.children.forEach((t=>{t.visible&&!e.root.lifeCycle.has(t.id)&&e.root.lifeCycle.createItem(t)}))}const Qg=new Tf(Wg.PISTON_ATTRIBUTE_CHANGE);function Jg(t,e){Kg(e),e.dispatchEvent(Qg)}function Kg(t){return t.effectivelyVisible?nv.show(t):nv.hide(t)}function Zg(t,e){nv.dispose(e)}const tv=Symbol("@watched");function ev(t){if("object"!==typeof t)return;if(!Object.hasOwnProperty.call(t,tv))return;const e=t[tv];Array.isArray(e)&&(e.forEach((t=>{"function"===typeof t&&t()})),Object.defineProperty(t,tv,{value:null,writable:!1,configurable:!0}))}function iv(t,e){if(Object.hasOwnProperty.call(e,tv)&&Array.isArray(e[tv]))return;Object.defineProperty(e,tv,{value:[],writable:!1,configurable:!0});const i=e[tv];i.push(Qd.watch(t,(i=>{if(!e.isDisposed)return i===jr.ATTRIBUTE_CHANGE?Jg(t,e):i===jr.CHILDREN_LENGTH_CHANGE?qg(t,e):i===jr.DESTROYED?Zg(t,e):void 0})))}class nv extends wf{sortId=0;root=null;base=null;isEditable=!1;isClickableToEdit=!1;useOnlyOffsetPosition=!1;originalX;originalY;constructor(t,e,i=null){if(super(),"object"!==typeof t||"object"!==typeof e)throw new Error("Invalid arguments");this.isClickableToEdit=!(!i||!i.isClickableToEdit),this.isEditable=!(!i||!i.isEditable)||this.isClickableToEdit,this.useOnlyOffsetPosition=!i||"boolean"!==typeof i.useOnlyOffsetPosition||i.useOnlyOffsetPosition,this.eventsToDispose=new Map,this.name=t.name||"Unknown",this.base=t,this.root=e,this.sortId=t.sort_id||0,this.originalX=t.x,this.originalY=t.y,this.isEditable&&this.addEventListener(Wg.PISTON_ATTRIBUTE_CHANGE,(()=>this.updateAttributes())),this.isClickableToEdit&&(this.addEventListener($g.CLICK,(t=>{this.target&&t.nativeEvent&&t.nativeEvent.cancelable&&t.nativeEvent.preventDefault();const e=new Tf(Wg.ITEM_EDITOR_SHOW);e.selectedItem=this,this.root.dispatchEvent(e)})),this.addEventListener(Wg.HIDE,(t=>{this.root.dispatchEvent(new Tf(Wg.ITEM_EDITOR_HIDE))}))),this.addEventListener(Wg.DISPOSE,(t=>{this.eventsToDispose.forEach(((t,e)=>{this.removeEventListener(e,t)})),this.eventsToDispose.clear(),ev(this)})),this.updateAttributes(),iv(t,this)}get effectivelyVisible(){if(!this.base.visible)return!1;const t=nv.getParentLayer(this);return!t||t===this.root||t.effectivelyVisible}get numChildren(){return this.children.length}get pistonId(){return this.base.id}get parentId(){return this.base.parent_id}get isDisposed(){return!this.root}get isMounted(){return!!this.parent}get isReady(){return!0}updateAttributes(){this.x=this.base.x||0,this.y=this.base.y||0,this.useOnlyOffsetPosition&&(this.x-=this.originalX,this.y-=this.originalY),this.rotation="number"===typeof this.base.rotation?this.base.rotation:0,this.scaleX="number"===typeof this.base.scale_x?this.base.scale_x:1,this.scaleY="number"===typeof this.base.scale_y?this.base.scale_y:1}addEventListener(t,e,i=null){return this.eventsToDispose.set(t,e),super.addEventListener(t,e,i)}static show(t){t.isDisposed||t.root.lifeCycle.show(t)}static hide(t){t.isDisposed||t.root.lifeCycle.hide(t)}static prefetch(t){const e=t.base.image||null;if(t.isReady)return Promise.resolve(e);const i=new Promise((i=>{const n=s=>{t.removeEventListener(Wg.READY,n),i(e)};t.addEventListener(Wg.READY,n)}));return t.dispatchEvent(Wg.BEFORE_MOUNT),i}static getParentLayer(t){if(!t.isDisposed)return t.isMounted?t.parent:t.root.lifeCycle.get(t.parentId)}static dispose(t){t.isDisposed||t.root.lifeCycle.dispose(t)}}class sv extends nv{dirty=!1;bounds=null;constructor(t,e,i=null){super(t,e,i);const n=[],s=t=>t.base.visible,r=t=>t.isReady&&t.visible,a=()=>n.length>0&&n.every((t=>!s(t)||r(t))),o=t=>{t.effectivelyVisible&&0!==this.numChildren&&!this.dirty&&a()&&(this.dirty=!0,kr((()=>{this.dirty&&(this.dirty=!1,this.bounds=Df(n.filter((t=>r(t))).map((t=>({width:t.texture.originalWidth,height:t.texture.originalHeight,x:t.x,y:t.y})))),rv(this,this.bounds))})))};this.addEventListener(Wg.PISTON_ATTRIBUTE_CHANGE,(()=>o(this))),this.addEventListener(Wg.CHILD_CREATED,(({dollItem:t})=>{n.push(t),t.addEventListener(Wg.SHOW,(()=>o(t))),t.addEventListener(Wg.HIDE,(()=>o(this)))}))}}function rv(t,e){t.cache(e.x,e.y,e.width,e.height)}const av=new Tf(Wg.READY),ov=Object.freeze({TOP_LEFT:"top-left",CENTER:"center"});class lv extends nv{texture=null;texturePivot=ov.TOP_LEFT;constructor(t,e,i=null){if(super(t,e,i),"string"===typeof t.blend_mode&&(this.compositeOperation=tf(t.blend_mode)),this.texturePivot=i&&i.texturePivot||ov.TOP_LEFT,!t.image||"string"!==typeof t.image)throw new Error("Invalid itemData.image");let n=!1;this.addEventListener(Wg.BEFORE_MOUNT,(()=>{n||(n=!0,this.handleBeforeMount(this).then((()=>{n=!1})).catch((t=>{throw n=!1,t})))})),this.addEventListener(Wg.DISPOSE,(()=>this.handleDispose()))}get isReady(){return!(!this.texture||!this.texture.loaded)}async handleDispose(){this.texture&&(this.removeChild(this.texture),this.texture.dispose(),this.texture=null)}async handleBeforeMount(){if(this.texture)return;const t=this.root.manifest.base_url||"",e=uv(this.base.image,t),i=cv(this),n=await Of.fromURL(e,i);this.texture=n,this.addChild(n),hv(n,this.texturePivot),this.dispatchEvent(av)}}function hv(t,e){t.x=0,t.y=0,e===ov.CENTER&&(t.x=-t.originalWidth/2,t.y=-t.originalHeight/2)}function cv(t,e="texture"){let i=t.base.image;return dv(i)&&(i=t.base.image_hash||`${e}#${t.base.id}`),i}const uv=(t,e)=>dv(t)?t:e+t,dv=t=>t&&(t.startsWith("data:")||t.startsWith("blob:")),fv=new Tf(Wg.READY);class pv extends nv{texture=null;fillColor=null;graphics=null;texturePivot=ov.TOP_LEFT;constructor(t,e,i=null){if(super(t,e,i),"string"===typeof t.blend_mode&&(this.compositeOperation=tf(t.blend_mode)),this.texturePivot=i&&i.texturePivot||ov.TOP_LEFT,!t.image||"string"!==typeof t.image)throw new Error("Invalid itemData.image");this.graphics=new yf;let n=!1;this.addEventListener(Wg.BEFORE_MOUNT,(()=>{n||(n=!0,this.handleBeforeMount(this).then((()=>{n=!1})).catch((t=>{throw n=!1,t})))})),this.addEventListener(Wg.PISTON_ATTRIBUTE_CHANGE,(()=>gv(this))),this.addEventListener(Wg.SHOW,(()=>gv(this))),this.addEventListener(Wg.DISPOSE,(()=>this.handleDispose()))}get isReady(){return!!(this.texture&&this.texture.loaded&&this.fillColor)}async handleDispose(){this.texture&&(this.removeChild(this.texture),this.texture.dispose(),this.texture=null,this.graphics.clear())}async handleBeforeMount(){if(this.texture)return;const t=this.root.manifest.base_url||"",e=uv(this.base.image,t),i=cv(this),n=await Of.fromURL(e,i);this.texture=n,this.addChild(n),hv(n,this.texturePivot),mv(this),gv(this),this.dispatchEvent(fv)}}async function mv(t){const e=new bf(t.graphics);e.compositeOperation="source-in",t.addChild(e)}async function gv(t){const{activeColor:e}=Qd.getMetadataOf(t.base);if(!t.texture||t.fillColor===e)return;t.fillColor=e||"#ffffff";const i={x:t.texture.x,y:t.texture.y,width:t.texture.originalWidth,height:t.texture.originalHeight};t.graphics.clear().beginFill(t.fillColor).drawRect(i.x,i.y,i.width,i.height).endFill(),rv(t,i)}class vv{static createInstance(t,e){if(!e||"object"!==typeof e)throw new TypeError("invalid root object");return"function"===typeof wv[t.type]?wv[t.type](t,e):new nv(t,e,{isEditable:_v(t),useOnlyOffsetPosition:!0})}}const _v=t=>!!t.tags.find((t=>t.startsWith("move:")||t.startsWith("ref:")||t.startsWith("mirror:"))),bv=t=>!!t.tags.find((t=>t.startsWith("palette"))),yv=Object.freeze({texturePivot:ov.TOP_LEFT,isEditable:!1,isClickableToEdit:!1,useOnlyOffsetPosition:!1}),wv=Object.freeze({image:(t,e)=>{const i=Object.assign({},yv);return i.texturePivot=ov.TOP_LEFT,i.isEditable=_v(t),i.isClickableToEdit=!1,new lv(t,e,i)},dynamic:(t,e)=>new sv(t,e,{isEditable:_v(t),useOnlyOffsetPosition:!0}),"image-dynamic":(t,e)=>{const i=Object.assign({},yv);return i.texturePivot=ov.TOP_LEFT,i.isEditable=_v(t),i.isClickableToEdit=!1,bv(t)?new pv(t,e,i):new lv(t,e,i)},"image-color":(t,e)=>{const i=Object.assign({},yv);return i.texturePivot=ov.TOP_LEFT,i.isEditable=_v(t),i.isClickableToEdit=!1,new lv(t,e,i)},color:(t,e)=>{const i=Object.assign({},yv);return i.texturePivot=ov.TOP_LEFT,i.isEditable=_v(t),i.isClickableToEdit=!1,new lv(t,e,i)},"stamp-item":(t,e)=>{const i=Object.assign({},yv);return i.texturePivot=ov.CENTER,i.isEditable=!0,i.isClickableToEdit=!0,new lv(t,e,i)}}),Ev=new Tf(Wg.CHILD_CREATED),Cv=new Tf(Wg.SHOW),Tv=new Tf(Wg.HIDE),xv=new Tf(Wg.DISPOSE),Sv=new Tf(Wg.BEFORE_MOUNT),Iv=new Tf(Wg.MOUNT),Lv=new Tf(Wg.BEFORE_UNMOUNT),Ov=new Tf(Wg.UNMOUNT),Av=new Tf(Wg.PROGRESS),kv=new Tf(Wg.COMPLETE);class Rv{waitingToBeCreated=[];waitingToMount=[];readyToShow=[];readyToHide=[];waitingToUnmount=[];waitingToBeDisposed=[];cyclePending=!1;cycleStartTime=0;liveObjectsById=new Map;root=null;waitingPromise=null;constructor(t){if("object"!==typeof t)throw new TypeError("Invalid root container object");this.root=t,this.waitNextFrameCallback=()=>Pr((()=>this.nextCycle())),Object.seal(this)}get isIdle(){return!this.waitingPromise}get size(){return this.liveObjectsById.size}has(t){return-1===this.waitingToBeDisposed.findIndex((e=>e.pistonId===t))&&this.liveObjectsById.has(t)}get(t){if(this.has(t))return this.liveObjectsById.get(t)}createItem(t){if("object"!==typeof t)throw new TypeError("invalid object");const e=t.id||-1,i=this.liveObjectsById.get(t.parent_id),n=t.visible&&(!i||i.base.visible);if(this.clearItemFromAllQueues(e),this.liveObjectsById.has(e)){const t=this.liveObjectsById.get(e);return n&&this.show(t),this}return this.waitingToBeCreated.push(t),this.nextCycle(),this}mount(t){if("object"!==typeof t)throw new TypeError("invalid object");if(!this.liveObjectsById.has(t.pistonId))throw new TypeError("item id was not found");if(-1!==this.waitingToMount.indexOf(t))return this;const e=this.readyToShow.indexOf(t);return this.clearItemFromAllQueues(t.pistonId),-1!==e&&this.readyToShow.push(t),this.waitingToMount.push(t),this.nextCycle(),kr((()=>t.dispatchEvent(Sv))),this}show(t){if("object"!==typeof t)throw new TypeError("invalid object");if(!this.liveObjectsById.has(t.pistonId))throw new TypeError("item id was not found");return-1!==this.readyToShow.indexOf(t)||(this.readyToShow.push(t),this.mount(t),t.base.children&&t.base.children.forEach((t=>{if(!t.visible)return;const e=this.liveObjectsById.get(t.id);e&&!e.isMounted&&this.show(e)})),this.nextCycle()),this}hide(t){if("object"!==typeof t)throw new TypeError("invalid object");if(!this.liveObjectsById.has(t.pistonId))throw new TypeError("item id was not found");return-1!==this.readyToHide.indexOf(t)||(this.readyToHide.push(t),this.unmount(t),this.nextCycle()),this}unmount(t){if("object"!==typeof t)throw new TypeError("invalid object");if(!this.liveObjectsById.has(t.pistonId))throw new TypeError("item id was not found");if(-1!==this.waitingToUnmount.indexOf(t))return this;const e=this.waitingToBeDisposed.indexOf(t);return this.clearItemFromAllQueues(t.pistonId),-1!==e&&this.waitingToBeDisposed.push(t),this.readyToHide.push(t),this.waitingToUnmount.push(t),this.nextCycle(),kr((()=>t.dispatchEvent(Lv))),this}dispose(t){if("object"!==typeof t)throw new TypeError("invalid object");if(!this.liveObjectsById.has(t.pistonId))throw new TypeError("item id was not found");return-1!==this.waitingToBeDisposed.indexOf(t)||(this.clearItemFromAllQueues(t.pistonId),this.hide(t),this.waitingToBeDisposed.push(t),this.nextCycle()),this}clearItemFromAllQueues(t){const e=this.waitingToBeCreated.findIndex((e=>e.id===t));-1!==e&&this.waitingToBeCreated.splice(e,1);const i=this.liveObjectsById.get(t);i&&[this.waitingToBeDisposed,this.waitingToMount,this.waitingToUnmount,this.readyToHide,this.readyToShow].forEach((t=>{const e=t.indexOf(i);-1!==e&&t.splice(e,1)}))}async waitPromise(){return this.waitingPromise||this.nextCycle(),this.waitingPromise.promise}nextCycle(){if(!this.root.piston)return Promise.reject(new Error("Piston not loaded"));if(this.waitingPromise||(this.waitingPromise=Object.create(null),this.waitingPromise.promise=new Promise(((t,e)=>{this.waitingPromise.resolve=t,kr((()=>this.root.dispatchEvent(Av)))})),this.waitingPromise.promise.then((()=>{kr((()=>this.root.dispatchEvent(kv)))}))),this.cyclePending)return this.waitingPromise.promise;this.cyclePending=!0;const t=this.cycleStartTime>0?Date.now()-this.cycleStartTime:0;return!this.root.piston.isIdle||t>Cr?(Pr((()=>{this.cyclePending=!1,this.cycleStartTime=0,this.nextCycle()})),this.waitingPromise.promise):(kr((()=>{if(this.cyclePending=!1,this.cycleStartTime=this.cycleStartTime||Date.now(),this.waitingPromise){if(this.waitingToBeCreated.length>0){const t=this.waitingToBeCreated.shift(),e=vv.createInstance(t,this.root),i=this.liveObjectsById.get(t.parent_id),n=t.visible&&(!i||i.base.visible);if(e.visible=!1,e.isReady||e.addEventListener(Wg.READY,this.waitNextFrameCallback),this.liveObjectsById.set(e.pistonId,e),n&&this.show(e),t.children&&t.children.forEach((t=>{this.createItem(t)})),i){const t=Object.create(Ev);t.dollItem=e,kr((()=>i.dispatchEvent(t)))}return this.nextCycle()}if(this.waitingToMount.length>0){if(!this.waitingToMount[0].isReady)return;const t=this.waitingToMount.shift();if(t.isMounted)return this.nextCycle();let e=this.liveObjectsById.get(t.parentId);if(t.parentId||(e=this.root),!e)throw new Error("parent not alive");return e.addChild(t),e.sortChildren(Pv),kr((()=>t.dispatchEvent(Iv))),this.nextCycle()}if(this.readyToShow.length>0||this.readyToHide.length>0){let t=!1;return this.readyToShow.forEach((e=>{e.isMounted||(this.mount(e),t=!0)})),t?this.nextCycle():(this.readyToShow.forEach((t=>{t.visible=!0,kr((()=>{t.dispatchEvent(Cv)}))})),this.readyToHide.forEach((t=>{t.visible=!1,kr((()=>{t.dispatchEvent(Tv)}))})),this.readyToShow.length=0,this.readyToHide.length=0,this.nextCycle())}if(this.waitingToUnmount.length>0){const t=this.waitingToUnmount.shift();if(!t.isMounted)return this.nextCycle();const e=t.parent;if(!e)throw new Error("parent not alive");return e.removeChild(t),kr((()=>{t.dispatchEvent(Ov)})),this.nextCycle()}if(this.waitingToBeDisposed.length>0){let t=!1;if(this.waitingToBeDisposed.forEach((e=>{e.isMounted&&(this.unmount(e),t=!0)})),t)return this.nextCycle();const e=this.waitingToBeDisposed.shift();return this.liveObjectsById.delete(e.pistonId),e.base.children&&e.base.children.forEach((t=>{this.dispose(this.get(t.id))})),e.root=null,e.base=null,e.removeEventListener(Wg.READY,this.waitNextFrameCallback),kr((()=>{e.dispatchEvent(xv)})),this.nextCycle()}{this.cyclePending=!1,this.cycleStartTime=0;const{resolve:t}=this.waitingPromise;this.waitingPromise=null,t()}}})),this.waitingPromise.promise)}}function Pv(t,e){return e.sortId!==t.sortId?e.sortId-t.sortId:e.pistonId-t.pistonId}const Dv=new Tf(Wg.READY);class Mv extends wf{lifeCycle;piston;manifest;base;originalWidth;originalHeight;constructor(t){if(super(),!(t instanceof Qd))throw new TypeError("Invalid piston object");const e=Object.assign({},t.manifest||{},{children:[]});if("object"!==typeof e||"undefined"===typeof e.game_id||"undefined"===typeof e.release_id||"undefined"===typeof e.canvas_height||"undefined"===typeof e.canvas_width||"undefined"===typeof e.base_url)throw new TypeError("Piston manifest not found or invalid");this.name=e.name||"Unknown",Object.defineProperties(this,{lifeCycle:{value:new Rv(this),writable:!1,configurable:!0},manifest:{value:e,writable:!1,configurable:!0},base:{value:t.base,writable:!1,configurable:!0},piston:{value:t,writable:!1,configurable:!0},originalWidth:{value:e.canvas_width,writable:!1,configurable:!0},originalHeight:{value:e.canvas_height,writable:!1,configurable:!0}}),Object.preventExtensions(this)}get gameId(){return this.manifest.game_id}get releaseId(){return this.manifest.release_id}get numUnits(){return this.lifeCycle.size}get numChildren(){return this.children.length}get isIdle(){return this.lifeCycle.isIdle&&this.piston.isIdle}get isDisposed(){return!this.manifest}get isReady(){return this.lifeCycle.size>0}async start(){if(!this.isReady){if(!this.piston.base)throw new Error("You need to load piston dataJson before start");Object.defineProperties(this,{base:{value:this.piston.base,writable:!1,configurable:!0}}),this.base.forEach((t=>{this.lifeCycle.createItem(t)})),await this.lifeCycle.waitPromise(),this.dispatchEvent(Dv)}}async prefetchUnits(t){if(!Array.isArray(t))throw new TypeError("Invalid pistonUnitIds array");const e=[];return t.forEach((t=>{const i=this.lifeCycle.get(t);i&&!i.isReady&&e.push(nv.prefetch(i))})),Promise.all(e)}async dispose(){if(this.parent&&this.parent.removeChild(this),this.children.forEach((t=>{"object"===typeof t.root&&this.lifeCycle.dispose(t)})),await this.lifeCycle.waitPromise(),Object.defineProperties(this,{lifeCycle:{value:new Rv(this),writable:!1,configurable:!0},manifest:{value:null,writable:!1},base:{value:null,writable:!1},piston:{value:null,writable:!1,configurable:!0}}),"function"===typeof super.dispose)return super.dispose()}}class jv{piston;stampLayers=[];stampEditor;engine;constructor(t,e){if(!(t instanceof Qd)||!t.base)throw new TypeError("Invalid piston object");this.piston=t||null,this.stampEditor=e.itemEditorUI||null,this.engine=e;let i=t.base.length-1;while(i>0){const e=t.base[i];"stamp-slot"===e.type&&this.stampLayers.push(e),i--}this.stampEditor&&this.stampEditor.addEventListener(Wg.UPDATE,(t=>{const e=this.stampEditor.target;if(!e||!e.base)throw new Error("Invalid selected item");const i=e.base,{flipX:n,flipY:s}=t.data;if(n||s)return this.transform(i,{scale_x:n?-i.scale_x:i.scale_x,scale_y:s?-i.scale_y:i.scale_y});const{deltaX:r,deltaY:a,deltaAngle:o,deltaScaleX:l,deltaScaleY:h}=t.data;return this.transform(e.base,{x:i.x+(r||0),y:i.y+(a||0),rotation:i.rotation+(o||0),scale_x:i.scale_x+(l||0),scale_y:i.scale_y+(h||0)})})),Object.seal(this)}get doll(){return this.engine.dolls.find((t=>this.piston===t.piston))}showStampEditor(t){const e=this.doll;if(!e||!t)return;const i=e.lifeCycle;return requestAnimationFrame((async()=>{await i.waitPromise();const e=i.get(t),n=new Event(Wg.ITEM_EDITOR_SHOW);n.selectedItem=e,e.root.dispatchEvent(n)}))}async stampIt(t,e=0){const i=this.piston.get(t),n=this.stampLayers[e],s=await this.piston.invoke(n.id,"stamp-it",{id:i.id,x:this.piston.manifest.canvas_width/2,y:this.piston.manifest.canvas_height/2});return this.showStampEditor(s),s}async duplicateStamp(t,e=0){const i=this.piston.get(t),n=this.stampLayers[e],s=await this.piston.invoke(n.id,"stamp-it",{id:i.source_id,x:i.x+10,y:i.y+10,rotation:i.rotation,scaleX:i.scale_x,scaleY:i.scale_y});return this.showStampEditor(s),s}removeStamp(t){const e=this.piston.get(t);if(!e)throw new TypeError("Stamp target not found");const i=this.stampLayers.find((t=>t.id===e.parent_id));if(!i)throw new TypeError("Stamp layer not found");return this.hideStampEditor(),this.piston.invoke(i,"remove-stamp",{id:e.id})}removeCurrentStamp(){if(!this.stampEditor)throw new TypeError("Stamp editor not found");const t=this.stampEditor.target;if(!t||!t.base)throw new TypeError("Stamp target not found");return this.removeStamp(t.base)}duplicateCurrentStamp(){if(!this.stampEditor)throw new TypeError("Stamp editor not found");const t=this.stampEditor.target;if(!t||!t.base)return;const e=t.parent;if(!e||!e.base)throw new TypeError("Stamp target not found");const i=this.stampLayers.findIndex((t=>t.id===e.base.id));if(-1===i)throw new TypeError("current stamp not mounted");return this.hideStampEditor(),this.duplicateStamp(t.base,i)}flipCurrentStamp(t="horizontal"){if(!this.stampEditor)throw new TypeError("Stamp editor not found");const e=this.stampEditor.target;if(!e||!e.base)throw new TypeError("Stamp target not found");return this.stampEditor.flipCurrentTarget(t)}hideStampEditor(){this.stampEditor&&this.stampEditor.closeEditor()}show(t){return this.hideStampEditor(),this.piston.set(t,{visible:!0})}hide(t){return this.hideStampEditor(),this.piston.set(t,{visible:!1})}toggle(t){const e=this.piston.get(t);return e?e.visible?this.hide(t):this.show(t):Promise.reject(new TypeError("Invalid item"))}randomize(){return this.hideStampEditor(),this.piston.invoke(this.piston.mainUnitId,"randomize")}setActiveColor(t,e){return this.hideStampEditor(),this.piston.set(t,{active_color:e})}transform(t,e){return this.piston.set(t,e)}transformMove(t,e="default"){return this.piston.invoke(t,"move",e)}undo(){return this.hideStampEditor(),this.piston.history.back()}redo(){return this.hideStampEditor(),this.piston.history.forward()}undoAll(){return this.hideStampEditor(),this.piston.history.rewind()}}const Bv=i(193),Fv=i(7861),Uv=Object.freeze({ROTATE:"rotate",ARROW:"arrow"});class Nv extends wf{constructor(t,e,i=0,n=.38){super(),this.name=t,this.buttonType=e,this.circle=new bf,this.circle.name=t,this.circle.mouseEnabled=!0,this.mouseEnabled=!0,this.bmd=new mf(""),this.bmd.mouseEnabled=!1,this.bmd.tickEnabled=!1,this.bmd.scale=n,this.bmd.rotation=i||0;const s=document.createElement("img");s.onload=t=>this.onImageLoaded(s),s.crossOrigin="anonymous",e===Uv.ARROW&&(s.src=Fv),e===Uv.ROTATE&&(s.src=Bv),this.addChild(this.circle),this.addChild(this.bmd)}onImageLoaded(t){this.bmd.image=t,this.bmd.cache(0,0,t.width,t.height),this.bmd.dispatchEvent("cached"),this.bmd.regX=t.width/2,this.bmd.regY=t.height/2,this.circle.graphics.beginFill("rgba(255,255,255,0.5)").drawCircle(0,0,t.width*this.bmd.scale*.7).endStroke().endFill()}update(t,e){t+=20,e+=20,this.buttonType===Uv.ROTATE&&(t=0,e=-(e+5)),this.x=t,this.y=e}}Object.freeze({OVERLAY:"rotate",CENTER:"arrow"});class Xv extends bf{constructor(t,e=.1){super(),this.name=t,this.alpha=e,this.scale=1;const i=1e3;this.tween=If.get(this,{loop:!0}).to({scale:1.1},i/2,Lf.quadOut).to({scale:1},i/2,Lf.quadIn),this.pause(),this.fillColor="rgba(255,255,255,0.01)",this.borderColors=["#000000","#FFFFFF"],this.update(5,5)}play(){this.tween.paused=!1}pause(){this.tween.paused=!0}update(t,e){this.regX=t,this.regY=e,this.graphics.clear().setStrokeStyle(1).beginStroke(this.borderColors[0]).drawRect(0,0,2*t,2*e).beginStroke(this.borderColors[1]).beginFill(this.fillColor).drawRect(1,1,2*t-2,2*e-2).endStroke().endFill()}}class Hv extends bf{constructor(t){super(),this.name=t,this.graphics.beginFill("rgba(127,127,127,0.01)").drawRect(0,0,2048,2048).endFill()}update(t,e){}}var Vv=Object.freeze({onMouseDown:t=>function(e){return e.nativeEvent&&e.nativeEvent.cancelable&&e.nativeEvent.preventDefault(),t.target?t.downState&&e.pointerID!==t.downState.pointerID?null:(t.createDownState({pointerID:e.pointerID,name:e.currentTarget.name,stageX:e.stageX,stageY:e.stageY}),t.update(),void t.dispatchEvent(new Dm(Qv.DRAG_START))):null},onMouseMove:t=>function(e){if(!t.downState||!t.target||e.pointerID!==t.downState.pointerID)return null;const i=t.downState.name;switch(i){case qv.SCALE:Wv(e,t);break;case qv.ROTATE:zv(e,t);break;default:Yv(e,t);break}t.update()},onMouseUp:t=>function(e){if(!t.downState||!t.target||e.pointerID!==t.downState.pointerID)return null;const i=t.downState.name,n=t.clearDownState();t.update(),t.dispatchEvent(new Dm(Qv.DRAG_END)),i!==qv.CLICK_OUTSIDE||n||t.closeEditor()}});const Gv=t=>{while(t<=-180)t+=360;while(t>180)t-=360;return t},Yv=(t,e)=>{const i=t.stageX-e.downState.stageX,n=t.stageY-e.downState.stageY,s=Math.abs(i),r=Math.abs(n);s<4&&r<4||(e.currentState.x=e.downState.x+i,e.currentState.y=e.downState.y+n)},zv=(t,e)=>{const i=Gv(Math.atan2(t.stageX-e.downState.x,-(t.stageY-e.downState.y))*$v);e.currentState.rotation=i},Wv=(t,e)=>{let i=1,n=1;const s=t.stageX-e.downState.stageX,r=t.stageY-e.downState.stageY,a=(e.currentState.rotation-e.targetScaleAngle)/$v,o=-Math.sin(a)*s+Math.cos(a)*r,l=e.currentState.originalHeight,h=l*e.downState.scaleY;n=(h+2*o)/l,n>2&&(n=2),i=n,i=i>0?i:.01,n=n>0?n:.01,e.currentState.scaleX=i,e.currentState.scaleY=n},$v=180/Math.PI,qv=Object.freeze({MOVE:"move",SCALE:"scale",ROTATE:"rotate",CLICK_OUTSIDE:"click-outside"}),Qv=Object.freeze({OPEN:"open-editor",CLOSE:"close-editor",DRAG_START:"item-drag-start",DRAG_END:"item-drag-end",UPDATE:"update"}),Jv=Object.freeze({HORIZONTAL:"horizontal",VERTICAL:"vertical"});class Kv extends wf{constructor(){super(),this.visible=!1,this.target=null,this.targetScaleAngle=45;const t=new Hv(qv.CLICK_OUTSIDE);this.addChild(t),this.ui=new wf,this.addChild(this.ui),this.buttons=[t,new Xv(qv.MOVE,!0,.6),new Nv(qv.SCALE,Uv.ARROW,135),new Nv(qv.ROTATE,Uv.ROTATE,0)],this.buttons.forEach((t=>{t instanceof Hv||this.ui.addChild(t)})),this.downState=null,this.currentState={x:0,y:0,rotation:0,originalWidth:1,originalHeight:1,scaleX:1,scaleY:1,mirrorX:1,mirrorY:1};const e=Vv.onMouseDown(this);this.stageListeners={stagemousemove:Vv.onMouseMove(this),stagemouseup:Vv.onMouseUp(this),stagemousedown:t=>{this.target&&t.nativeEvent&&t.nativeEvent.cancelable&&t.nativeEvent.preventDefault()}},this.buttons.forEach((t=>{t.on("mousedown",e)}))}openEditor(t){if(!this.stage)throw new Error("stage not found");if(!t||!t.texture)throw new Error("invalid image");"undefined"===typeof t.texture.width&&(t.texture.width=t.texture.originalWidth,t.texture.height=t.texture.originalHeight),this.visible=!0,this.target=t,this.targetScaleAngle=Math.atan(t.texture.width/t.texture.height)*$v,Zv(this,t),this.update();for(const e in this.stageListeners)this.stage.addEventListener(e,this.stageListeners[e]);Xg.enable(this.stage),this.buttons.forEach((t=>{"function"===typeof t.play&&t.play()})),this.dispatchEvent(new Dm(Qv.OPEN))}closeEditor(){if(!this.stage)throw new Error("stage not found");if(this.target){Xg.disable(this.stage);for(const t in this.stageListeners)this.stage.removeEventListener(t,this.stageListeners[t]);this.clearDownState(),this.visible=!1,this.target=null,this.buttons.forEach((t=>{"function"===typeof t.pause&&t.pause()})),this.dispatchEvent(new Dm(Qv.CLOSE))}}update(){this.ui.x=this.currentState.x,this.ui.y=this.currentState.y,this.ui.rotation=this.currentState.rotation;const t=this.currentState.originalWidth/2*this.currentState.scaleX,e=this.currentState.originalHeight/2*this.currentState.scaleY;this.buttons.forEach((i=>{i.update(t,e,this.currentState.rotation)})),this.target.x=this.currentState.x,this.target.y=this.currentState.y,this.target.rotation=this.currentState.rotation,this.target.scaleX=this.currentState.scaleX*this.currentState.mirrorX,this.target.scaleY=this.currentState.scaleY*this.currentState.mirrorY}createDownState(t){if(this.downState)return null;this.downState=Object.assign(t,this.currentState)}clearDownState(){if(!this.downState)return null;const t=this.currentState.x-this.downState.x,e=this.currentState.y-this.downState.y,i=this.currentState.rotation-this.downState.rotation,n=(this.currentState.scaleX-this.downState.scaleX)*this.currentState.mirrorX,s=(this.currentState.scaleY-this.downState.scaleY)*this.currentState.mirrorY;if(this.downState=null,t||e||i||n||s){const r=new Dm(Qv.UPDATE);return r.data={deltaX:t,deltaY:e,deltaAngle:i,deltaScaleX:n,deltaScaleY:s},this.dispatchEvent(r),r.data}return null}flipCurrentTarget(t="horizontal"){if(!this.currentState)return null;const e=t===Jv.HORIZONTAL,i=t===Jv.VERTICAL;this.currentState.mirrorX=e?-this.currentState.mirrorX:this.currentState.mirrorX,this.currentState.mirrorY=i?-this.currentState.mirrorY:this.currentState.mirrorY;const n=new Dm(Qv.UPDATE);n.data={flipX:e,flipY:i},this.dispatchEvent(n),this.update()}setupEvents(t){t.addEventListener(Wg.ITEM_EDITOR_SHOW,(e=>{e.selectedItem&&e.selectedItem.parent&&(this.x=t.x,this.y=t.y,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.rotation=t.rotation,this.openEditor(e.selectedItem))})),t.addEventListener(Wg.ITEM_EDITOR_HIDE,(t=>{this.closeEditor()}))}}function Zv(t,e){t.currentState.x=e.x,t.currentState.y=e.y,t.currentState.rotation=e.rotation,t.currentState.originalWidth=e.texture.width,t.currentState.originalHeight=e.texture.height,t.currentState.scaleX=Math.abs(e.scaleX),t.currentState.scaleY=Math.abs(e.scaleY),t.currentState.mirrorX=e.scaleX>=0?1:-1,t.currentState.mirrorY=e.scaleY>=0?1:-1}(function(){const t=new DataView(new ArrayBuffer(4));let e=NaN})();const t_=function(t){t.preventDefault()};class e_{canvas;stage;display;effects;ui;constructor(t,e=null){const i="string"===typeof t?document.getElementById(t):t;if(!i)throw new Error("Canvas not found");e=Object.assign({framerate:60,antialias:!0,disableContextMenu:!0,disableEditorUI:!1,touchEnabled:!0},e||{}),e.disableContextMenu&&i.addEventListener("contextmenu",t_),this.canvas=i,this.clear();const n=new _f(i,{antialias:!!e.antialias});n.tickChildren=!1,n.tickOnUpdate=!1,n.preventSelection=!1,n.visible=!0,this.stage=n,this.enableInteractionEvents(e.touchEnabled),this.display=new wf,n.addChild(this.display),this.effects=new wf,n.addChild(this.effects),this.ui=new wf,n.addChild(this.ui),e.touchEnabled&&!e.disableEditorUI&&(this.itemEditorUI=new Kv,this.ui.addChild(this.itemEditorUI)),Cf.framerate=e.framerate||60,Object.seal(this)}get dolls(){return this.display.children}get framerate(){return Cf.framerate}get isDisposed(){return!this.stage}get isIdle(){return-1===this.dolls.findIndex((t=>!t.isIdle))}enableInteractionEvents(t){this.stage.mouseMoveOutside=!!t,this.stage.enableDOMEvents(!!t),this.stage.touchEnabled&&!t&&Ef.disable(this.stage),!this.stage.touchEnabled&&t&&Ef.enable(this.stage,!1,!0),this.stage.touchEnabled=!!t}getControls(t){return t instanceof Mv&&(t=t.piston),new jv(t,this)}addChild(t){if(!(t instanceof Mv))throw new TypeError("Invalid doll container");return this.itemEditorUI&&this.itemEditorUI.setupEvents(t),this.display.addChild(t)}removeChild(t){if(!(t instanceof Mv))throw new TypeError("Invalid doll container");return this.display.removeChild(t)}clear(){if(!this.canvas)throw new Error("canvas not found");const t=this.canvas.getContext("2d");t.clearRect(0,0,this.canvas.width,this.canvas.height)}start(){if(this.isDisposed)return;const t=this.stage;t.onTickFunction||(t.onTickFunction=()=>this.update(),Cf.addEventListener("tick",t.onTickFunction))}stop(){if(this.isDisposed)return;const t=this.stage;t.onTickFunction&&(Cf.removeEventListener("tick",t.onTickFunction),t.onTickFunction=null)}update(){this.stage.update()}async dispose(){if(this.isDisposed){this.stop(),this.stage.children.forEach((t=>{this.stage.removeChild(t)})),this.stage=null,this.canvas=null;for(let t=0;t<this.dolls.length;t++){const e=this.dolls[t];"function"===typeof e.dispose&&await e.dispose()}return"function"===typeof super.dispose?super.dispose():void 0}}}const i_=/iPhone/i,n_=/iPod/i,s_=/iPad/i,r_=/\biOS-universal(?:.+)Mac\b/i,a_=/\bAndroid(?:.+)Mobile\b/i,o_=/Android/i,l_=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,h_=/Silk/i,c_=/Windows Phone/i,u_=/\bWindows(?:.+)ARM\b/i,d_=/BlackBerry/i,f_=/BB10/i,p_=/Opera Mini/i,m_=/\b(CriOS|Chrome)(?:.+)Mobile/i,g_=/Mobile(?:.+)Firefox\b/i,v_=[i_,n_,s_,r_,a_,o_,l_,h_,c_,u_,d_,f_,p_,m_,g_];function __(){let t=navigator.userAgent;if(E)return!0;let e=t.split("[FBAN");return"undefined"!==typeof e[1]&&(t=e[0]),e=t.split("Twitter"),"undefined"!==typeof e[1]&&(t=e[0]),v_.some((e=>t.match(e)))}const b_=3;async function y_(t,e){if(!t)throw new Error("Piston instance is required");if(!e)return;const i=await Wu.parseFromURL(e),n=i.header.version;if(n<b_)return await w_(t,i);await E_(t,e)}async function w_(t,e){await t.invoke(t.mainUnitId,"loadSnap",e)}async function E_(t,e){const i=e.replace(".mksv",".001.mksv"),n=await Vu.parseFromURL(i);await t.invoke(t.mainUnitId,"loadReplay",n),await t.history.forwardToLastCheckpoint()}R.overlayDiv&&!R.overlayDiv.classList.contains("mk-p-ui")&&R.overlayDiv.classList.add("mk-p-ui");var C_={name:"Player",components:{Theme:cr,ScrollableList:J,GameCanvas:kp,WelcomeScreen:sm,SplashScreen:bm,ListItemButton:Tp},data(){return{itemsUpdateSignal:0,dollEngine:()=>null,controls:()=>null,loading:!1,gameState:or.WelcomeScreen,manifest:{gameWidth:9,gameHeight:16,bgColor:null,gameId:null,releaseId:null,baseUrl:null},categories:[],selectedCategoryIndex:-1,selectedItem:null,welcomeScreenData:null,saveImage:null,saveFile:null,replayFile:null,saveAction:null,onFullscreenChanged:null,loadSaveGameUrl:null,isStampMovingOrDragging:!1,showStampButtons:!1,enableUndoButton:!0,enableRedoButton:!0,enableFullscreenButton:!0,fullScreenOnPlay:__(),showSplashScreen:!1,hamburgerMenuVisible:!1}},provide(){return{theme:this.theme,lang:this.lang}},beforeUnmount(){const t=this.dollEngine();t&&(t.dispose(),I.removeEventListener("fullscreenchange",this.onFullscreenChanged))},mounted(){const t=this.$refs.display.getCanvas(),e=new e_(t,{antialias:!0,framerate:60,disableContextMenu:!0});this.dollEngine=()=>e,e.clear(),e.itemEditorUI.addEventListener("item-drag-start",(()=>{this.isStampMovingOrDragging=!0})),e.itemEditorUI.addEventListener("item-drag-end",(()=>{this.isStampMovingOrDragging=!1})),e.itemEditorUI.addEventListener("open-editor",(t=>{this.isStampMovingOrDragging=!1,this.showStampButtons=!0})),e.itemEditorUI.addEventListener("close-editor",(t=>{this.isStampMovingOrDragging=!1,this.showStampButtons=!1})),this.onFullscreenChanged=()=>this.$emit("fullscreenchange"),I.addEventListener("fullscreenchange",this.onFullscreenChanged)},props:{palettes:{type:Array,default(){return[]}},theme:{type:Object,default(){return{colors:{}}}},lang:{type:Object,default(){return{}}},transparent:{type:Boolean,default:!0},poweredByPremiumHref:{type:String},poweredByPremiumLabel:{type:String},splashEnabled:{type:Boolean,default:!0},thumbnails:{type:Boolean,default:!0},presentationMode:{type:Boolean,default:!1},colorWheel:{type:Boolean,default:!0},saveScreenAnimation:{type:Boolean,default:!0},saveImagePrefix:{type:String,default:"my-meiker"},saveImageForceDownload:{type:Boolean,default:!0}},computed:{selectedCategory(){return this.categories&&null!==this.selectedCategoryIndex?this.selectedCategoryIndex>=0&&this.categories.length>this.selectedCategoryIndex?this.categories[this.selectedCategoryIndex]:this.categories.length>0?this.categories[0]:{}:{}},selectedItemColors(){return this.selectedItem&&!this.selectedItem.isHidden&&this.selectedItem.colors?this.selectedItem.colors:[]},selectedItemMoveButtons(){if(this.selectedItem&&this.selectedItem.move){const t=[];return(this.selectedItem.move.up>0||this.selectedItem.move.down>0)&&t.push("up","down"),(this.selectedItem.move.left>0||this.selectedItem.move.right>0)&&t.push("left","right"),t}return[]},siteHomeLink(){return this.welcomeScreenData&&this.welcomeScreenData.resolvers&&"function"===typeof this.welcomeScreenData.resolvers.siteHomeLink?this.gameState===or.SaveScreen?this.welcomeScreenData.resolvers.siteHomeLink("end%20game"):this.welcomeScreenData.resolvers.siteHomeLink("in%20game"):null},isSplashScreenVisible(){if(!this.splashEnabled)return!1;const t=this.gameState===or.WelcomeScreen&&this.loading;return this.showSplashScreen||t},isColorWheelActive(){return this.colorWheel&&this.selectedItem&&this.selectedItem.isDynamic}},methods:{thumbnailBaseURL(t){return t.startsWith("data:")||t.startsWith("blob:")?t:this.thumbnails?(this.manifest.baseUrl||"./")+"thumbnails/"+t:(this.manifest.baseUrl||"./")+t},showWelcomeScreen({name:t,description:e,tags:i,owner:n,icon:s},r){if(this.welcomeScreenData={name:t,description:e,tags:i,owner:n,icon:s},r){const{tagLinkResolver:t,ownerLinkResolver:e,siteHomeLink:i}=r;this.welcomeScreenData.resolvers={tagLinkResolver:t,ownerLinkResolver:e,siteHomeLink:i}}},startLoadingGame(){this.showSplashScreen=!0,this.welcomeScreenData&&this.welcomeScreenData.onPlay&&this.welcomeScreenData.onPlay(),this.fullScreenOnPlay&&this.handleFullscreenToggle(!0)},async setData(t,e,i,n=null,s=null,r=null){if(this.manifest.gameWidth=e,this.manifest.gameHeight=i,this.manifest.gameId=s,this.manifest.releaseId=r,this.welcomeScreenData&&!this.welcomeScreenData.onPlay)return new Promise(((a,o)=>{this.welcomeScreenData.onPlay=()=>{this.setData(t,e,i,n,s,r).then(a).catch(o),this.welcomeScreenData.onPlay=null}}));this.categories=[],this.selectedItem=null,this.selectedCategoryIndex=-1,this.$nextTick((()=>{this.loading=!0}));const a=this.dollEngine();a.start();const o=new Qd({game_id:this.manifest.gameId,release_id:this.manifest.releaseId,canvas_height:this.manifest.gameHeight,canvas_width:this.manifest.gameWidth,base_url:this.manifest.baseUrl,palettes:JSON.parse(JSON.stringify(this.palettes||[]))});t=JSON.parse(JSON.stringify(t)),await o.load(t,{keepDataJsonObject:!1,readonlyProperties:!1});const l=a.getControls(o);this.controls=()=>l,[...t].reverse().forEach((t=>{if(-1===t.tags.indexOf("use-icon:none")&&("category"===t.type||"stamps"===t.type)){t=Object.assign({},t,{children:[...t.children||[]]}),t.tags=t.tags||[];const e=t.tags.find((t=>"fixed"===t||"optional"===t||"mixed"===t));t.isMixed="mixed"===e,t.isOptional="optional"===e,t.isStamps="stamps"===t.type,t.useIcon=-1!==t.tags.findIndex((t=>-1!==t.indexOf("use-icon:"))),t.children.forEach((e=>{e.isStamp=t.isStamps,e.useIcon=t.useIcon||-1!==e.tags.findIndex((t=>-1!==t.indexOf("use-icon:"))),e.isHidden=e.tags.includes("color-picker:hidden")||e.tags.includes("ui-hidden"),e.isColorPicker="color-picker"===e.type,e.isDynamic="dynamic"===e.type,e.image=e.image||"",e.visible=!!e.visible,e.move=null,e.original=Object.freeze({x:e.x,y:e.y});const i=e.tags.findIndex((t=>-1!==t.indexOf("move:")));if(-1!==i){const t=e.tags[i].split(":");if(t.length>1&&"string"===typeof t[1]){const[i,n,s,r]=t[1].trim().split(" ").map((t=>parseInt(t)||0));e.move={up:i,right:n,down:s,left:r}}}this.watchedPistonChanges(e)})),(t.isOptional||t.isMixed)&&t.children.splice(0,0,{name:"delete button",delete:!0,categoryId:t.id}),this.categories.push(t)}})),await y_(o,this.loadSaveGameUrl);const h=new Mv(o);a.addChild(h),h.on("progress",(()=>this.$nextTick((()=>{this.loading=!0})))),h.on("complete",(()=>this.$nextTick((()=>{this.loading=!1})))),await h.start(),this.$nextTick((()=>{this.loading=!1})),this.$emit("done"),this.gameState!==or.Playing&&(this.selectedCategoryIndex=null,this.$nextTick((()=>{this.selectedCategoryIndex=0,this.gameState=or.Playing})))},watchedPistonChanges(t){const e=this.controls(),i=e.piston.get(t),n=Qd.getMetadataOf(i);t.base=()=>i,t.metadata=()=>n;const s=(e,i)=>{t[e]!==i&&(t[e]=i,this.itemsUpdateSignal++)};t.isDynamic&&(t.colors=[],i.children.forEach((e=>{const i=Qd.getMetadataOf(e),n=e.tags.includes("ui-hidden"),s=e.tags.includes("removable");("object"===typeof i.paletteColors||s)&&(!s&&n||t.colors.push(Object.freeze({id:e.id,isRemovable:s,isHidden:n,get isVisible(){return e.visible},get availableColors(){return i.paletteColors||[]},get activeColor(){return i.activeColor||""}})))}))),t.isColorPicker&&(t.colors=[],t.colors.push(Object.freeze({id:t.id,get isVisible(){return!0},get availableColors(){return i.children.map((t=>t.name))},get activeColor(){return i.children.length>0&&i.children.find((t=>t.visible)).name}})));const r=e=>!!this.$nextTick((async()=>{if(s("visible",i.visible),"string"===typeof n.icon)return s("image",n.icon);if("color-picker"===t.type){const e=i.children.find((t=>t.visible));if(!e)return;if(t.useIcon){const t=Qd.getMetadataOf(e);if("string"===typeof t.icon)return s("image",t.icon)}return s("image",e.image)}return t.type,s("image",i.image)}));Qd.watch(i,r),r()},setDataSaveGame(t){this.loadSaveGameUrl=t},setBaseUrl(t){this.manifest.baseUrl=t},setOnDemandMode(t){},setSaveGameAction(t){"function"===typeof t&&this.$nextTick((()=>{this.saveAction=t}))},getDataImage(t="image/png"){const e=this.controls();if(!e)return;this.showStampButtons&&(e.hideStampEditor(),this.showStampButtons=!1);const i=this.$refs.display.getCanvas(),n=i.toDataURL(t),s=atob(n.split(",")[1]),r=[];for(let o=0;o<s.length;o++)r.push(s.charCodeAt(o));const a=new Blob([new Uint8Array(r)],{type:t});return(window.URL||window.webkitURL).createObjectURL(a)},async restore(){this.gameState=or.WelcomeScreen,this.welcomeScreenData=null,this.categories=[],this.selectedItem=null,this.selectedCategoryIndex=-1,this.loading=!1;const t=this.dollEngine();t&&(this.controls=()=>null,await t.dispose())},handleCategoryClick(t,e){this.hideHamburgerMenu();const i=this.controls();i&&(this.$refs.wrapper.setExpanded(!0),this.selectedCategoryIndex=e,this.showStampButtons&&(i.hideStampEditor(),this.showStampButtons=!1),this.selectedItem=null)},handleImageClick(t){this.hideHamburgerMenu();const e=this.controls();if(e)return t.delete?(this.selectedItem=null,this.selectedCategory.children.forEach((t=>{t.visible&&e.hide(t)}))):(this.selectedItem=t,t.isStamp?e.stampIt(t,0):this.selectedCategory.isOptional||this.selectedCategory.isMixed?(t.visible&&(this.selectedItem=null),e.toggle(t)):void(t.visible||e.show(t)))},handleStampsApplyClick(t){this.selectedItem=null;const e=this.controls();e&&(t||e.removeCurrentStamp(),e.hideStampEditor())},handleDuplicateStampClick(){const t=this.controls();t&&t.duplicateCurrentStamp()},handleFlipStampHorizontallyClick(){const t=this.controls();t&&t.flipCurrentStamp("horizontal")},handlePrepareSave(t){const e=this.controls();if(!e)return;setTimeout((()=>this.$nextTick((()=>this.$emit("save-image")))),1500);const i=(new Date).getTime()+""+parseInt(1e3*Math.random());this.showStampButtons&&(e.hideStampEditor(),this.showStampButtons=!1),this.selectedItem=null,this.gameState=or.SaveScreen,this.saveImage={suffix:i,name:`${this.saveImagePrefix}-${i}.png`,link:this.getDataImage("image/png")}},async handleSaveOnline(t){const e=this.controls();if(!e)return;if("function"!==typeof this.saveAction)return;if(this.saveFile||(this.saveFile={name:`my-meiker-${this.saveImage.suffix}.mksv`,link:null,saving:!1}),this.replayFile||(this.replayFile={name:`my-meiker-${this.saveImage.suffix}.001.mksv`,link:null}),this.saveFile.saving)return;this.$nextTick((()=>{I.exit()})),this.saveFile.saving=!0;const i=await e.piston.invoke(e.piston.mainUnitId,"saveSnap");this.saveFile.link=i?await i.toBlobURL():null;const n=await e.piston.invoke(e.piston.mainUnitId,"saveReplay");this.replayFile.link=n?await n.toBlobURL():null;const s=this.saveAction({gameId:this.manifest.gameId,releaseId:this.manifest.releaseId,replayFile:this.replayFile.link,saveFile:this.saveFile.link,savePreviewImage:this.saveImage.link});if(s instanceof Promise)return s.then((e=>{this.handleCancelSave(t)})).catch((t=>{this.saveFile.saving=!1}));this.handleCancelSave(t)},handleCancelSave(t){this.gameState=or.Playing,this.saveImage&&this.saveImage.link&&(window.URL||window.webkitURL).revokeObjectURL(this.saveImage.link),this.saveFile&&this.saveFile.link&&(window.URL||window.webkitURL).revokeObjectURL(this.saveFile.link),this.replayFile&&this.replayFile.link&&(window.URL||window.webkitURL).revokeObjectURL(this.replayFile.link),this.selectedItem=null,this.saveImage=null,this.saveFile=null,this.replayFile=null},handleRandomClick(t){this.selectedItem=null;const e=this.controls();if(e)return e.randomize()},handleResetClick(t){this.selectedItem=null;const e=this.controls();if(e)return e.undoAll()},async handleUndoClick(t){this.selectedItem=null;const e=this.controls();if(e)return e.undo()},async handleRedoClick(t){this.selectedItem=null;const e=this.controls();if(e)return e.redo()},handleFullscreenToggle(t=!1){if(this.enableFullscreenButton)return!I.isFullScreen||t?I.enter(this.$el):void I.exit()},handleSelectColorClick(t,e=0){const i=this.controls();i&&this.selectedItemColors&&i.setActiveColor(this.selectedItemColors[e],t)},async handleColorWheelChange(t,e=0){const i=this.controls();i&&this.selectedItemColors&&i.piston.invoke(this.selectedItemColors[e],"forceActiveColor",t)},async handleColorVisibleChange(t,e=0){const i=this.controls();if(!i||!this.selectedItemColors)return;const n=this.selectedItemColors[e];return t?i.show(n):i.hide(n)},handleGamePadClick(t){const e=this.controls();if(!e)return;const i=e.piston.get(this.selectedItem.id),n=t.source;return e.transformMove(i,n)},onSplashFinished(){this.$emit("play",{...this.welcomeScreenData}),this.showSplashScreen=!1},hideHamburgerMenu(){this.hamburgerMenuVisible=!1}}};const T_=(0,H.A)(C_,[["render",u]]);var x_=T_;const S_=x_;var I_=S_,L_=i(3957),O_=i.n(L_);const A_="meiker.io",k_=function(){const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`)},R_=function(){document&&window&&document.documentElement&&document.documentElement.style.setProperty&&(document.documentElement.style.getPropertyValue("--vh")||(window.addEventListener("resize",k_),k_()))};var P_={name:"app",components:{Player:I_},data(){return{visible:!1,presentationMode:!1,saveImageForceDownload:!0,scrollToTimeOut:null,manifest:{},events:{},dataJson:[],error:"",theme:{}}},methods:{checkSite(){return!0},validate(t){const e=(window.parent||window).location,i=e.hostname.toString();return i.endsWith(t)||"localhost"===i||i.endsWith(A_)},evtProxy(t,e=null){if(this.events&&"function"===typeof this.events[t])try{this.events[t](e)}catch(yr){}},scrollGameToCenter(){clearTimeout(this.scrollToTimeOut);const t=this.getBodyElement();if(!t)return!1;const e=this.$el.getBoundingClientRect().top+window.pageYOffset;this.scrollToTimeOut=setTimeout((()=>window.scrollTo({top:e,behavior:"smooth"})),300)},getBodyElement(){if(!document||!window)return null;let t=null;const e=document.getElementsByTagName("body");return e.length>0&&(t=e[0]),t},tryToLockDeviceOrientation(){window.screen&&window.screen.orientation&&"function"===typeof window.screen.orientation.lock&&window.screen.orientation.lock("portrait").catch((()=>{}))},prepareAndShowWelcomeScreen(){const t=this.manifest.owner.site&&this.manifest.owner.site.length>0&&this.manifest.owner.site[0]||null,e=this.manifest.game_id||null,i=window.location.hostname,n="function"===typeof this.$ENV&&this.$ENV().embedded,s="https";let r=()=>"";n&&(this.saveImageForceDownload=!1,r=t=>`?utm_source=${i}&utm_campaign=meiker_${e}&utm_medium=${t}`),this.$refs.game.showWelcomeScreen(this.manifest,{tagLinkResolver(t,e){const i=r(e?`${e}%20category%20tag`:"category%20tag");return`${s}://${A_}/games/tag/${t}${i}`},ownerLinkResolver(e,i){const n=r(i?`${i}%20created%20by`:"created%20by");return t?`${s}://${t}/${n}`:`${s}://${A_}/games/creator/${e}${n}`},siteHomeLink(t){const e=r(t?`${t}%20powered%20by`:"powered%20by");return`${s}://${A_}/${e}`}})},async loadDataJson(){await O_().get(this.manifest.data_url).then((t=>{this.dataJson=t.data,this.prepareAndShowWelcomeScreen(),this.manifest.saveFileUrl&&this.$refs.game.setDataSaveGame(this.manifest.saveFileUrl),this.manifest.hideSaveBtn||this.$refs.game.setSaveGameAction((t=>Rm.dispatch("saves.doSave",[t]))),this.$refs.game.setOnDemandMode(!!this.manifest.thumbnails),this.$refs.game.setBaseUrl(this.manifest.base_url),this.$refs.game.setData(this.dataJson,this.manifest.canvas_width,this.manifest.canvas_height,"#000000",this.manifest.game_id,this.manifest.release_id||1)})).catch((()=>{this.error="We had a problem loading the game. Please refresh this page to try again."}))},detectPresentationMode(){const t=new URLSearchParams(window.location.search),e=t.get("collection");if(!e)return!1;const i="true"===t.get("presentation");if(!i)return!1;const n=window.location.hostname.endsWith(A_),s="localhost"===window.location.hostname,r=n||s;return!!r}},async mounted(){this.presentationMode=this.detectPresentationMode(),this.tryToLockDeviceOrientation();try{this.manifest="function"===typeof window.meikerioLoader?window.meikerioLoader.call(null):null,this.events="function"===typeof window.meikerioEvents?window.meikerioEvents.call(null):{}}catch(t){}"object"===typeof this.manifest&&"object"===typeof this.events&&this.checkSite()?(this.manifest.theme&&(this.theme=this.manifest.theme,delete this.manifest.theme),this.visible=!0,this.$nextTick((async()=>{this.$refs.game?(this.manifest.saveFileUrl=await Rm.dispatch("saves.loadFromUrl"),await this.loadDataJson()):this.error="We're sorry, game display not found."})),this.$ENV&&this.$ENV().fullscreen&&R_()):this.error="We're sorry, the game you requested could not be found or not yet published."}};const D_=(0,H.A)(P_,[["render",c]]);var M_=D_;const j_=(0,n.Ef)(M_);j_.config.globalProperties.$ENV="function"===typeof window.ENV?window.ENV.bind(null):null,j_.mount("#app")},6085:function(t,e,i){(function(t,e,i){"use strict";let n=0;const s=["ms","moz","webkit","o"];let r;for(r=0;r<s.length&&!t[e];++r)t[e]=t[s[r]+"RequestAnimationFrame"],t[i]=t[s[r]+"CancelAnimationFrame"]||t[s[r]+"CancelRequestAnimationFrame"];t[e]||(t[e]=function(e){const i=(new Date).getTime(),s=Math.max(0,16-(i-n)),r=t.setTimeout((function(){e(i+s)}),s);return n=i+s,r}),t[i]||(t[i]=function(e){t.clearTimeout(e)})})("undefined"!==typeof window?window:i.g,"requestAnimationFrame","cancelAnimationFrame")},7861:function(t){"use strict";t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAABfklEQVR4nO2ZWWrDMBRFT0pXmEIz1FvKQpt4CTXtR1Uosl5sSYmvh3dAEIyfde9xBnDAcRzHkbELa5NcgC6sizjL5DTAd7QaaaIJafi967GAjg1IsMpvQsJQ+VVLGFt+lRJS5b/ol46PrUKCVf6dvoADK5Nwrzz0BcCKJFjlD//OSQkgnBPPLkrCmPJgC4AFSxhbHu4LgAVKSJXvSJeHYQEAR+Oas5OQWx7GCYAFSLDKHwfmxgoAOBl7yCWUloc8ATBDCVb508j5XAEAZ2PPySXUlocyATADCdbP0znzOqUCAD6MDPe+dB/CDmgTG+eWhzoBkJbQ8uRnjLGALgQpoVYA9D+KTxcA8BY2aql7yz1CACHDFbgB+9zhUlt/czXB41nJ4/HXwrma4rPiRR1AjQtQB1DjAtQB1LgAdQA1LkAdQI0LUAdQ4wLUAdS4AHUANS5AHUCNC1AHUOMC1AHUuAB1ADUuQB1AjQsQ7n01Xm+GPfAZVva/uo7jOI5Tzw+sEiBuOid4ywAAAABJRU5ErkJggg=="},8260:function(){"currentTransform"in CanvasRenderingContext2D.prototype||("mozCurrentTransform"in CanvasRenderingContext2D.prototype?Object.defineProperty(CanvasRenderingContext2D.prototype,"currentTransform",{get:function(){var t=this.mozCurrentTransform;return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}},set:function(t){this.mozCurrentTransform=[t.a,t.b,t.c,t.d,t.e,t.f]},enumerable:!0,configurable:!1}):"webkitCurrentTransform"in CanvasRenderingContext2D.prototype?Object.defineProperty(CanvasRenderingContext2D.prototype,"currentTransform",{get:function(){return this.webkitCurrentTransform},set:function(t){this.webkitCurrentTransform=t},enumerable:!0,configurable:!1}):(Object.defineProperty(CanvasRenderingContext2D.prototype,"currentTransform",{get:function(){return this._t2stack&&this._t2stack[this._t2stack.length-1]||{a:1,b:0,c:0,d:1,e:0,f:0}},set:function(t){this._t2stack||(this._t2stack=[{}]),this._t2stack[this._t2stack.length-1]={a:t.a,b:t.b,c:t.c,d:t.d,e:t.e,f:t.f}},enumerable:!0,configurable:!1}),CanvasRenderingContext2D.prototype.getTransform=function(){const t=this.currentTransform;return{a:t.a,b:t.b,c:t.c,d:t.d,e:t.e,f:t.f}},CanvasRenderingContext2D.prototype.save=function(){var t=CanvasRenderingContext2D.prototype.save;return function(){this._t2stack||(this._t2stack=[{a:1,b:0,c:0,d:1,e:0,f:0}]);var e=this._t2stack[this._t2stack.length-1];this._t2stack.push(e&&{a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,f:e.f}),t.call(this)}}(),CanvasRenderingContext2D.prototype.restore=function(){var t=CanvasRenderingContext2D.prototype.restore;return function(){this._t2stack&&this._t2stack.pop(),t.call(this)}}(),CanvasRenderingContext2D.prototype.transform=function(){var t=CanvasRenderingContext2D.prototype.transform;return function(e,i,n,s,r,a){this._t2stack||(this._t2stack=[{a:1,b:0,c:0,d:1,e:0,f:0}]);var o=this._t2stack[this._t2stack.length-1],l=o.a*e+o.c*i,h=o.b*e+o.d*i,c=o.a*n+o.c*s,u=o.b*n+o.d*s,d=o.e+o.a*r+o.c*a,f=o.f+o.b*r+o.d*a;o.a=l,o.b=h,o.c=c,o.d=u,o.e=d,o.f=f,t.call(this,e,i,n,s,r,a)}}(),CanvasRenderingContext2D.prototype.setTransform=function(){var t=CanvasRenderingContext2D.prototype.setTransform;return function(e,i,n,s,r,a){this._t2stack||(this._t2stack=[{}]),"object"===typeof e&&"undefined"!==typeof e.f?(this._t2stack[this._t2stack.length-1]={a:e.a,b:e.b,c:e.c,d:e.d,e:e.e,f:e.f},t.call(this,e.a,e.b,e.c,e.d,e.e,e.f)):(this._t2stack[this._t2stack.length-1]={a:e,b:i,c:n,d:s,e:r,f:a},t.call(this,e,i,n,s,r,a))}}(),CanvasRenderingContext2D.prototype.resetTransform=function(){var t=CanvasRenderingContext2D.prototype.resetTransform;return function(){this._t2stack||(this._t2stack=[{}]),this._t2stack[this._t2stack.length-1]={a:1,b:0,c:0,d:1,e:0,f:0},t&&t.call(this)}}(),CanvasRenderingContext2D.prototype.scale=function(){var t=CanvasRenderingContext2D.prototype.scale;return function(e,i){this._t2stack||(this._t2stack=[{a:1,b:0,c:0,d:1,e:0,f:0}]);var n=this._t2stack[this._t2stack.length-1];e=e||1,i=i||e,n.a*=e,n.c*=i,n.b*=e,n.d*=i,t.call(this,e,i)}}(),CanvasRenderingContext2D.prototype.rotate=function(){var t=CanvasRenderingContext2D.prototype.rotate;return function(e){this._t2stack||(this._t2stack=[{a:1,b:0,c:0,d:1,e:0,f:0}]);var i=this._t2stack[this._t2stack.length-1],n=Math.cos(-e),s=Math.sin(-e),r=i.a*n-i.c*s,a=i.b*n-i.d*s,o=i.c*n+i.a*s,l=i.d*n+i.b*s;return i.a=r,i.b=a,i.c=o,i.d=l,t.call(this,e)}}(),CanvasRenderingContext2D.prototype.translate=function(){var t=CanvasRenderingContext2D.prototype.translate;return function(e,i){this._t2stack||(this._t2stack=[{a:1,b:0,c:0,d:1,e:0,f:0}]);var n=this._t2stack[this._t2stack.length-1];return n.e+=e*n.a+i*n.c,n.f+=e*n.b+i*n.d,t.call(this,e,i)}}()))}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={id:n,loaded:!1,exports:{}};return t[n](r,r.exports,i),r.loaded=!0,r.exports}i.m=t,function(){i.amdO={}}(),function(){var t=[];i.O=function(e,n,s,r){if(!n){var a=1/0;for(c=0;c<t.length;c++){n=t[c][0],s=t[c][1],r=t[c][2];for(var o=!0,l=0;l<n.length;l++)(!1&r||a>=r)&&Object.keys(i.O).every((function(t){return i.O[t](n[l])}))?n.splice(l--,1):(o=!1,r<a&&(a=r));if(o){t.splice(c--,1);var h=s();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[n,s,r]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,r,a=n[0],o=n[1],l=n[2],h=0;if(a.some((function(e){return 0!==t[e]}))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var c=l(i)}for(e&&e(n);h<a.length;h++)r=a[h],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(c)},n=self["webpackChunk_meikerio_game_html"]=self["webpackChunk_meikerio_game_html"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[504],(function(){return i(5146)}));n=i.O(n)})();